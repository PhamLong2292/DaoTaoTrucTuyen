//using Newtonsoft.Json;
//using System;
//using System.Collections.Generic;
//using System.Globalization;
//using System.Linq;
//using System.Text;
//using System.Threading.Tasks;
//using OneTSQ.Call.Bussiness.Utility;
//using OneTSQ.Core.Call.Bussiness.Utility;
//using OneTSQ.Model;
//using OneTSQ.Utility;
//using OneTSQ.CheckPermissionUtility;
//using OneTSQ.Permission;
//using OneMES3.DM.Model;
//using OneTSQ.Core.Model;

//namespace OneTSQ.WebParts
//{
//    public class LichHoiChanOpenCls
//    {
//        public string optionNguoiDuyet_ID;
//        public string optionNguoiTao_ID;
//        public string optionThuKy_ID;
//        public string optionChuTri_ID;
//        public string optionChuyenKhoaMa;
//        public string ThoiGianDuyet;
//        public string ThoiGianTao;
//        public string DiaDiem;
//        public string BatDau;
//        public string KetThuc;
//        public string GhiChu;
//        public LichHoiChanCls lichhoichan;
//    }
//    public class LichHoiChan : WebPartTemplate
//    {
//        public override string WebPartId { get { return StaticWebPartId; } }
//        public static string StaticWebPartId = "LichHoiChan";
//        public override string WebPartTitle { get { return "Lịch hội chẩn"; } }
//        public override string Description { get { return "Lịch hội chẩn"; } }
//        public override string[] CheckPermissionWebPartIds
//        {
//            get
//            {
//                return new string[] { StaticWebPartId, LichHoiChan.StaticWebPartId };
//            }
//        }
//        public override void RegAjaxPro(RenderInfoCls ORenderInfo, System.Web.UI.Page Page)
//        {
//            AjaxPro.Utility.RegisterTypeForAjax(typeof(LichHoiChan), Page);
//        }
//        public override AjaxOut Draw(SiteParam OSiteParam, RenderInfoCls ORenderInfo)
//        {
//            AjaxOut RetAjaxOut = new AjaxOut();
//            try
//            {
//                OwnerUserCls user = WebSessionUtility.GetCurrentLoginUser(OSiteParam);
//                string lichhoichanid = WebEnvironments.Request("lichhoichanid");
//                LichHoiChanCls lichHoiChan = string.IsNullOrEmpty(lichhoichanid) ? null : CallBussinessUtility.CreateBussinessProcess().CreateLichHoiChanProcess().CreateModel(ORenderInfo, lichhoichanid);
//                bool themPermission = PermissionUtility.CheckPermission(ORenderInfo, new LichHoiChanPermission().PermissionFunctionCode, LichHoiChanCls.ePermission.Them.ToString(), new LichHoiChanPermission().PermissionFunctionCode, LichHoiChanPermission.StaticPermissionFunctionId, user.OwnerUserId);
//                bool suaPermission = lichHoiChan != null && (lichHoiChan.TAOBOI == user.OwnerUserId || PermissionUtility.CheckPermission(ORenderInfo, new LichHoiChanPermission().PermissionFunctionCode, LichHoiChanCls.ePermission.Sua.ToString(), new LichHoiChanPermission().PermissionFunctionCode, LichHoiChanPermission.StaticPermissionFunctionId, user.OwnerUserId, lichHoiChan.TAOBOI));
//                bool xoaPermission = lichHoiChan != null && (lichHoiChan.TAOBOI == user.OwnerUserId || PermissionUtility.CheckPermission(ORenderInfo, new LichHoiChanPermission().PermissionFunctionCode, LichHoiChanCls.ePermission.Xoa.ToString(), new LichHoiChanPermission().PermissionFunctionCode, LichHoiChanPermission.StaticPermissionFunctionId, user.OwnerUserId, lichHoiChan.TAOBOI));
//                bool chuyenDuyetPermission = lichHoiChan != null && (lichHoiChan.TAOBOI == user.OwnerUserId || PermissionUtility.CheckPermission(ORenderInfo, new LichHoiChanPermission().PermissionFunctionCode, LichHoiChanCls.ePermission.ChuyenDuyet.ToString(), new LichHoiChanPermission().PermissionFunctionCode, LichHoiChanPermission.StaticPermissionFunctionId, user.OwnerUserId, lichHoiChan.TAOBOI));
//                bool huyPermission = lichHoiChan != null && (lichHoiChan.TAOBOI == user.OwnerUserId || PermissionUtility.CheckPermission(ORenderInfo, new LichHoiChanPermission().PermissionFunctionCode, LichHoiChanCls.ePermission.Huy.ToString(), new LichHoiChanPermission().PermissionFunctionCode, LichHoiChanPermission.StaticPermissionFunctionId, user.OwnerUserId));
//                bool isChuTri = false, isThuKy = false, isPheDuyet = false;//, isThuKy = false, isChuyenGia = false;
//                if (lichHoiChan != null)
//                {
//                    if (CallBussinessUtility.CreateBussinessProcess().CreateBacSyOwnerUserProcess().Reading(ORenderInfo, new BacSyOwnerUserFilterCls() { BACSYID = lichHoiChan.CHUTRI, OWNERUSERID = user.OwnerUserId }).Any())
//                        isChuTri = true;
//                    if (CallBussinessUtility.CreateBussinessProcess().CreateBacSyOwnerUserProcess().Reading(ORenderInfo, new BacSyOwnerUserFilterCls() { BACSYID = lichHoiChan.THUKY, OWNERUSERID = user.OwnerUserId }).Any())
//                        isThuKy = true;
//                    isPheDuyet = lichHoiChan.DUYETBOI == user.OwnerUserId;
//                    //LapLichThanhVienHoiChanCls[] lapLichThanhVienHoiChans = CallBussinessUtility.CreateBussinessProcess().CreateLapLichThanhVienHoiChanProcess().Reading(ORenderInfo, new LapLichThanhVienHoiChanFilterCls() { LICHHOICHANID = lichHoiChan.ID });
//                    //foreach (var lapLichThanhVienHoiChan in lapLichThanhVienHoiChans)
//                    //    if (CallBussinessUtility.CreateBussinessProcess().CreateBacSyOwnerUserProcess().Reading(ORenderInfo, new BacSyOwnerUserFilterCls() { BACSYID = lapLichThanhVienHoiChan.BACSYID, OWNERUSERID = user.OwnerUserId }).Any())
//                    //    {
//                    //        isChuyenGia = true;
//                    //        break;
//                    //    }
//                }
//                var dc = new LinkData() { Name = 1, Value = ORenderInfo.OwnerId };
//                string MaBV = ORenderInfo.OwnerId;
//                string jsondc = JsonConvert.SerializeObject(dc);
//                string SessionId = System.Guid.NewGuid().ToString();
//                string UserId = WebSessionUtility.GetCurrentLoginUser(OSiteParam).OwnerUserId;
//                string LoginName = "1";
//                string donViTuVanMa = null;
//                if (lichHoiChan != null)
//                {
//                    OwnerUserCls userTaoLich = CoreCallBussinessUtility.CreateBussinessProcess().CreateOwnerUserProcess().CreateModel(ORenderInfo, lichHoiChan.TAOBOI);
//                    donViTuVanMa = userTaoLich.OwnerCode;
//                }
//                else
//                    donViTuVanMa = user.OwnerCode;
//                #region Html
//                string html =
//                    "         <div id=\"divProcessing\" class=\"processing\"></div>\r\n" +
//                    "               <div id=\"divDM_DICHVU_BVContent\"></div>\r\n" +
//                    "         </div> \r\n" +
//                    "<form action='javascript:SaveLichHoiChan();'> \r\n" +
//                    "     <div id=\"divTopButton\" class='col-lg-12' style='margin-top: 10px; padding-bottom: 10px;'> \r\n" +
//                    "       <input type='button' id='btnClear' title='Xóa toàn bộ dữ liệu để lập lịch mới' class='btn btn-primary' value='" + WebLanguage.GetLanguage(OSiteParam, "Mới") + "' onclick='javascript:Clear();' style='float:left; display:none;'>\r\n" +
//                    "       <input type='submit' id='btnLuu' title='Lưu thay đổi lịch' class='btn btn-primary' value='" + WebLanguage.GetLanguage(OSiteParam, "Lưu") + "' style='float:left; margin-left: 20px; display:none;'>\r\n" +
//                    "       <input type='button' id='btnXoa' title='Xóa lịch' class='btn btn-primary' value='" + WebLanguage.GetLanguage(OSiteParam, "Xóa") + "' onclick='javascript:DeleteLichHoiChan();' style='float:left; margin-left: 20px; display:none;'>\r\n" +
//                    "       <input type='button' id='btnChuyenDuyet' title='Chuyển duyệt lịch' class='btn btn-primary' value='" + WebLanguage.GetLanguage(OSiteParam, "Chuyển duyệt") + "' onclick='javascript:ChuyenDuyet();' style='float:left; margin-left: 20px; display:none;'>\r\n" +
//                    "       <input type='button' id='btnDuyet' title='Duyệt lịch' class='btn btn-primary' value='" + WebLanguage.GetLanguage(OSiteParam, "Duyệt") + "' onclick='javascript:Duyet();' style='float:left; margin-left: 20px; display:none;'>\r\n" +
//                    "       <input type='button' id='btnTuChoiDuyet' title='Từ chối duyệt lịch' class='btn btn-primary' value='" + WebLanguage.GetLanguage(OSiteParam, "Từ Chối") + "' onclick='javascript:TuChoiDuyet();' style='float:left; margin-left: 20px; display:none;'>\r\n" +
//                    "       <input type='button' id='btnThuHoiChuyenDuyet' title='Thu hồi chuyển duyệt lịch' class='LichHoiChanThuHoi btn btn-primary' value='" + WebLanguage.GetLanguage(OSiteParam, "Thu hồi") + "' onclick='javascript:ThuHoiChuyenDuyet();' style='float:left; margin-left: 20px; display:none;'>\r\n" +
//                    "       <input type='button' id='btnThuHoiDuyet' title='Thu hồi duyệt lịch' class='btn btn-primary' value='" + WebLanguage.GetLanguage(OSiteParam, "Thu hồi") + "' onclick='javascript:ThuHoiDuyet();' style='float:left; margin-left: 20px; display:none;'>\r\n" +
//                    "       <input type='button' id='btnThuHoiTuChoiDuyet' title='Thu hồi từ chối duyệt lịch' class='btn btn-primary' value='" + WebLanguage.GetLanguage(OSiteParam, "Thu hồi") + "' onclick='javascript:ThuHoiTuChoiDuyet();' style='float:left; margin-left: 20px; display:none;'>\r\n" +
//                    "       <input type='button' id='btnHoanTat' title='Hoàn tất lịch' class='btn btn-primary' value='" + WebLanguage.GetLanguage(OSiteParam, "Hoàn tất") + "' onclick='javascript:HoanTat();' style='float:left; margin-left: 20px; display:none;'>\r\n" +
//                    "       <input type='button' id='btnHuy' title='Hủy lịch' class='btn btn-primary' value='" + WebLanguage.GetLanguage(OSiteParam, "Hủy") + "' onclick='javascript:Huy();' style='float:left; margin-left: 20px; display:none;'>\r\n" +
//                    "       <input type='button' id='btnHoiChan' title='Mở trang hội chẩn ca bệnh' class='btn btn-primary' value='" + WebLanguage.GetLanguage(OSiteParam, "Hội chẩn") + "' onclick='OpenCaBenh();' style='float:left; margin-left: 20px; display:none;'>\r\n" +
//                    //"     </div> \r\n" +
//                    //"       <button type=\"button\"  class=\"btn btn-sm btn-primary\" onclick=\"javascript:Import();\"> " + WebLanguage.GetLanguage(OSiteParam, "Import") + "</button>\r\n" +
//                    //"       <div class=\"fileinput fileinput-new\" data-provides=\"fileinput\">\r\n" +
//                    //"            <span class=\"btn btn-default btn-file\" ><span class=\"fileinput-new\">Chọn File</span>\r\n" +
//                    //"            <span class=\"fileinput-exists\">Chọn lại</span><input type=\"file\" name=\"...\" id=\"fileUpload\"/></span>\r\n" +
//                    //"            <span class=\"fileinput-filename\"></span>\r\n" +
//                    //"       <a href=\"#\" class=\"close fileinput-exists\" data-dismiss=\"fileinput\" style=\"float: none\" id= \"aexit\" >×</a>\r\n" +
//                    //"       </div> \r\n" +
//                    "<div class='row'>\r\n" +
//                    "   <div class='col-lg-12'>\r\n" +
//                    "      <div class='ibox float-e-margins'>\r\n" +
//                    "          <div class='ibox-title'>\r\n" +
//                    "              <h5>" + WebLanguage.GetLanguage(OSiteParam, "Thông tin lập lịch") + "</h5>\r\n" +
//                    "          </div>\r\n" +
//                    "          <div id='ttPhieu' class='ibox-content'>\r\n" +
//                    "               <div class='row'>\r\n" +
//                    "                   <div class='col-sm-12'>\r\n" +
//                    "                       <div class='row'>\r\n" +
//                    "                           <div class='col-sm-3' style=\"min-width:100px\">\r\n" +
//                    "                               <div class='form-group'>" + WebLanguage.GetLanguage(OSiteParam, "Người lập lịch") + " <select  id='cboNguoiLapLich' style=\"width:100%;\" class='form-control laplich-control'></select></div>\r\n" +
//                    "                           </div>\r\n" +
//                    "                           <div class='col-sm-3' style=\"min-width:150px\">\r\n" +
//                    "                               <div class='form-group'>" + WebLanguage.GetLanguage(OSiteParam, "Thời gian lập lịch") + "<input id='txtThoiGianLapLich' class='form-control laplich-control' type='text'/></div>\r\n" +
//                    "                           </div>\r\n" +
//                    "                           <div class='col-sm-3' style=\"min-width:100px\">\r\n" +
//                    "                               <div class='form-group'>" + WebLanguage.GetLanguage(OSiteParam, "Người duyệt") + "<span style=\"color:red;\">*</span><select  id='cboNguoiDuyet' required style=\"width:100%;\" class='form-control laplich-control'></select></div>\r\n" +
//                    "                           </div>\r\n" +
//                    "                           <div class='col-sm-3' style=\"min-width:150px\">\r\n" +
//                    "                               <div class='form-group'>" + WebLanguage.GetLanguage(OSiteParam, "Thời gian duyệt") + "<input id='txtThoiGianDuyet'  class='form-control laplich-control' type='text'/></div>\r\n" +
//                    "                           </div>\r\n" +
//                    "                       </div>\r\n" +
//                    "                       <div class='row'>\r\n" +
//                    "                           <div class='col-sm-6' style=\"min-width:150px\">\r\n" +
//                    "                               <div class='form-group'>" + WebLanguage.GetLanguage(OSiteParam, "Chuyên khoa") + "<select  id='cboChuyenKhoa' style=\"width:100%;\" class='form-control laplich-control'></select></div>\r\n" +
//                    "                           </div>\r\n" +
//                    "                           <div class='col-sm-3' style=\"min-width:150px\">\r\n" +
//                    "                               <div class='form-group'>" + WebLanguage.GetLanguage(OSiteParam, "Thời gian bắt đầu") + "<span style=\"color:red;\">*</span><input id='dtBatDau' required class='form-control laplich-control' type='text'/></div>\r\n" +
//                    "                           </div>\r\n" +
//                    "                           <div class='col-sm-3' style=\"min-width:150px\">\r\n" +
//                    "                               <div class='form-group'>" + WebLanguage.GetLanguage(OSiteParam, "Thời gian kết thúc") + "<span style=\"color:red;\">*</span><input id='dtKetThuc' required class='form-control laplich-control' type='text'/></div>\r\n" +
//                    "                           </div>\r\n" +
//                    "                       </div>\r\n" +
//                    "                       <div class='row'>\r\n" +
//                    "                           <div class='col-sm-3' style=\"min-width:100px\">\r\n" +
//                    "                               <div class='form-group'>" + WebLanguage.GetLanguage(OSiteParam, "Chủ trì") + "<span style=\"color:red;\">*</span><select  id='cboChuTri' required style=\"width:100%;\" class='form-control laplich-control'></select></div>\r\n" +
//                    "                           </div>\r\n" +
//                    "                           <div class='col-sm-3' style=\"min-width:100px\">\r\n" +
//                    "                               <div class='form-group'>" + WebLanguage.GetLanguage(OSiteParam, "Thư ký") + "<span style=\"color:red;\">*</span><select  id='cboThuKy' required style=\"width:100%;\" class='form-control laplich-control'></select></div>\r\n" +
//                    "                           </div>\r\n" +
//                    "                           <div class='col-sm-6' style=\"min-width:300px\">\r\n" +
//                    "                               <div class='form-group'>" + WebLanguage.GetLanguage(OSiteParam, "Địa điểm") + "<span style=\"color:red;\">*</span><input id='txtDiaDiem' required class='form-control laplich-control'></div>\r\n" +
//                    "                           </div>\r\n" +
//                    "                       </div>\r\n" +
//                    "                   </div>\r\n" +
//                    "                   <div class='col-sm-12' style=\"\">\r\n" +
//                    "                      <div class='form-group'>" + WebLanguage.GetLanguage(OSiteParam, "Ghi chú") + "<input id='txtGhiChu' class='form-control laplich-control'></div>\r\n" +
//                    "                   </div>\r\n" +
//                    "               </div>\r\n" +
//                    "          </div>\r\n" +
//                    "          <div id='divChuyenGiaListBlock' style='" + (string.IsNullOrEmpty(lichhoichanid) ? "display:none;" : "display:block") + "'>\r\n" +
//                    "               <div class='row'>\r\n" +
//                    "                   <div class='col-sm-6'>\r\n" +
//                    "                       <div class='ibox-title'>\r\n" +
//                    "                           <h5>" + WebLanguage.GetLanguage(OSiteParam, "Danh sách đơn vị tham gia") + "</h5>\r\n" +
//                    "                           <a style='float:right;' class='clsUpdateChuyenGiaList' title='Thêm mới đơn vị tham gia' href='javascript:ShowPopupAddDonVi();'><img src='./themes/img/cabenh/plus.png' width='20px' height='20px'></a>\r\n" +
//                    "                       </div>\r\n" +
//                    "                       <div class='ibox-content' id='divDonViBelongLichHoiChanList'>\r\n" +
//                    //DrawCaBenhBelongLichHoiChanList(ORenderInfo,lichhoichanid).HtmlContent +
//                    "                       </div>\r\n" +
//                    "                   </div>\r\n" +
//                    "                   <div class='col-sm-6'>\r\n" +
//                    "                       <div class='ibox-title'>\r\n" +
//                    "                           <h5>" + WebLanguage.GetLanguage(OSiteParam, "Danh sách chuyên gia tư vấn") + "</h5>\r\n" +
//                    "                           <a style='float:right;' class='clsUpdateChuyenGiaList' title='Thêm mới chuyên gia tư vấn' href='javascript:ShowPopupAddChuyenGia();'><img src='./themes/img/cabenh/plus.png' width='20px' height='20px'></a>\r\n" +
//                    "                       </div>\r\n" +
//                    "                       <div class='ibox-content' id='divChuyenGiaBelongLichHoiChanList'>\r\n" +
//                    //DrawCaBenhBelongLichHoiChanList(ORenderInfo,lichhoichanid).HtmlContent +
//                    "                       </div>\r\n" +
//                    "                   </div>\r\n" +
//                    "               </div>\r\n" +
//                    "          </div>\r\n" +
//                    "          <div id='divCaBenhListBlock' style='" + (string.IsNullOrEmpty(lichhoichanid) ? "display:none;" : "display:block") + "'>\r\n" +
//                    "               <div class='ibox-title'>\r\n" +
//                    "                   <h5>" + WebLanguage.GetLanguage(OSiteParam, "Danh sách ca bệnh") + "</h5>\r\n" +
//                                        "<a style='float:right;' class='clsUpdateCaBenhList' title='Thêm mới ca bệnh' href='javascript:ShowPopupAddCaBenh();'><img src='./themes/img/cabenh/plus.png' width='20px' height='20px'></a>\r\n" +
//                    "                   <a style='float:right;' id='btnEditSttCaBenhs' href='javascript:ShowEditSttCaBenh();' title='" + WebLanguage.GetLanguage(OSiteParam, "Sửa STT") + "' ><i class='fa fa-pencil-square-o' style='font-size:20px; margin-right: 5px;'></i></a>\r\n" +
//                    "                   <a style='float:right; display:none;' id='btnUpdateSttCaBenhs' href='javascript:UpdateSttCaBenhs();' title='" + WebLanguage.GetLanguage(OSiteParam, "Lưu") + "' ><i class='fa fa-save' style='font-size:20px; margin-right: 5px;'></i></a>\r\n" +
//                    "               </div>\r\n" +
//                    "               <div class='ibox-content' id='divCaBenhBelongLichHoiChanList'>\r\n" +
//                    //DrawCaBenhBelongLichHoiChanList(ORenderInfo,lichhoichanid).HtmlContent +
//                    "               </div>\r\n" +
//                    "          </div>\r\n" +
//                    "   </div>\r\n" +
//                    "</div>\r\n" +
//                    "</form> \r\n" +
//                #region Phần hiển thị popup
//                        "<div id=\"divFormModal\" class=\"modal fade\" style=\"overflow: hidden\" role=\"dialog\" aria-labelledby=\"largeModal\" aria-hidden=\"true\" data-backdrop=\"static\">\r\n" +
//                        "    <div class=\"modal-dialog\" style='width:90%; height:90%;'>\r\n" +
//                        "       <div class=\"modal-content\" style='width:100%; height:100%; position: relative;'>\r\n" +
//                        "           <div class=\"panel-heading\">\r\n" +
//                        "               <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-hidden=\"true\">&times;</button>\r\n" +
//                        "               <h2 class=\"modal-title\" id=\"ModalTitle\"></h2>\r\n" +
//                        "           </div> \r\n" +
//                        "           <div class=\"modal-body\" id=\"divModalContent\" style='width:100%; padding-top:0; position: absolute; top:50px; bottom:0px;'></div> \r\n" +
//                        "        </div> \r\n" +
//                        "    </div> \r\n" +
//                        "</div> \r\n";
//                #endregion
//                #endregion Html
//                #region javaScript
//                string js =
//                    "<script language=\"javascript\">\r\n" +
//                    "   RenderInfo=CreateRenderInfo();\r\n" +
//                    "   var isSystemAdmin=" + (user.IsSystemAdmin == 1 ? "true" : "false") + ";\r\n" +
//                    "   var isChuTri=" + (isChuTri ? "true" : "false") + ";\r\n" +
//                    "   var isThuKy=" + (isThuKy ? "true" : "false") + ";\r\n" +
//                    "   var isPheDuyet=" + (isPheDuyet ? "true" : "false") + ";\r\n" +
//                    "   var themPermission=" + (themPermission ? "true" : "false") + ";\r\n" +
//                    "   var suaPermission=" + (suaPermission ? "true" : "false") + ";\r\n" +
//                    "   var xoaPermission=" + (xoaPermission ? "true" : "false") + ";\r\n" +
//                    "   var chuyenDuyetPermission=" + (chuyenDuyetPermission ? "true" : "false") + ";\r\n" +
//                    "   var huyPermission=" + (huyPermission ? "true" : "false") + ";\r\n" +
//                    "   var CurrentPageIndex=0;\r\n" +
//                    "   var CheckedArr=[];\r\n" +
//                    "   var CheckedDonViArr=[];\r\n" +
//                    "   var duyet=false;\r\n" +
//                    "   var isLapLich=false;\r\n" +
//                    "   var hasLapLich=false;\r\n" +
//                    "   var cabenhs=null;\r\n" +
//                    "   var lichhoichanid='" + lichhoichanid + "';\r\n" +
//                    "   var _lichhoichanid='';\r\n" +
//                    "   var cabenhsTao=null;\r\n" +
//                    "   var cabenhsXoa=null;\r\n" +
//                    "   var lstCaBenh=null;\r\n" +
//                    "   var khos=null;\r\n" +
//                    "   var cabenhThem=null;\r\n" +
//                    "   var changeControl=false;\r\n" +
//                    "   var laplich=null;\r\n" +
//                    "   var onHoantat=false;\r\n" +
//                    "   $(document).ready(function() \r\n" +
//                    "   {\r\n" +
//                    //"    if(lichhoichanid){\r\n" +
//                    //"       DrawDanhSachCaBenhByLichHoiChan(lichhoichanid);\r\n" +
//                    //"       loadLichHoiChan();\r\n" +
//                    //"    }\r\n" +
//                    "    OnLoadForm();\r\n" +
//                    "    CallInitSelect2('cboNguoiLapLich','" + WebEnvironments.GetRemoteProcessDataUrl(OwnerUserService.StaticServiceId) + "',\"" + WebLanguage.GetLanguage(OSiteParam, "Người tổng hợp") + "\"/*,'false'*/);\r\n" +
//                    "    CallInitSelect2('cboNguoiDuyet','" + WebEnvironments.GetRemoteProcessDataUrl(OwnerUserService.StaticServiceId) + "',\"" + WebLanguage.GetLanguage(OSiteParam, "Người duyệt") + "\"/*,'false'*/);\r\n" +
//                    "    CallInitSelect2('cboChuTri','" + WebEnvironments.GetRemoteProcessDataUrl(BacSyService.StaticServiceId, donViTuVanMa) + "',\"" + WebLanguage.GetLanguage(OSiteParam, "Chủ trì") + "\"/*,'false'*/);\r\n" +
//                    "    CallInitSelect2('cboThuKy','" + WebEnvironments.GetRemoteProcessDataUrl(BacSyService.StaticServiceId, donViTuVanMa) + "',\"" + WebLanguage.GetLanguage(OSiteParam, "Thư ký") + "\"/*,'false'*/);\r\n" +
//                    "    CallInitSelect2('cboChanDoanRaVien', '" + WebEnvironments.GetRemoteProcessDataUrl(IcdService.StaticServiceId) + "','Chẩn đoán chính');\r\n" +
//                    "    CallInitSelect2('cboChuyenKhoa', '" + WebEnvironments.GetRemoteProcessDataUrl(ChuyenKhoaDaoTaoTtService.StaticServiceId) + "','Chuyên khoa');\r\n" +
//                    "    initDateTimePicker();\r\n" +
//                    "    $(\"#frmLichHoiChan\").find(':input',':select').change(function(){\r\n" +
//                    "        changeControl = true;\r\n" +
//                    "    });\r\n" +
//                    "   });\r\n" +
//                #region Clear
//                    "   function Clear(){\r\n" +
//                    "      window.location.href = '" + WebScreen.BuildUrl(OSiteParam, WebSessionUtility.GetCurrentLoginUser(OSiteParam).OwnerCode, "LichHoiChan", new WebParamCls[] { }) + "';\r\n" +
//                    "   }\r\n" +
//                #endregion Clear
//                #region Thêm mới/cập nhật lịch hội chẩn
//                    "   function SaveLichHoiChan(){\r\n" +
//                    "    if(!lichhoichanid){\r\n" +//Thêm mới
//                    "           AjaxOut = OneTSQ.WebParts.LichHoiChan.ServerSideTaoLichHoiChan(RenderInfo,cboNguoiLapLich.value,txtThoiGianLapLich.value,cboNguoiDuyet.value,txtThoiGianDuyet.value,txtDiaDiem.value,cboThuKy.value,cboChuTri.value,dtBatDau.value,dtKetThuc.value,txtGhiChu.value,cboChuyenKhoa.value).value;\r\n" +
//                    "           if(AjaxOut.Error){\r\n" +
//                    "               callGallAlert(AjaxOut.InfoMessage);\r\n" +
//                    "               return;\r\n" +
//                    "           }\r\n" +
//                    "           lichhoichanid=AjaxOut.RetExtraParam1;\r\n" +
//                    "           toastr.info(\"" + WebLanguage.GetLanguage(OSiteParam, "Đã lưu!") + "\");\r\n" +
//                    "           suaPermission=true;\r\n" +
//                    "           xoaPermission=true;\r\n" +
//                    "           chuyenDuyetPermission=true;\r\n" +
//                    "           huyPermission=true;\r\n" +
//                    "           OnLoadForm();\r\n" +
//                    "           AddHistory(lichhoichanid, '" + WebPartTitle + "', 'Thêm mới', 'Tác vụ form');\r\n" +
//                    "     }\r\n" +
//                    "     else{\r\n" +//Cập nhật
//                    "             if(laplich){\r\n" +
//                    "               if(laplich.lichhoichan.TRANGTHAI==" + (int)LichHoiChanCls.eTrangThai.Moi + "){\r\n" +
//                    "               AjaxOut = OneTSQ.WebParts.LichHoiChan.ServerSideSaveLichHoiChan(RenderInfo,lichhoichanid,cboNguoiLapLich.value,txtThoiGianLapLich.value,cboNguoiDuyet.value,txtThoiGianDuyet.value,txtDiaDiem.value,cboThuKy.value,cboChuTri.value,dtBatDau.value,dtKetThuc.value,txtGhiChu.value,cboChuyenKhoa.value).value;\r\n" +
//                    "               if(AjaxOut.Error){\r\n" +
//                    "                  callGallAlert(AjaxOut.InfoMessage);\r\n" +
//                    "                  return;\r\n" +
//                    "               }\r\n" +
//                    "               toastr.info(\"" + WebLanguage.GetLanguage(OSiteParam, "Đã lưu!") + "\");\r\n" +
//                    //"               if(hoanTat==true) \r\n" +
//                    //"                   lstCaBenh=AjaxOut.RetObject;\r\n" +
//                    //"               if(hoanTat==false) \r\n" +
//                    //"               { \r\n" +
//                    //"                   AjaxOut = OneTSQ.WebParts.LichHoiChan.ServerSideGetCaBenhByLichHoiChanId(RenderInfo,lichhoichanid).value;\r\n" +
//                    //"                   if(AjaxOut.Error){\r\n" +
//                    //"                      callGallAlert(AjaxOut.InfoMessage);\r\n" +
//                    //"                      return;\r\n" +
//                    //"                   }\r\n" +
//                    //"                   lstCaBenh=AjaxOut.RetObject;\r\n" +
//                    //"               } \r\n" +
//                    "               AddHistory(lichhoichanid, '" + WebPartTitle + "', 'Cập nhật', 'Tác vụ form');\r\n" +
//                    "              }\r\n" +
//                    "          }\r\n" +
//                    "     }\r\n" +
//                    //"     if(DrawDanhSachCaBenh(txtTimKiem.value,cboKhoaDieuTri.value,cboLoaiBenhAn.value,cboDonViHanhChinh.value,cboChanDoanRaVien.value,dtBatDau.value,dtKetThuc.value)){\r\n" +
//                    //"        changeCaBenh();\r\n" +
//                    //"     }\r\n" +
//                    //"     _lichhoichanid=lichhoichanid;\r\n" +
//                    "   }\r\n" +
//                #endregion Thêm mới/cập nhật lịch hội chẩn
//                #region Xóa lịch hội chẩn
//                    "   function DeleteLichHoiChan(){\r\n" +
//                    "       swal({ \r\n" +
//                    "               title: \"Bạn có chắc chắn xóa lịch hội chẩn này?\", \r\n" +
//                    //"               text: \"" + "Đang thực hiện xóa bệnh án này ra khỏi hệ thống" + "!\", \r\n" +
//                    "               type: \"warning\", \r\n" +
//                    "               showCancelButton: true, \r\n" +
//                    "               confirmButtonColor: \"#DD6B55\", \r\n" +
//                    "               confirmButtonText: \"" + "Xóa" + "\", \r\n" +
//                    "               cancelButtonText: \"" + "Hủy bỏ" + "\", \r\n" +
//                    "               closeOnConfirm: true, \r\n" +
//                    "               closeOnCancel: true\r\n" +
//                    "           }, function () { \r\n" +
//                    "               AjaxOut = OneTSQ.WebParts.LichHoiChan.ServerSideXoaLichHoiChan(RenderInfo,lichhoichanid).value;\r\n" +
//                    "               if(AjaxOut.Error)\r\n" +
//                    "               {\r\n" +
//                    "                   callGallAlert(AjaxOut.InfoMessage);\r\n" +
//                    "                   return;\r\n" +
//                    "               }\r\n" +
//                    "               else \r\n" +
//                    "               {\r\n" +
//                    "                   toastr.info('" + WebLanguage.GetLanguage(OSiteParam, "Đã xóa!") + "');\r\n" +
//                    "                   DeleteHistory(lichhoichanid);\r\n" +
//                   "                    window.location.href = AjaxOut.RetUrl;\r\n" +
//                    "               }\r\n" +
//                    "       }); \r\n" +
//                    "   }\r\n" +
//                    " function uploaded(evt) {\r\n" +
//                    "       var parser = new DOMParser();\r\n" +
//                    "       var xmlDoc = parser.parseFromString(evt.currentTarget.responseText,\"text/xml\"); \r\n" +
//                    "       var mes = xmlDoc.getElementsByTagName(\"InfoMessage\")[0].childNodes[0].nodeValue;\r\n" +
//                    "       callSweetAlert(mes);\r\n" +
//                    "         Reload();\r\n" +

//                    " }\r\n" +
//                    "   function Import()\r\n" +
//                    "   {\r\n" +
//                    "        RenderInfo=CreateRenderInfo();\r\n" +
//                    "        fileUploadValue=document.getElementById('fileUpload').value;\r\n" +
//                    "        if(fileUploadValue==''){\r\n" +
//                    "            callSweetAlert('Chưa xác định tài liệu gắn kèm!');\r\n" +
//                    "            return;\r\n" +
//                    "        }\r\n" +
//                    "       document.getElementById('divProcessing').innerHTML='Đang Import lịch hội chẩn';\r\n" +
//                    "       swal({ \r\n" +
//                    "               title: \"" + WebLanguage.GetLanguage(OSiteParam, "Thông báo") + "\", \r\n" +
//                    "               text: \"" + WebLanguage.GetLanguage(OSiteParam, "Đang thực hiện Import lịch hội chẩn") + "\", \r\n" +
//                    "               type: \"warning\", \r\n" +
//                    "               showCancelButton: true, \r\n" +
//                    "               confirmButtonColor: \"#DD6B55\", \r\n" +
//                    "               confirmButtonText: \"Thực hiện\", \r\n" +
//                    "               cancelButtonText: \"" + WebLanguage.GetLanguage(OSiteParam, "Hủy bỏ") + "\", \r\n" +
//                    "               closeOnConfirm: false \r\n" +
//                    "           }, function () { \r\n" +
//                    "                  var fd = new FormData();\r\n" +
//                    "               fd.append(\"fileUploadAvatar\", document.getElementById('fileUpload').files[0]);\r\n" +
//                    "               var xhr = new XMLHttpRequest();\r\n" +
//                    "               xhr.addEventListener(\"load\",uploaded, false);\r\n" +

//                    "               xhr.open(\"POST\", \"" + WebConfig.GetUploadHandler(OSiteParam, SessionId, UserId, LoginName) + "\");\r\n" +

//                    "               xhr.send(fd);\r\n" +
//                    "           }\r\n" +
//                    "       ); \r\n" +
//                    "   }\r\n" +
//                #endregion Xóa lịch hội chẩn

//                #region Show popup Thêm mới đơn vị tham vấn
//                    "   function ShowPopupAddDonVi()\r\n" +
//                    "   {\r\n" +
//                    "       CurrentPageIndex=0;\r\n" +
//                    "       CheckedArr=[];\r\n" +
//                    "       CheckedDonViArr=[];\r\n" +
//                    "       RenderInfo=CreateRenderInfo();\r\n" +
//                    "       AjaxOut = OneTSQ.WebParts.LichHoiChan.PopupAddDonVi(RenderInfo, lichhoichanid).value;\r\n" +
//                    "       if(AjaxOut.Error)\r\n" +
//                    "       {\r\n" +
//                    "           callGallAlert(AjaxOut.InfoMessage);\r\n" +
//                    "           return;\r\n" +
//                    "       }\r\n" +
//                    "       document.getElementById('divModalContent').innerHTML=AjaxOut.HtmlContent;\r\n" +
//                    "       document.getElementById('ModalTitle').innerHTML= '<span class=\"fa fa-pencil-square-o\">Thêm mới đơn vị tham gia</span>';\r\n" +
//                    "       CallInitSelect2('cbbDonVi', '" + WebEnvironments.GetRemoteProcessDataUrl(DonViCongTacService.StaticServiceId) + "','" + WebLanguage.GetLanguage(OSiteParam, "Đơn vị") + "');\r\n" +
//                    //"       CallInitSelect2('cbbBenhVien', '" + WebEnvironments.GetRemoteProcessDataUrl(BenhVienService.StaticServiceId) + "','" + WebLanguage.GetLanguage(OSiteParam, "Bệnh viện") + "');\r\n" +
//                    "       CallInitSelect2('cbbChuyenKhoaFilter','" + WebEnvironments.GetRemoteProcessDataUrl(ChuyenKhoaService.StaticServiceId) + "','" + WebLanguage.GetLanguage(OSiteParam, "Chuyên khoa") + "');\r\n" +
//                    "       $('#divFormModal').modal('show');\r\n" +
//                    "   }\r\n" +
//                #endregion Show popup Thêm mới đơn vị tham vấn
//                #region Show popup Thêm mới chuyên gia tư vấn
//                    "   function ShowPopupAddChuyenGia()\r\n" +
//                    "   {\r\n" +
//                    "       CurrentPageIndex=0;\r\n" +
//                    "       CheckedArr=[];\r\n" +
//                    "       CheckedDonViArr=[];\r\n" +
//                    "       RenderInfo=CreateRenderInfo();\r\n" +
//                    "       AjaxOut = OneTSQ.WebParts.LichHoiChan.PopupAddChuyenGia(RenderInfo, lichhoichanid).value;\r\n" +
//                    "       if(AjaxOut.Error)\r\n" +
//                    "       {\r\n" +
//                    "           callGallAlert(AjaxOut.InfoMessage);\r\n" +
//                    "           return;\r\n" +
//                    "       }\r\n" +
//                    "       document.getElementById('divModalContent').innerHTML=AjaxOut.HtmlContent;\r\n" +
//                    "       document.getElementById('ModalTitle').innerHTML= '<span class=\"fa fa-pencil-square-o\">Thêm mới chuyên gia tư vấn</span>';\r\n" +
//                    "       CallInitSelect2('cbbDonVi', '" + WebEnvironments.GetRemoteProcessDataUrl(DonViCongTacService.StaticServiceId) + "','" + WebLanguage.GetLanguage(OSiteParam, "Đơn vị") + "');\r\n" +
//                    //"       CallInitSelect2('cbbBenhVien', '" + WebEnvironments.GetRemoteProcessDataUrl(BenhVienService.StaticServiceId) + "','" + WebLanguage.GetLanguage(OSiteParam, "Bệnh viện") + "');\r\n" +
//                    "       CallInitSelect2('cbbChuyenKhoaFilter','" + WebEnvironments.GetRemoteProcessDataUrl(ChuyenKhoaService.StaticServiceId) + "','" + WebLanguage.GetLanguage(OSiteParam, "Chuyên khoa") + "');\r\n" +
//                    "       $('#divFormModal').modal('show');\r\n" +
//                    "   }\r\n" +
//                #endregion Show popup Thêm mới chuyên gia tư vấn
//                #region Next trang đơn vị tham vấn và hiển thị kết quả tìm kiếm chuyên gia tư vấn
//                    "   function DonViNextPage(PageIndex)\r\n" +
//                    "   {\r\n" +
//                    "       CurrentPageIndex = PageIndex;\r\n" +
//                    "       setTimeout('GetDonViListForPage()',10);\r\n" +
//                    "   }\r\n" +

//                    "   function GetDonViListForPage()\r\n" +
//                    "   {\r\n" +
//                    "       RenderInfo=CreateRenderInfo();\r\n" +
//                    "       keyword = txtKeyword.value;\r\n" +
//                    "       donViMa = cbbDonVi.value;\r\n" +
//                    "       chuyenKhoaMa = cbbChuyenKhoaFilter.value;\r\n" +
//                    "       AjaxOut = OneTSQ.WebParts.LichHoiChan.DrawDonViSearchResultList(RenderInfo, CurrentPageIndex, lichhoichanid, keyword, donViMa, chuyenKhoaMa, CheckedArr).value;\r\n" +
//                    "       document.getElementById('divDonViList').innerHTML=AjaxOut.HtmlContent;\r\n" +
//                    "       CheckCheckAllChuyenGiaPage();\r\n" +
//                    "   }\r\n" +
//                    "   function SearchDonVi()\r\n" +
//                    "   {\r\n" +
//                    "       CurrentPageIndex=0;\r\n" +
//                    "       CheckedArr=[];\r\n" +
//                    "       CheckedDonViArr=[];\r\n" +
//                    "       GetDonViListForPage();\r\n" +
//                    "   }\r\n" +
//                    "   function SearchChuyenGia()\r\n" +
//                    "   {\r\n" +
//                    "       CurrentPageIndex=0;\r\n" +
//                    "       CheckedArr=[];\r\n" +
//                    "       CheckedDonViArr=[];\r\n" +
//                    "       GetDonViListForPage();\r\n" +
//                    "   }\r\n" +
//                #endregion Next trang đơn vị tham vấn và hiển thị kết quả tìm kiếm chuyên gia tư vấn
//                #region Next trang chuyên gia tư vấn và hiển thị kết quả tìm kiếm chuyên gia tư vấn
//                    "   function ChuyenGiaNextPage(PageIndex)\r\n" +
//                    "   {\r\n" +
//                    "       CurrentPageIndex = PageIndex;\r\n" +
//                    "       setTimeout('GetChuyenGiaListForPage()',10);\r\n" +
//                    "   }\r\n" +

//                    "   function GetChuyenGiaListForPage()\r\n" +
//                    "   {\r\n" +
//                    "       RenderInfo=CreateRenderInfo();\r\n" +
//                    "       keyword = txtKeyword.value;\r\n" +
//                    "       chuyenKhoaMa = cbbChuyenKhoaFilter.value;\r\n" +
//                    "       AjaxOut = OneTSQ.WebParts.LichHoiChan.DrawChuyenGiaSearchResultList(RenderInfo, CurrentPageIndex, lichhoichanid, keyword, chuyenKhoaMa, CheckedArr).value;\r\n" +
//                    "       document.getElementById('divChuyenGiaList').innerHTML=AjaxOut.HtmlContent;\r\n" +
//                    "       CheckCheckAllChuyenGiaPage();\r\n" +
//                    "   }\r\n" +
//                    "   function SearchDonVi()\r\n" +
//                    "   {\r\n" +
//                    "       CurrentPageIndex=0;\r\n" +
//                    "       CheckedArr=[];\r\n" +
//                    "       CheckedDonViArr=[];\r\n" +
//                    "       GetDonViListForPage();\r\n" +
//                    "   }\r\n" +
//                    "   function SearchChuyenGia()\r\n" +
//                    "   {\r\n" +
//                    "       CurrentPageIndex=0;\r\n" +
//                    "       CheckedArr=[];\r\n" +
//                    "       CheckedDonViArr=[];\r\n" +
//                    "       GetChuyenGiaListForPage();\r\n" +
//                    "   }\r\n" +
//                #endregion Next trang chuyên gia tư vấn và hiển thị kết quả tìm kiếm chuyên gia tư vấn
//                #region ckbAllChuyenGiaPage_onclick
//                    "   function ckbAllChuyenGiaPage_onclick(sender){\r\n" +
//                    "       if (sender.checked){\r\n" +
//                    "           $('.clsCkbChuyenGia').each(function(index, element/*this*/) {\r\n" +
//                    "               if (!element.checked){\r\n" +
//                    "                   element.checked=true;\r\n" +
//                    "                   CheckedArr.push(element.id);\r\n" +
//                    "                   CheckedDonViArr.push($('#tddvct'+element.id).text());\r\n" +
//                    "               }\r\n" +
//                    "           });\r\n" +
//                    "       }\r\n" +
//                    "       else {\r\n" +
//                                "$('.clsCkbChuyenGia').each(function(index, element/*this*/) {\r\n" +
//                    "               if (element.checked){\r\n" +
//                    "                   element.checked=false;\r\n" +
//                    "                   for (var i=0; i < CheckedArr.length; i++) {\r\n" +
//                    "                       if(CheckedArr[i] == element.id){\r\n" +
//                    "	                        CheckedArr.splice(i,1);\r\n" +
//                    "	                        CheckedDonViArr.splice(i,1);\r\n" +
//                    "	                        break;\r\n" +
//                    "                       }\r\n" +
//                    "                   }\r\n" +
//                    "               }\r\n" +
//                    "           });\r\n" +
//                    "       }\r\n" +
//                    "   }\r\n" +
//                #endregion ckbAllChuyenGiaPage_onclick
//                #region ckbChuyenGia_onclick
//                    "   function ckbChuyenGia_onclick(sender){\r\n" +
//                    "       if (sender.checked){\r\n" +
//                    "           CheckedArr.push(sender.id);\r\n" +
//                    "           CheckedDonViArr.push($('#tddvct'+sender.id).text());\r\n" +
//                    "           CheckCheckAllChuyenGiaPage();\r\n" +
//                    "       }\r\n" +
//                    "       else{\r\n" +
//                    "               for (var index=0; index < CheckedArr.length; index ++) {\r\n" +
//                    "                   if(CheckedArr[index] == sender.id){\r\n" +
//                    "	                    CheckedArr.splice(index,1);\r\n" +
//                    "	                    CheckedDonViArr.splice(index,1);\r\n" +
//                    "	                    break;\r\n" +
//                    "                   }\r\n" +
//                    "               }\r\n" +
//                    "           ckbAllPage.checked=false;\r\n" +
//                    "       }\r\n" +
//                    "   }\r\n" +
//                #endregion ckbChuyenGia_onclick
//                #region Check CheckAllChuyenGiaPage: kiểm tra nếu tất cả checkbox trên row được check thì check checkbox all
//                    "   function CheckCheckAllChuyenGiaPage(){\r\n" +
//                    "       checkAll=true;\r\n" +
//                    "       $('.clsCkbChuyenGia').each(function(index, element/*this*/) {\r\n" +
//                    "           if (!element.checked){\r\n" +
//                    "               checkAll=false;\r\n" +
//                    "               return;\r\n" +
//                    "           }\r\n" +
//                    "       });\r\n" +
//                    "       ckbAllPage.checked=checkAll;\r\n" +
//                    "   }\r\n" +
//                #endregion Check CheckAllChuyenGiaPage: kiểm tra nếu tất cả checkbox trên row được check thì check checkbox all
//                #region Thêm mới đơn vị tham vấn vào lịch hội chẩn
//                    "   function AddDonVi(){\r\n" +
//                    "       if(CheckedArr.length==0){\r\n" +
//                    "           callGallAlert('" + WebLanguage.GetLanguage(OSiteParam, "Bạn chưa chọn đơn vị để thêm vào lịch!") + "');\r\n" +
//                    "           return;\r\n" +
//                    "       }\r\n" +
//                    "       AjaxOut = OneTSQ.WebParts.LichHoiChan.ServerSideAddDonVis(RenderInfo, lichhoichanid, CheckedArr, CheckedDonViArr).value;\r\n" +
//                    "       if(AjaxOut.Error){\r\n" +
//                    "           callGallAlert(AjaxOut.InfoMessage);\r\n" +
//                    "           return;\r\n" +
//                    "       }\r\n" +
//                    "       toastr.info(\"" + WebLanguage.GetLanguage(OSiteParam, "Đã thêm!") + "\");\r\n" +
//                    "       divDonViBelongLichHoiChanList.innerHTML=AjaxOut.HtmlContent;\r\n" +
//                    "       $('#divFormModal').modal('hide');\r\n" +
//                    "       AddHistory(lichhoichanid, '" + WebPartTitle + "', 'Thêm đơn vị tham vấn', 'Tác vụ form');\r\n" +
//                    "   }\r\n" +
//                #endregion Thêm mới đơn vị tham vấn vào lịch hội chẩn
//                #region Thêm mới chuyên gia tư vấn vào lịch hội chẩn
//                    "   function AddChuyenGia(){\r\n" +
//                    "       if(CheckedArr.length==0){\r\n" +
//                    "           callGallAlert('" + WebLanguage.GetLanguage(OSiteParam, "Bạn chưa chọn đơn vị để thêm vào lịch!") + "');\r\n" +
//                    "           return;\r\n" +
//                    "       }\r\n" +
//                    "       AjaxOut = OneTSQ.WebParts.LichHoiChan.ServerSideAddChuyenGias(RenderInfo, lichhoichanid, CheckedArr).value;\r\n" +
//                    "       if(AjaxOut.Error){\r\n" +
//                    "           callGallAlert(AjaxOut.InfoMessage);\r\n" +
//                    "           return;\r\n" +
//                    "       }\r\n" +
//                    "       toastr.info(\"" + WebLanguage.GetLanguage(OSiteParam, "Đã thêm!") + "\");\r\n" +
//                    "       divChuyenGiaBelongLichHoiChanList.innerHTML=AjaxOut.HtmlContent;\r\n" +
//                    "       $('#divFormModal').modal('hide');\r\n" +
//                    "       AddHistory(lichhoichanid, '" + WebPartTitle + "', 'Thêm chuyên gia tư vấn', 'Tác vụ form');\r\n" +
//                    "   }\r\n" +
//                #endregion Thêm mới chuyên gia tư vấn vào lịch hội chẩn
//                #region Xóa đơn vị tham gia khỏi lịch hội chẩn
//                    "   function RemoveDonVi(bacSyId){\r\n" +
//                    "       if(laplich.lichhoichan.TRANGTHAI!=" + (int)LichHoiChanCls.eTrangThai.Moi + " && laplich.lichhoichan.TRANGTHAI!=" + (int)LichHoiChanCls.eTrangThai.TuChoiDuyet + "){\r\n" +
//                    "           callGallAlert('" + WebLanguage.GetLanguage(OSiteParam, "Chỉ được xóa đơn vị khi trạng thái lịch là mới hoặc từ chối duyệt.") + "');\r\n" +
//                    "           return;\r\n" +
//                    "       }\r\n" +
//                    "       swal({ \r\n" +
//                    "               title: \"Bạn có chắc chắn xóa không?\", \r\n" +
//                    //"               text: \"" + "Đang thực hiện xóa bệnh án này ra khỏi hệ thống" + "!\", \r\n" +
//                    "               type: \"warning\", \r\n" +
//                    "               showCancelButton: true, \r\n" +
//                    "               confirmButtonColor: \"#DD6B55\", \r\n" +
//                    "               confirmButtonText: \"" + "Xóa" + "\", \r\n" +
//                    "               cancelButtonText: \"" + "Hủy bỏ" + "\", \r\n" +
//                    "               closeOnConfirm: false \r\n" +
//                    "           }, function () { \r\n" +
//                    "               removeChuyenGiaArray=[bacSyId];\r\n" +
//                    "               AjaxOut = OneTSQ.WebParts.LichHoiChan.ServerSideRemoveDonVis(RenderInfo,lichhoichanid, removeChuyenGiaArray).value;\r\n" +
//                    "               if(AjaxOut.Error){\r\n" +
//                    "                   callGallAlert(AjaxOut.InfoMessage);\r\n" +
//                    "                   return;\r\n" +
//                    "               }\r\n" +
//                    "               swal.close();\r\n" +
//                    "               toastr.info(\"" + WebLanguage.GetLanguage(OSiteParam, "Đã xóa!") + "\");\r\n" +
//                    "               divDonViBelongLichHoiChanList.innerHTML=AjaxOut.HtmlContent;\r\n" +
//                    "               $('#divFormModal').modal('hide');\r\n" +
//                    "               AddHistory(lichhoichanid, '" + WebPartTitle + "', 'Xóa đơn vị tham vấn', 'Tác vụ form');\r\n" +
//                    "           }); \r\n" +
//                    "   }\r\n" +
//                #endregion Xóa đơn vị tham gia khỏi lịch hội chẩn
//                #region Xóa chuyên gia tư vấn khỏi lịch hội chẩn
//                    "   function RemoveChuyenGia(bacSyId){\r\n" +
//                    "       if(laplich.lichhoichan.TRANGTHAI!=" + (int)LichHoiChanCls.eTrangThai.Moi + " && laplich.lichhoichan.TRANGTHAI!=" + (int)LichHoiChanCls.eTrangThai.TuChoiDuyet + "){\r\n" +
//                    "           callGallAlert('" + WebLanguage.GetLanguage(OSiteParam, "Chỉ được xóa đơn vị khi trạng thái lịch là mới hoặc từ chối duyệt.") + "');\r\n" +
//                    "           return;\r\n" +
//                    "       }\r\n" +
//                    "       swal({ \r\n" +
//                    "               title: \"Bạn có chắc chắn xóa không?\", \r\n" +
//                    //"               text: \"" + "Đang thực hiện xóa bệnh án này ra khỏi hệ thống" + "!\", \r\n" +
//                    "               type: \"warning\", \r\n" +
//                    "               showCancelButton: true, \r\n" +
//                    "               confirmButtonColor: \"#DD6B55\", \r\n" +
//                    "               confirmButtonText: \"" + "Xóa" + "\", \r\n" +
//                    "               cancelButtonText: \"" + "Hủy bỏ" + "\", \r\n" +
//                    "               closeOnConfirm: false \r\n" +
//                    "           }, function () { \r\n" +
//                    "               removeChuyenGiaArray=[bacSyId];\r\n" +
//                    "               AjaxOut = OneTSQ.WebParts.LichHoiChan.ServerSideRemoveChuyenGias(RenderInfo,lichhoichanid, removeChuyenGiaArray).value;\r\n" +
//                    "               if(AjaxOut.Error){\r\n" +
//                    "                   callGallAlert(AjaxOut.InfoMessage);\r\n" +
//                    "                   return;\r\n" +
//                    "               }\r\n" +
//                    "               swal.close();\r\n" +
//                    "               toastr.info(\"" + WebLanguage.GetLanguage(OSiteParam, "Đã xóa!") + "\");\r\n" +
//                    "               divChuyenGiaBelongLichHoiChanList.innerHTML=AjaxOut.HtmlContent;\r\n" +
//                    "               $('#divFormModal').modal('hide');\r\n" +
//                    "               AddHistory(lichhoichanid, '" + WebPartTitle + "', 'Xóa chuyên gia tư vấn', 'Tác vụ form');\r\n" +
//                    "           }); \r\n" +
//                    "   }\r\n" +
//                #endregion Xóa chuyên gia tư vấn khỏi lịch hội chẩn

//                #region Show popup Thêm mới ca bệnh
//                    "   function ShowPopupAddCaBenh()\r\n" +
//                    "   {\r\n" +
//                    "       CurrentPageIndex=0;\r\n" +
//                    "       CheckedArr=[];\r\n" +
//                    //"       CheckedArr.push('ds');\r\n" +
//                    "       RenderInfo=CreateRenderInfo();\r\n" +
//                    "       AjaxOut = OneTSQ.WebParts.LichHoiChan.PopupAddCaBenh(RenderInfo, lichhoichanid).value;\r\n" +
//                    "       if(AjaxOut.Error)\r\n" +
//                    "       {\r\n" +
//                    "           callGallAlert(AjaxOut.InfoMessage);\r\n" +
//                    "           return;\r\n" +
//                    "       }\r\n" +
//                    "       document.getElementById('divModalContent').innerHTML=AjaxOut.HtmlContent;\r\n" +
//                    "       document.getElementById('ModalTitle').innerHTML= '<span class=\"fa fa-pencil-square-o\">Thêm mới ca bệnh</span>';\r\n" +
//                    "       $('#dtThoiGian').datetimepicker({ \r\n" +
//                    "           format: 'HH:mm DD/MM/YYYY' \r\n" +
//                    "       }); \r\n" +
//                    "       $('.selectpicker').selectpicker({ \r\n" +
//                    "       }); \r\n" +
//                    "       $('.chosen-select').chosen({width: '100%'}); \r\n" +
//                    "       CallInitSelect2('cbbDonViThamVan', '" + WebEnvironments.GetRemoteProcessDataUrl(OwnerService.StaticServiceId) + "','" + WebLanguage.GetLanguage(OSiteParam, "Đơn vị tham vấn") + "');\r\n" +
//                    "       CallInitSelect2('cbbChanDoan', '" + WebEnvironments.GetRemoteProcessDataUrl(IcdService.StaticServiceId) + "','" + WebLanguage.GetLanguage(OSiteParam, "Chẩn đoán") + "');\r\n" +
//                    "       $('#divFormModal').modal('show');\r\n" +
//                    "   }\r\n" +
//                #endregion Show popup Thêm mới ca bệnh
//                #region Next trang ca bệnh và hiển thị kết quả tìm kiếm ca bệnh
//                    "   function NextCaBenhPage(PageIndex)\r\n" +
//                    "   {\r\n" +
//                    "       CurrentPageIndex = PageIndex;\r\n" +
//                    "       setTimeout('GetCaBenhListForPage()',10);\r\n" +
//                    "   }\r\n" +

//                    "   function GetCaBenhListForPage()\r\n" +
//                    "   {\r\n" +
//                    "       RenderInfo=CreateRenderInfo();\r\n" +
//                    "       keyword = txtKeyword.value;\r\n" +
//                    "       donViThamVan = cbbDonViThamVan.value;\r\n" +
//                    "       chanDoan = cbbChanDoan.value;\r\n" +
//                    "       AjaxOut = OneTSQ.WebParts.LichHoiChan.DrawCaBenhSearchResultList(RenderInfo, CurrentPageIndex, lichhoichanid, keyword, donViThamVan, chanDoan, CheckedArr).value;\r\n" +
//                    "       document.getElementById('divCaBenhList').innerHTML=AjaxOut.HtmlContent;\r\n" +
//                    "       CheckCheckAllCaBenhPage();\r\n" +
//                    //"       $('.i-checks').iCheck({\r\n" +
//                    //"           checkboxClass: 'icheckbox_square-green',\r\n" +
//                    //"           radioClass: 'iradio_square-green',\r\n" +
//                    //"       });\r\n" +
//                    "   }\r\n" +
//                    "   function SearchCaBenh()\r\n" +
//                    "   {\r\n" +
//                    "       CurrentPageIndex=0;\r\n" +
//                    "       CheckedArr=[];\r\n" +
//                    "       GetCaBenhListForPage();\r\n" +
//                    "   }\r\n" +
//                #endregion Next trang ca bệnh và hiển thị kết quả tìm kiếm ca bệnh
//                #region ckbAllCaBenhPage_onclick
//                    "   function ckbAllCaBenhPage_onclick(sender){\r\n" +
//                    "       if (sender.checked){\r\n" +
//                                "$('.clsCkbCaBenh').each(function(index, element/*this*/) {\r\n" +
//                    "               if (!element.checked){\r\n" +
//                    "                   element.checked=true;\r\n" +
//                    "                   CheckedArr.push(element.id);\r\n" +
//                    "               }\r\n" +
//                    "           });\r\n" +
//                    "       }\r\n" +
//                    "       else {\r\n" +
//                                "$('.clsCkbCaBenh').each(function(index, element/*this*/) {\r\n" +
//                    "               if (element.checked){\r\n" +
//                    "                   element.checked=false;\r\n" +
//                    "                   for (var i=0; i < CheckedArr.length; i++) {\r\n" +
//                    "                       if(CheckedArr[i] == element.id){\r\n" +
//                    "	                        CheckedArr.splice(i,1);\r\n" +
//                    "	                        break;\r\n" +
//                    "                       }\r\n" +
//                    "                   }\r\n" +
//                    "               }\r\n" +
//                    "           });\r\n" +
//                    "       }\r\n" +
//                    "   }\r\n" +
//                #endregion ckbAllCaBenhPage_onclick
//                #region ckbCaBenh_onclick
//                    "   function ckbCaBenh_onclick(sender){\r\n" +
//                    "       if (sender.checked){\r\n" +
//                    "           CheckedArr.push(sender.id);\r\n" +
//                    "           CheckCheckAllCaBenhPage();\r\n" +
//                    "       }\r\n" +
//                    "       else{\r\n" +
//                "               for (var index=0; index < CheckedArr.length; index ++) {\r\n" +
//                "                   if(CheckedArr[index] == sender.id){\r\n" +
//                "	                    CheckedArr.splice(index,1);\r\n" +
//                "	                    break;\r\n" +
//                "                   }\r\n" +
//                "               }\r\n" +
//                    "           ckbAllPage.checked=false;\r\n" +
//                    "       }\r\n" +
//                    "   }\r\n" +
//                #endregion ckbCaBenh_onclick
//                #region Check CheckAllCaBenhPage
//                    "   function CheckCheckAllCaBenhPage(){\r\n" +
//                    "       checkAll=true;\r\n" +
//                    "       $('.clsCkbCaBenh').each(function(index, element/*this*/) {\r\n" +
//                    "           if (!element.checked){\r\n" +
//                    "               checkAll=false;\r\n" +
//                    "               return;\r\n" +
//                    "           }\r\n" +
//                    "       });\r\n" +
//                    "       ckbAllPage.checked=checkAll;\r\n" +
//                    "   }\r\n" +
//                #endregion Check CheckAllCaBenhPage
//                #region Thêm mới ca bệnh vào lịch hội chẩn
//                    "   function AddCaBenh(){\r\n" +
//                    "       if(CheckedArr.length==0){\r\n" +
//                    "           callGallAlert('" + WebLanguage.GetLanguage(OSiteParam, "Bạn chưa chọn ca bệnh để thêm vào lịch!") + "');\r\n" +
//                    "           return;\r\n" +
//                    "       }\r\n" +
//                    "       AjaxOut = OneTSQ.WebParts.LichHoiChan.ServerSideAddCaBenhs(RenderInfo,lichhoichanid, CheckedArr, '" + WebPartTitle + "', 'Thêm ca bệnh').value;\r\n" +
//                    "       if(AjaxOut.Error){\r\n" +
//                    "           callGallAlert(AjaxOut.InfoMessage);\r\n" +
//                    "           return;\r\n" +
//                    "       }\r\n" +
//                    "       toastr.info(\"" + WebLanguage.GetLanguage(OSiteParam, "Đã thêm!") + "\");\r\n" +
//                    "       divCaBenhBelongLichHoiChanList.innerHTML=AjaxOut.HtmlContent;\r\n" +
//                    "       if(AjaxOut.RetExtraParam1 != '')\r\n" +
//                    "           divDonViBelongLichHoiChanList.innerHTML=AjaxOut.RetExtraParam1;\r\n" +
//                    "       $('#divFormModal').modal('hide');\r\n" +
//                    "       AddHistory(lichhoichanid, '" + WebPartTitle + "', 'Thêm ca bệnh', 'Tác vụ form');\r\n" +
//                    "   }\r\n" +
//                #endregion Thêm mới ca bệnh vào lịch hội chẩn
//                #region Hiển thị phần cập nhật số thứ tự ca bệnh trong lịch hội chẩn
//                    "   function ShowEditSttCaBenh(){\r\n" +
//                    "       $('.CssEditorSttCaBenh').show();\r\n" +
//                    "       $('.CssDisplaySttCaBenh').hide();\r\n" +
//                    "       $('#btnEditSttCaBenhs').hide();\r\n" +
//                    "       $('#btnUpdateSttCaBenhs').show();\r\n" +
//                    "   }\r\n" +
//                #endregion Hiển thị phần cập nhật số thứ tự ca bệnh trong lịch hội chẩn
//                #region Cập nhật số thứ tự ca bệnh trong lịch hội chẩn
//                    "   function UpdateSttCaBenhs(){\r\n" +
//                    "       lichHoiChanCaBenhs = [];\r\n" +
//                    "       $('.clsSttCaBenh').each(function(index, element){\r\n" +
//                    "           var lichHoiChanCaBenh = new Object();\r\n" +
//                    "           lichHoiChanCaBenh.LICHHOICHANID = lichhoichanid;\r\n" +
//                    "           lichHoiChanCaBenh.CABENHID = element.id.split('_')[1];\r\n" +
//                    "           lichHoiChanCaBenh.STT = element.value;\r\n" +
//                    "           lichHoiChanCaBenhs.push(lichHoiChanCaBenh);\r\n" +
//                    "       });\r\n" +
//                    "       AjaxOut = OneTSQ.WebParts.LichHoiChan.ServerSideUpdateSttCaBenh(RenderInfo, lichHoiChanCaBenhs).value;\r\n" +
//                    "       $('#btnEditSttCaBenhs').show();\r\n" +
//                    "       $('#btnUpdateSttCaBenhs').hide();\r\n" +
//                    "       DrawDanhSachCaBenhByLichHoiChan(lichhoichanid);\r\n" +
//                    "       AddHistory(lichhoichanid, '" + WebPartTitle + "', 'Cập nhật số thứ tự ca bệnh', 'Tác vụ form');\r\n" +
//                    "   }\r\n" +
//                #endregion Cập nhật số thứ tự ca bệnh trong lịch hội chẩn
//                #region Xóa ca bệnh khỏi lịch hội chẩn
//                    "   function RemoveCaBenh(cabenhId){\r\n" +
//                    "       if(laplich.lichhoichan.TRANGTHAI!=" + (int)LichHoiChanCls.eTrangThai.Moi + " && laplich.lichhoichan.TRANGTHAI!=" + (int)LichHoiChanCls.eTrangThai.TuChoiDuyet + "){\r\n" +
//                    "           callGallAlert('" + WebLanguage.GetLanguage(OSiteParam, "Chỉ được xóa ca bệnh khi trạng thái lịch là mới hoặc từ chối duyệt.") + "');\r\n" +
//                    "           return;\r\n" +
//                    "       }\r\n" +
//                    "       swal({ \r\n" +
//                    "               title: \"Bạn có chắc chắn xóa không?\", \r\n" +
//                    //"               text: \"" + "Đang thực hiện xóa bệnh án này ra khỏi hệ thống" + "!\", \r\n" +
//                    "               type: \"warning\", \r\n" +
//                    "               showCancelButton: true, \r\n" +
//                    "               confirmButtonColor: \"#DD6B55\", \r\n" +
//                    "               confirmButtonText: \"" + "Xóa" + "\", \r\n" +
//                    "               cancelButtonText: \"" + "Hủy bỏ" + "\", \r\n" +
//                    "               closeOnConfirm: false \r\n" +
//                    "           }, function () { \r\n" +
//                    "               removeCaBenhArray=[cabenhId];\r\n" +
//                    "               AjaxOut = OneTSQ.WebParts.LichHoiChan.ServerSideRemoveCaBenhs(RenderInfo,lichhoichanid, removeCaBenhArray, '" + WebPartTitle + "', 'Xóa ca bệnh').value;\r\n" +
//                    "               if(AjaxOut.Error){\r\n" +
//                    "                   callGallAlert(AjaxOut.InfoMessage);\r\n" +
//                    "                   return;\r\n" +
//                    "               }\r\n" +
//                    "               swal.close();\r\n" +
//                    "               toastr.info(\"" + WebLanguage.GetLanguage(OSiteParam, "Đã xóa!") + "\");\r\n" +
//                    "               divCaBenhBelongLichHoiChanList.innerHTML=AjaxOut.HtmlContent;\r\n" +
//                    "               if(AjaxOut.RetExtraParam1 != '')\r\n" +
//                    "                   divDonViBelongLichHoiChanList.innerHTML=AjaxOut.RetExtraParam1;\r\n" +
//                    "               $('#divFormModal').modal('hide');\r\n" +
//                    "               AddHistory(lichhoichanid, '" + WebPartTitle + "', 'Xóa ca bệnh', 'Tác vụ form');\r\n" +
//                    "           }); \r\n" +
//                    "   }\r\n" +
//                #endregion Xóa ca bệnh khỏi lịch hội chẩn

//                #region Chuyển duyệt lịch hội chẩn
//                    "   function ChuyenDuyet(){\r\n" +
//                    "       swal({ \r\n" +
//                    "               title: \"Bạn có chắc chắn chuyển duyệt lịch hội chẩn này?\", \r\n" +
//                    //"               text: \"" + "Đang thực hiện xóa bệnh án này ra khỏi hệ thống" + "!\", \r\n" +
//                    "               type: \"warning\", \r\n" +
//                    "               showCancelButton: true, \r\n" +
//                    "               confirmButtonColor: \"#DD6B55\", \r\n" +
//                    "               confirmButtonText: \"" + "Thực hiện" + "\", \r\n" +
//                    "               cancelButtonText: \"" + "Hủy bỏ" + "\", \r\n" +
//                    "               closeOnConfirm: false \r\n" +
//                    "           }, function () { \r\n" +
//                    "               RenderInfo=CreateRenderInfo();\r\n" +
//                    "               if($('#btnLuu').is(':hidden') == false)\r\n" +
//                    "                   OneTSQ.WebParts.LichHoiChan.ServerSideSaveLichHoiChan(RenderInfo,lichhoichanid,cboNguoiLapLich.value,txtThoiGianLapLich.value,cboNguoiDuyet.value,txtThoiGianDuyet.value,txtDiaDiem.value,cboThuKy.value,cboChuTri.value,dtBatDau.value,dtKetThuc.value,txtGhiChu.value);\r\n" +
//                    "               AjaxOut = OneTSQ.WebParts.LichHoiChan.UpdateTrangThaiLichHoiChan(RenderInfo, lichhoichanid, " + (int)LichHoiChanCls.eTrangThai.ChoDuyet + ", '" + WebPartTitle + "', 'Chuyển duyệt').value;\r\n" +
//                    "               if(AjaxOut.Error)\r\n" +
//                    "               {\r\n" +
//                    "                   callGallAlert(AjaxOut.InfoMessage);\r\n" +
//                    "                   return;\r\n" +
//                    "               }\r\n" +
//                    "               else \r\n" +
//                    "               {\r\n" +
//                    "                   swal.close();\r\n" +
//                    "                   toastr.info('" + WebLanguage.GetLanguage(OSiteParam, "Đã chuyển duyệt!") + "');\r\n" +
//                    "                   OnLoadForm();\r\n" +
//                    "                   AddHistory(lichhoichanid, '" + WebPartTitle + "', 'Chuyển duyệt', 'Tác vụ form');\r\n" +
//                    "               }\r\n" +
//                    "       }); \r\n" +
//                    "   }\r\n" +
//                #endregion Chuyển duyệt lịch hội chẩn
//                #region Thu hồi chuyển duyệt lịch hội chẩn
//                    "   function ThuHoiChuyenDuyet(){\r\n" +
//                    "       swal({ \r\n" +
//                    "               title: \"Bạn có chắc chắn thu hồi chuyển duyệt lịch hội chẩn này?\", \r\n" +
//                    //"               text: \"" + "Đang thực hiện xóa bệnh án này ra khỏi hệ thống" + "!\", \r\n" +
//                    "               type: \"warning\", \r\n" +
//                    "               showCancelButton: true, \r\n" +
//                    "               confirmButtonColor: \"#DD6B55\", \r\n" +
//                    "               confirmButtonText: \"" + "Thực hiện" + "\", \r\n" +
//                    "               cancelButtonText: \"" + "Hủy bỏ" + "\", \r\n" +
//                    "               closeOnConfirm: false \r\n" +
//                    "           }, function () { \r\n" +
//                    "               RenderInfo=CreateRenderInfo();\r\n" +
//                    "               AjaxOut = OneTSQ.WebParts.LichHoiChan.UpdateTrangThaiLichHoiChan(RenderInfo, lichhoichanid, " + (int)LichHoiChanCls.eTrangThai.Moi + ", '" + WebPartTitle + "', 'Thu hồi chuyển duyệt').value;\r\n" +
//                    "               if(AjaxOut.Error)\r\n" +
//                    "               {\r\n" +
//                    "                   callGallAlert(AjaxOut.InfoMessage);\r\n" +
//                    "                   return;\r\n" +
//                    "               }\r\n" +
//                    "               else \r\n" +
//                    "               {\r\n" +
//                    "                   swal.close();\r\n" +
//                    "                   toastr.info('" + WebLanguage.GetLanguage(OSiteParam, "Đã Thu hồi chuyển duyệt!") + "');\r\n" +
//                    "                   OnLoadForm();\r\n" +
//                    "                   AddHistory(lichhoichanid, '" + WebPartTitle + "', 'Thu hồi chuyển duyệt', 'Tác vụ form');\r\n" +
//                    "               }\r\n" +
//                    "       }); \r\n" +
//                    "   }\r\n" +
//                #endregion Thu hồi chuyển duyệt lịch hội chẩn
//                #region Duyệt lịch hội chẩn
//                    "   function Duyet(){\r\n" +
//                    "       swal({ \r\n" +
//                    "               title: \"Bạn có chắc chắn duyệt lịch hội chẩn này?\", \r\n" +
//                    //"               text: \"" + "Đang thực hiện xóa bệnh án này ra khỏi hệ thống" + "!\", \r\n" +
//                    "               type: \"warning\", \r\n" +
//                    "               showCancelButton: true, \r\n" +
//                    "               confirmButtonColor: \"#DD6B55\", \r\n" +
//                    "               confirmButtonText: \"" + "Thực hiện" + "\", \r\n" +
//                    "               cancelButtonText: \"" + "Hủy bỏ" + "\", \r\n" +
//                    "               closeOnConfirm: false \r\n" +
//                    "           }, function () { \r\n" +
//                    "               RenderInfo=CreateRenderInfo();\r\n" +
//                    "               AjaxOut = OneTSQ.WebParts.LichHoiChan.UpdateTrangThaiLichHoiChan(RenderInfo, lichhoichanid, " + (int)LichHoiChanCls.eTrangThai.DaDuyet + ", '" + WebPartTitle + "', 'Duyệt').value;\r\n" +
//                    "               if(AjaxOut.Error)\r\n" +
//                    "               {\r\n" +
//                    "                   callGallAlert(AjaxOut.InfoMessage);\r\n" +
//                    "                   return;\r\n" +
//                    "               }\r\n" +
//                    "               else \r\n" +
//                    "               {\r\n" +
//                    "                   swal.close();\r\n" +
//                    "                   toastr.info('" + WebLanguage.GetLanguage(OSiteParam, "Đã duyệt!") + "');\r\n" +
//                    "                   OnLoadForm();\r\n" +
//                    "                   AddHistory(lichhoichanid, '" + WebPartTitle + "', 'Duyệt', 'Tác vụ form');\r\n" +
//                    "               }\r\n" +
//                    "       }); \r\n" +
//                    "   }\r\n" +
//                #endregion Duyệt lịch hội chẩn
//                #region Thu hồi duyệt lịch hội chẩn
//                    "   function ThuHoiDuyet(){\r\n" +
//                    "       swal({ \r\n" +
//                    "               title: \"Bạn có chắc chắn thu hồi chuyển duyệt lịch hội chẩn này?\", \r\n" +
//                    //"               text: \"" + "Đang thực hiện xóa bệnh án này ra khỏi hệ thống" + "!\", \r\n" +
//                    "               type: \"warning\", \r\n" +
//                    "               showCancelButton: true, \r\n" +
//                    "               confirmButtonColor: \"#DD6B55\", \r\n" +
//                    "               confirmButtonText: \"" + "Thực hiện" + "\", \r\n" +
//                    "               cancelButtonText: \"" + "Hủy bỏ" + "\", \r\n" +
//                    "               closeOnConfirm: false \r\n" +
//                    "           }, function () { \r\n" +
//                    "               RenderInfo=CreateRenderInfo();\r\n" +
//                    "               AjaxOut = OneTSQ.WebParts.LichHoiChan.UpdateTrangThaiLichHoiChan(RenderInfo, lichhoichanid, " + (int)LichHoiChanCls.eTrangThai.ChoDuyet + ", '" + WebPartTitle + "', 'Thu hồi duyệt').value;\r\n" +
//                    "               if(AjaxOut.Error)\r\n" +
//                    "               {\r\n" +
//                    "                   callGallAlert(AjaxOut.InfoMessage);\r\n" +
//                    "                   return;\r\n" +
//                    "               }\r\n" +
//                    "               else \r\n" +
//                    "               {\r\n" +
//                    "                   swal.close();\r\n" +
//                    "                   toastr.info('" + WebLanguage.GetLanguage(OSiteParam, "Đã Thu hồi duyệt!") + "');\r\n" +
//                    "                   OnLoadForm();\r\n" +
//                    "                   AddHistory(lichhoichanid, '" + WebPartTitle + "', 'Thu hồi duyệt', 'Tác vụ form');\r\n" +
//                    "               }\r\n" +
//                    "       }); \r\n" +
//                    "   }\r\n" +
//                #endregion Thu hồi duyệt lịch hội chẩn
//                #region Từ chối duyệt lịch hội chẩn
//                    "   function TuChoiDuyet(){\r\n" +
//                    "       swal({ \r\n" +
//                    "               title: \"Bạn có chắc chắn Từ chối duyệt lịch hội chẩn này?\", \r\n" +
//                    //"               text: \"" + "Đang thực hiện xóa bệnh án này ra khỏi hệ thống" + "!\", \r\n" +
//                    "               type: \"warning\", \r\n" +
//                    "               showCancelButton: true, \r\n" +
//                    "               confirmButtonColor: \"#DD6B55\", \r\n" +
//                    "               confirmButtonText: \"" + "Thực hiện" + "\", \r\n" +
//                    "               cancelButtonText: \"" + "Hủy bỏ" + "\", \r\n" +
//                    "               closeOnConfirm: false \r\n" +
//                    "           }, function () { \r\n" +
//                    "               RenderInfo=CreateRenderInfo();\r\n" +
//                    "               AjaxOut = OneTSQ.WebParts.LichHoiChan.UpdateTrangThaiLichHoiChan(RenderInfo, lichhoichanid, " + (int)LichHoiChanCls.eTrangThai.TuChoiDuyet + ", '" + WebPartTitle + "', 'Từ chối duyệt').value;\r\n" +
//                    "               if(AjaxOut.Error)\r\n" +
//                    "               {\r\n" +
//                    "                   callGallAlert(AjaxOut.InfoMessage);\r\n" +
//                    "                   return;\r\n" +
//                    "               }\r\n" +
//                    "               else \r\n" +
//                    "               {\r\n" +
//                    "                   swal.close();\r\n" +
//                    "                   toastr.info('" + WebLanguage.GetLanguage(OSiteParam, "Đã Từ chối duyệt!") + "');\r\n" +
//                    "                   OnLoadForm();\r\n" +
//                    "                   AddHistory(lichhoichanid, '" + WebPartTitle + "', 'Từ chối duyệt', 'Tác vụ form');\r\n" +
//                    "               }\r\n" +
//                    "       }); \r\n" +
//                    "   }\r\n" +
//                #endregion Từ chối duyệt lịch hội chẩn
//                #region Thu hồi từ chối duyệt lịch hội chẩn
//                    "   function ThuHoiTuChoiDuyet(){\r\n" +
//                    "       swal({ \r\n" +
//                    "               title: \"Bạn có chắc chắn thu hồi từ chối duyệt lịch hội chẩn này?\", \r\n" +
//                    //"               text: \"" + "Đang thực hiện xóa bệnh án này ra khỏi hệ thống" + "!\", \r\n" +
//                    "               type: \"warning\", \r\n" +
//                    "               showCancelButton: true, \r\n" +
//                    "               confirmButtonColor: \"#DD6B55\", \r\n" +
//                    "               confirmButtonText: \"" + "Thực hiện" + "\", \r\n" +
//                    "               cancelButtonText: \"" + "Hủy bỏ" + "\", \r\n" +
//                    "               closeOnConfirm: false \r\n" +
//                    "           }, function () { \r\n" +
//                    "               RenderInfo=CreateRenderInfo();\r\n" +
//                    "               AjaxOut = OneTSQ.WebParts.LichHoiChan.UpdateTrangThaiLichHoiChan(RenderInfo, lichhoichanid, " + (int)LichHoiChanCls.eTrangThai.ChoDuyet + ", '" + WebPartTitle + "', 'Thu hồi từ chối duyệt').value;\r\n" +
//                    "               if(AjaxOut.Error)\r\n" +
//                    "               {\r\n" +
//                    "                   callGallAlert(AjaxOut.InfoMessage);\r\n" +
//                    "                   return;\r\n" +
//                    "               }\r\n" +
//                    "               else \r\n" +
//                    "               {\r\n" +
//                    "                   swal.close();\r\n" +
//                    "                   toastr.info('" + WebLanguage.GetLanguage(OSiteParam, "Đã thu hồi từ chối duyệt!") + "');\r\n" +
//                    "                   OnLoadForm();\r\n" +
//                    "                   AddHistory(lichhoichanid, '" + WebPartTitle + "', 'Thu hồi từ chối duyệt', 'Tác vụ form');\r\n" +
//                    "               }\r\n" +
//                    "       }); \r\n" +
//                    "   }\r\n" +
//                #endregion Thu hồi từ chối duyệt lịch hội chẩn
//                #region Hoàn tất lịch hội chẩn
//                    "   function HoanTat(){\r\n" +
//                    "       swal({ \r\n" +
//                    "               title: \"Bạn có chắc chắn hoàn tất lịch hội chẩn này?\", \r\n" +
//                    //"               text: \"" + "Đang thực hiện xóa bệnh án này ra khỏi hệ thống" + "!\", \r\n" +
//                    "               type: \"warning\", \r\n" +
//                    "               showCancelButton: true, \r\n" +
//                    "               confirmButtonColor: \"#DD6B55\", \r\n" +
//                    "               confirmButtonText: \"" + "Thực hiện" + "\", \r\n" +
//                    "               cancelButtonText: \"" + "Hủy bỏ" + "\", \r\n" +
//                    "               closeOnConfirm: false \r\n" +
//                    "           }, function () { \r\n" +
//                    "               RenderInfo=CreateRenderInfo();\r\n" +
//                    "               AjaxOut = OneTSQ.WebParts.LichHoiChan.UpdateTrangThaiLichHoiChan(RenderInfo, lichhoichanid, " + (int)LichHoiChanCls.eTrangThai.HoanTat + ", '" + WebPartTitle + "', 'Hoàn tất').value;\r\n" +
//                    "               if(AjaxOut.Error)\r\n" +
//                    "               {\r\n" +
//                    "                   callGallAlert(AjaxOut.InfoMessage);\r\n" +
//                    "                   return;\r\n" +
//                    "               }\r\n" +
//                    "               else \r\n" +
//                    "               {\r\n" +
//                    "                   swal.close();\r\n" +
//                    "                   toastr.info('" + WebLanguage.GetLanguage(OSiteParam, "Đã hoàn tất!") + "');\r\n" +
//                    "                   OnLoadForm();\r\n" +
//                    "                   AddHistory(lichhoichanid, '" + WebPartTitle + "', 'Hoàn tất', 'Tác vụ form');\r\n" +
//                    "               }\r\n" +
//                    "       }); \r\n" +
//                    "   }\r\n" +
//                #endregion Hoàn tất lịch hội chẩn
//                #region Hủy lịch hội chẩn
//                    "   function Huy(){\r\n" +
//                    "       swal({ \r\n" +
//                    "               title: \"Bạn có chắc chắn hủy lịch hội chẩn này?\", \r\n" +
//                    //"               text: \"" + "Đang thực hiện xóa bệnh án này ra khỏi hệ thống" + "!\", \r\n" +
//                    "               type: \"warning\", \r\n" +
//                    "               showCancelButton: true, \r\n" +
//                    "               confirmButtonColor: \"#DD6B55\", \r\n" +
//                    "               confirmButtonText: \"" + "Thực hiện" + "\", \r\n" +
//                    "               cancelButtonText: \"" + "Hủy bỏ" + "\", \r\n" +
//                    "               closeOnConfirm: false \r\n" +
//                    "           }, function () { \r\n" +
//                    "               RenderInfo=CreateRenderInfo();\r\n" +
//                    "               AjaxOut = OneTSQ.WebParts.LichHoiChan.UpdateTrangThaiLichHoiChan(RenderInfo, lichhoichanid, " + (int)LichHoiChanCls.eTrangThai.Huy + ", '" + WebPartTitle + "', 'Hủy').value;\r\n" +
//                    "               if(AjaxOut.Error)\r\n" +
//                    "               {\r\n" +
//                    "                   callGallAlert(AjaxOut.InfoMessage);\r\n" +
//                    "                   return;\r\n" +
//                    "               }\r\n" +
//                    "               else \r\n" +
//                    "               {\r\n" +
//                    "                   swal.close();\r\n" +
//                    "                   toastr.info('" + WebLanguage.GetLanguage(OSiteParam, "Đã hủy!") + "');\r\n" +
//                    "                   OnLoadForm();\r\n" +
//                    "                   AddHistory(lichhoichanid, '" + WebPartTitle + "', 'Hủy', 'Tác vụ form');\r\n" +
//                    "               }\r\n" +
//                    "       }); \r\n" +
//                    "   }\r\n" +
//                #endregion Hủy lịch hội chẩn
//                #region Mở form ca bệnh hội chẩn
//                    "   function OpenCaBenh(){\r\n" +
//                    "               RenderInfo=CreateRenderInfo();\r\n" +
//                    "               AjaxOut = OneTSQ.WebParts.LichHoiChan.GetCaBenhUrl(RenderInfo, lichhoichanid).value;\r\n" +
//                    "               if(AjaxOut.Error)\r\n" +
//                    "               {\r\n" +
//                    "                   callGallAlert(AjaxOut.InfoMessage);\r\n" +
//                    "                   return;\r\n" +
//                    "               }\r\n" +
//                    "               else \r\n" +
//                    "               {\r\n" +
//                    "                   window.open(AjaxOut.RetUrl,'_self');\r\n" +
//                    "               }\r\n" +
//                    "   }\r\n" +
//                #endregion Mở form ca bệnh hội chẩn
//                    "   function changeTrangThai(trangthai){\r\n" +
//                    "       if(trangthai ==" + (int)LichHoiChanCls.eTrangThai.HoanTat + " ){\r\n" +
//                    "               $(\".laplich-control\").prop(\"disabled\",true);\r\n" +
//                    "               $(\".laplich-a\").css({\"pointer-events\": \"none\", \"cursor\": \"default\"});\r\n" +
//                    "          $(\"#txtThoiGianLapLich\").prop(\"required\", true );\r\n" +
//                    "          $(\"#cboNguoiLapLich\").prop(\"required\", true );\r\n" +
//                    "          $(\"#cbbThoiGian\").prop(\"disabled\",true);\r\n" +
//                    "          $(\"#dtBatDau\").prop(\"disabled\",true);\r\n" +
//                    "          $(\"#dtKetThuc\").prop(\"disabled\",true);\r\n" +
//                    "       }\r\n" +
//                    "       else if(trangthai ==" + (int)LichHoiChanCls.eTrangThai.ChoDuyet + " ){\r\n" +
//                    "          $(\".laplich-a\").css({\"pointer-events\": \"none\", \"cursor\": \"default\"});\r\n" +
//                    "          $(\"#txtThoiGianLapLich\").prop(\"disabled\", true );\r\n" +
//                    "          $(\"#cboNguoiLapLich\").prop(\"disabled\", true );\r\n" +
//                    "          $(\"#cbbThoiGian\").prop(\"disabled\",true);\r\n" +
//                    "          $(\"#dtBatDau\").prop(\"disabled\",true);\r\n" +
//                    "          $(\"#dtKetThuc\").prop(\"disabled\",true);\r\n" +
//                    "          $(\"#txtTimKiem\").prop(\"disabled\",true);\r\n" +
//                    "          $(\"#cboKhoaDieuTri\").prop(\"disabled\",true);\r\n" +
//                    "          $(\"#cboDonViHanhChinh\").prop(\"disabled\",true);\r\n" +
//                    "          $(\"#cboChanDoanRaVien\").prop(\"disabled\",true);\r\n" +
//                    "          $(\"#btnSubmit\").prop(\"disabled\",true);\r\n" +
//                    "       }\r\n" +
//                    "       else if(trangthai ==" + (int)LichHoiChanCls.eTrangThai.DaDuyet + " ){\r\n" +
//                    "          $(\".laplich-a\").css({\"pointer-events\": \"none\", \"cursor\": \"default\"});\r\n" +
//                    "          $(\"#txtThoiGianLapLich\").prop(\"disabled\", true );\r\n" +
//                    "          $(\"#cboNguoiLapLich\").prop(\"disabled\", true );\r\n" +
//                    "          $(\"#cbbThoiGian\").prop(\"disabled\",true);\r\n" +
//                    "          $(\"#cboNguoiDuyet\").prop(\"disabled\", true );\r\n" +
//                    "          $(\"#txtThoiGianDuyet\").prop(\"disabled\",true);\r\n" +
//                    "          $(\"#dtBatDau\").prop(\"disabled\",true);\r\n" +
//                    "          $(\"#dtKetThuc\").prop(\"disabled\",true);\r\n" +
//                    "          $(\"#txtTimKiem\").prop(\"disabled\",true);\r\n" +
//                    "          $(\"#cboKhoaDieuTri\").prop(\"disabled\",true);\r\n" +
//                    "          $(\"#cboDonViHanhChinh\").prop(\"disabled\",true);\r\n" +
//                    "          $(\"#cboChanDoanRaVien\").prop(\"disabled\",true);\r\n" +
//                    "          $(\"#btnSubmit\").prop(\"disabled\",true);\r\n" +
//                    "       }\r\n" +
//                    "       else{\r\n" +
//                    "               $(\".laplich-control\").prop(\"disabled\",false);\r\n" +
//                    "               if(lichhoichanid)\r\n" +
//                    "               $(\".laplich-a\").css({\"pointer-events\": \"auto\", \"cursor\": \"pointer\"});\r\n" +

//                    "       }\r\n" +
//                    "   }\r\n" +
//                #region loadLichHoiChan
//                    "   function loadLichHoiChan(){\r\n" +
//                    "     AjaxOut = OneTSQ.WebParts.LichHoiChan.ServerSideGetLichHoiChanById(RenderInfo,lichhoichanid).value;\r\n" +
//                    "     if(AjaxOut.Error){\r\n" +
//                    "        callGallAlert(AjaxOut.InfoMessage);\r\n" +
//                    "        return;\r\n" +
//                    "     }\r\n" +
//                    "     laplich=AjaxOut.RetObject;\r\n" +
//                    "     txtThoiGianLapLich.value=laplich.ThoiGianTao;\r\n" +
//                    "     cboNguoiLapLich.innerHTML=laplich.optionNguoiTao_ID;\r\n" +
//                    "     txtThoiGianDuyet.value=laplich.ThoiGianDuyet;\r\n" +
//                    "     cboNguoiDuyet.innerHTML=laplich.optionNguoiDuyet_ID;\r\n" +
//                    "     cboThuKy.innerHTML=laplich.optionThuKy_ID;\r\n" +
//                    "     cboChuTri.innerHTML=laplich.optionChuTri_ID;\r\n" +
//                    "     cboChuyenKhoa.innerHTML=laplich.optionChuyenKhoaMa;\r\n" +
//                    "     dtBatDau.value=laplich.BatDau;\r\n" +
//                    "     dtKetThuc.value=laplich.KetThuc;\r\n" +
//                    "     txtDiaDiem.value=laplich.DiaDiem;\r\n" +
//                    "     txtGhiChu.value=laplich.GhiChu;\r\n" +
//                    "     changeTrangThai(laplich.lichhoichan.TRANGTHAI);\r\n" +
//                    "   }\r\n" +
//                #endregion loadLichHoiChan
//                    "   function OnWebPartLoaded(trangthai){\r\n" +
//                    //"    fnCheckShowBtnByPhanQuyen();\r\n" +
//                    //"    if(laplich)\r\n" +
//                    //"       if(laplich.lichhoichan.TRANGTHAI!=" + (int)LichHoiChanCls.eTrangThai.Moi + ")\r\n" +
//                    //"               DisableSave();\r\n" +
//                    //"       else\r\n" +
//                    //"       $('#btnLuu').prop(\"disabled\", false );\r\n" +
//                    "   }\r\n" +
//                    "   function OnWebPartLoad()\r\n" +
//                    "   {\r\n" +
//                    "       return lichhoichanid;\r\n" +
//                    "   }\r\n" +
//                #region Show trạng thái lịch hội chẩn
//                    "function ShowTrangThai(){\r\n" +
//                    "     RenderInfo=CreateRenderInfo();\r\n" +
//                    "     $('#aTrangThai').html(OneTSQ.WebParts.LichHoiChan.ShowTrangThai(RenderInfo, lichhoichanid).value);\r\n" +
//                    "}\r\n" +
//                #endregion Show trạng thái lịch hội chẩn
//                #region OnLoadForm()
//                    "   function OnLoadForm(){\r\n" +
//                    "     if(lichhoichanid){\r\n" +
//                    "       $(\"#divChuyenGiaListBlock\").css({\"display\": \"block\"});\r\n" +
//                    "       $(\"#divCaBenhListBlock\").css({\"display\": \"block\"});\r\n" +
//                    "       loadLichHoiChan();\r\n" +
//                    "       DrawDanhSachDonViByLichHoiChan(lichhoichanid);\r\n" +
//                    "       DrawDanhSachChuyenGiaByLichHoiChan(lichhoichanid);\r\n" +
//                    "       DrawDanhSachCaBenhByLichHoiChan(lichhoichanid);\r\n" +
//                    "       ShowTrangThai();\r\n" +
//                    "     }\r\n" +
//                    "     onDisplayButtonWF();\r\n" +
//                    "   }\r\n" +
//                #endregion OnLoadForm()
//                #region onDisplayButtonWF
//                    "   function onDisplayButtonWF(){\r\n" +
//                    "    if(laplich){\r\n" +
//                    "       if(laplich.lichhoichan.TRANGTHAI==" + (int)LichHoiChanCls.eTrangThai.Moi + "){\r\n" +
//                    "         if(isSystemAdmin || themPermission)$(\"#btnClear\").css({\"display\": \"block\"});\r\n" +
//                    "         if(isSystemAdmin || chuyenDuyetPermission)$(\"#btnChuyenDuyet\").css({\"display\": \"block\"});\r\n" +
//                    "         $(\"#btnDuyet\").css({\"display\": \"none\"});\r\n" +
//                    "         $(\"#btnTuChoiDuyet\").css({\"display\": \"none\"});\r\n" +
//                    "         $(\"#btnThuHoiChuyenDuyet\").css({\"display\": \"none\"});\r\n" +
//                    "         $(\"#btnThuHoiDuyet\").css({\"display\": \"none\"});\r\n" +
//                    "         $(\"#btnThuHoiTuChoiDuyet\").css({\"display\": \"none\"});\r\n" +
//                    "         if(isSystemAdmin || suaPermission)$(\"#btnLuu\").css({\"display\": \"block\"});\r\n" +
//                    "         if(isSystemAdmin || xoaPermission)$(\"#btnXoa\").css({\"display\": \"block\"});\r\n" +
//                    "         $(\"#btnHoanTat\").css({\"display\": \"none\"});\r\n" +
//                    "         $(\"#btnHuy\").css({\"display\": \"none\"});\r\n" +
//                    "         $(\"#btnHoiChan\").css({\"display\": \"none\"});\r\n" +
//                    "         if(isSystemAdmin || suaPermission)$(\".clsUpdateChuyenGiaList\").css({\"display\": \"block\"});\r\n" +
//                    "         if(isSystemAdmin || suaPermission)$(\".clsUpdateCaBenhList\").css({\"display\": \"block\"});\r\n" +
//                    "       }\r\n" +
//                    "       else if(laplich.lichhoichan.TRANGTHAI==" + (int)LichHoiChanCls.eTrangThai.ChoDuyet + "){\r\n" +
//                    "         if(isSystemAdmin || themPermission)$(\"#btnClear\").css({\"display\": \"block\"});\r\n" +
//                    "         $(\"#btnChuyenDuyet\").css({\"display\": \"none\"});\r\n" +
//                    "         if(isSystemAdmin || isPheDuyet)$(\"#btnDuyet\").css({\"display\": \"block\"});\r\n" +
//                    "         if(isSystemAdmin || isPheDuyet)$(\"#btnTuChoiDuyet\").css({\"display\": \"block\"});\r\n" +
//                    "         if(isSystemAdmin || chuyenDuyetPermission)$(\"#btnThuHoiChuyenDuyet\").css({\"display\": \"block\"});\r\n" +
//                    "         $(\"#btnThuHoiDuyet\").css({\"display\": \"none\"});\r\n" +
//                    "         $(\"#btnThuHoiTuChoiDuyet\").css({\"display\": \"none\"});\r\n" +
//                    "         $(\"#btnLuu\").css({\"display\": \"none\"});\r\n" +
//                    "         $(\"#btnXoa\").css({\"display\": \"none\"});\r\n" +
//                    "         $(\"#btnHoanTat\").css({\"display\": \"none\"});\r\n" +
//                    "         $(\"#btnHuy\").css({\"display\": \"none\"});\r\n" +
//                    "         $(\"#btnHoiChan\").css({\"display\": \"none\"});\r\n" +
//                    "         $(\".clsUpdateChuyenGiaList\").css({\"display\": \"none\"});\r\n" +
//                    "         $(\".clsUpdateCaBenhList\").css({\"display\": \"none\"});\r\n" +
//                    "       }\r\n" +
//                    "       else if(laplich.lichhoichan.TRANGTHAI==" + (int)LichHoiChanCls.eTrangThai.DaDuyet + "){\r\n" +
//                    "         if(isSystemAdmin || themPermission)$(\"#btnClear\").css({\"display\": \"block\"});\r\n" +
//                    "         $(\"#btnChuyenDuyet\").css({\"display\": \"none\"});\r\n" +
//                    "         $(\"#btnDuyet\").css({\"display\": \"none\"});\r\n" +
//                    "         $(\"#btnTuChoiDuyet\").css({\"display\": \"none\"});\r\n" +
//                    "         $(\"#btnThuHoiChuyenDuyet\").css({\"display\": \"none\"});\r\n" +
//                    "         if(isSystemAdmin || isPheDuyet)$(\"#btnThuHoiDuyet\").css({\"display\": \"block\"});\r\n" +
//                    "         $(\"#btnThuHoiTuChoiDuyet\").css({\"display\": \"none\"});\r\n" +
//                    "         $(\"#btnLuu\").css({\"display\": \"none\"});\r\n" +
//                    "         $(\"#btnXoa\").css({\"display\": \"none\"});\r\n" +
//                    "         if(isSystemAdmin || isChuTri || isThuKy)$(\"#btnHoanTat\").css({\"display\": \"block\"});\r\n" +
//                    "         if(isSystemAdmin || huyPermission)$(\"#btnHuy\").css({\"display\": \"block\"});\r\n" +
//                    "         $(\"#btnHoiChan\").css({\"display\": \"block\"});\r\n" +
//                    "         $(\".clsUpdateChuyenGiaList\").css({\"display\": \"none\"});\r\n" +
//                    "         $(\".clsUpdateCaBenhList\").css({\"display\": \"none\"});\r\n" +
//                    "       }\r\n" +
//                    "       else if(laplich.lichhoichan.TRANGTHAI==" + (int)LichHoiChanCls.eTrangThai.TuChoiDuyet + "){\r\n" +
//                    "         if(isSystemAdmin || themPermission)$(\"#btnClear\").css({\"display\": \"block\"});\r\n" +
//                    "         if(isSystemAdmin || chuyenDuyetPermission)$(\"#btnChuyenDuyet\").css({\"display\": \"block\"});\r\n" +
//                    "         $(\"#btnDuyet\").css({\"display\": \"none\"});\r\n" +
//                    "         $(\"#btnTuChoiDuyet\").css({\"display\": \"none\"});\r\n" +
//                    "         $(\"#btnThuHoiChuyenDuyet\").css({\"display\": \"none\"});\r\n" +
//                    "         $(\"#btnThuHoiDuyet\").css({\"display\": \"none\"});\r\n" +
//                    "         if(isSystemAdmin || isPheDuyet)$(\"#btnThuHoiTuChoiDuyet\").css({\"display\": \"block\"});\r\n" +
//                    "         if(isSystemAdmin || suaPermission)$(\"#btnLuu\").css({\"display\": \"block\"});\r\n" +
//                    "         if(isSystemAdmin || xoaPermission)$(\"#btnXoa\").css({\"display\": \"block\"});\r\n" +
//                    "         $(\"#btnHoanTat\").css({\"display\": \"none\"});\r\n" +
//                    "         $(\"#btnHuy\").css({\"display\": \"none\"});\r\n" +
//                    "         $(\"#btnHoiChan\").css({\"display\": \"none\"});\r\n" +
//                    "         if(isSystemAdmin || suaPermission)$(\".clsUpdateChuyenGiaList\").css({\"display\": \"block\"});\r\n" +
//                    "         if(isSystemAdmin || suaPermission)$(\".clsUpdateCaBenhList\").css({\"display\": \"block\"});\r\n" +
//                    "       }\r\n" +
//                    "       else if(laplich.lichhoichan.TRANGTHAI==" + (int)LichHoiChanCls.eTrangThai.HoanTat + "){\r\n" +
//                    "         if(isSystemAdmin || themPermission)$(\"#btnClear\").css({\"display\": \"block\"});\r\n" +
//                    "         $(\"#btnChuyenDuyet\").css({\"display\": \"none\"});\r\n" +
//                    "         $(\"#btnDuyet\").css({\"display\": \"none\"});\r\n" +
//                    "         $(\"#btnTuChoiDuyet\").css({\"display\": \"none\"});\r\n" +
//                    "         $(\"#btnThuHoiChuyenDuyet\").css({\"display\": \"none\"});\r\n" +
//                    "         $(\"#btnThuHoiDuyet\").css({\"display\": \"none\"});\r\n" +
//                    "         $(\"#btnThuHoiTuChoiDuyet\").css({\"display\": \"none\"});\r\n" +
//                    "         $(\"#btnLuu\").css({\"display\": \"none\"});\r\n" +
//                    "         $(\"#btnXoa\").css({\"display\": \"none\"});\r\n" +
//                    "         $(\"#btnHoanTat\").css({\"display\": \"none\"});\r\n" +
//                    "         $(\"#btnHuy\").css({\"display\": \"none\"});\r\n" +
//                    "         $(\"#btnHoiChan\").css({\"display\": \"block\"});\r\n" +
//                    "         $(\".clsUpdateChuyenGiaList\").css({\"display\": \"none\"});\r\n" +
//                    "         $(\".clsUpdateCaBenhList\").css({\"display\": \"none\"});\r\n" +
//                    "       }\r\n" +
//                    "       else if(laplich.lichhoichan.TRANGTHAI==" + (int)LichHoiChanCls.eTrangThai.Huy + "){\r\n" +
//                    "         if(isSystemAdmin || themPermission)$(\"#btnClear\").css({\"display\": \"block\"});\r\n" +
//                    "         $(\"#btnChuyenDuyet\").css({\"display\": \"none\"});\r\n" +
//                    "         $(\"#btnDuyet\").css({\"display\": \"none\"});\r\n" +
//                    "         $(\"#btnTuChoiDuyet\").css({\"display\": \"none\"});\r\n" +
//                    "         $(\"#btnThuHoiChuyenDuyet\").css({\"display\": \"none\"});\r\n" +
//                    "         $(\"#btnThuHoiDuyet\").css({\"display\": \"none\"});\r\n" +
//                    "         $(\"#btnThuHoiTuChoiDuyet\").css({\"display\": \"none\"});\r\n" +
//                    "         $(\"#btnLuu\").css({\"display\": \"none\"});\r\n" +
//                    "         $(\"#btnXoa\").css({\"display\": \"none\"});\r\n" +
//                    "         $(\"#btnHoanTat\").css({\"display\": \"none\"});\r\n" +
//                    "         $(\"#btnHuy\").css({\"display\": \"none\"});\r\n" +
//                    "         $(\"#btnHoiChan\").css({\"display\": \"none\"});\r\n" +
//                    "         $(\".clsUpdateChuyenGiaList\").css({\"display\": \"none\"});\r\n" +
//                    "         $(\".clsUpdateCaBenhList\").css({\"display\": \"none\"});\r\n" +
//                    "       }\r\n" +
//                    "    }\r\n" +
//                    "    else{\r\n" +
//                    "         if(isSystemAdmin || themPermission)$(\"#btnClear\").css({\"display\": \"block\"});\r\n" +
//                    "         $(\"#btnChuyenDuyet\").css({\"display\": \"none\"});\r\n" +
//                    "         $(\"#btnDuyet\").css({\"display\": \"none\"});\r\n" +
//                    "         $(\"#btnTuChoiDuyet\").css({\"display\": \"none\"});\r\n" +
//                    "         $(\"#btnThuHoiChuyenDuyet\").css({\"display\": \"none\"});\r\n" +
//                    "         $(\"#btnThuHoiDuyet\").css({\"display\": \"none\"});\r\n" +
//                    "         $(\"#btnThuHoiTuChoiDuyet\").css({\"display\": \"none\"});\r\n" +
//                    "         if(isSystemAdmin || themPermission)$(\"#btnLuu\").css({\"display\": \"block\"});\r\n" +
//                    "         $(\"#btnXoa\").css({\"display\": \"none\"});\r\n" +
//                    "         $(\"#btnHoanTat\").css({\"display\": \"none\"});\r\n" +
//                    "         $(\"#btnHuy\").css({\"display\": \"none\"});\r\n" +
//                    "         $(\"#btnHoiChan\").css({\"display\": \"none\"});\r\n" +
//                    "         $(\".clsUpdateChuyenGiaList\").css({\"display\": \"none\"});\r\n" +
//                    "         $(\".clsUpdateCaBenhList\").css({\"display\": \"none\"});\r\n" +
//                    "       }\r\n" +
//                    "   }\r\n" +
//                #endregion onDisplayButtonWF
//                     "   function initDateTimePicker()\r\n" +
//                    "   {\r\n" +
//                    "       var nowTemp = new Date(); \r\n" +
//                    "       $('#txtThoiGianLapLich').datetimepicker({\r\n" +
//                    "          locale: 'vi', \r\n" +
//                    "          defaultDate: new Date().toString('HH:mm DD/MM/YYYY'),\r\n" +
//                    "          format: 'HH:mm DD/MM/YYYY'," +
//                    "       });\r\n" +
//                    "       $('#txtThoiGianDuyet').datetimepicker({\r\n" +
//                    "          locale: 'vi', \r\n" +
//                    "          format: 'HH:mm DD/MM/YYYY'," +
//                    "       });\r\n" +
//                    "       $('#txtThoiGianHoiChan').datetimepicker({\r\n" +
//                    "          locale: 'vi', \r\n" +
//                    "          format: 'HH:mm DD/MM/YYYY'," +
//                    "       });\r\n" +
//                    "       $('#dtBatDau').datetimepicker({\r\n" +
//                    "          locale: 'vi', \r\n" +
//                    "          format: 'HH:mm DD/MM/YYYY'," +
//                    "       });\r\n" +
//                    "       $('#dtKetThuc').datetimepicker({\r\n" +
//                    "          locale: 'vi', \r\n" +
//                    "          format: 'HH:mm DD/MM/YYYY'," +
//                    "       });\r\n" +
//                    "       $('.input-daterange input').datetimepicker({\r\n" +
//                    "          locale: 'vi', \r\n" +
//                    "          format: 'DD/MM/YYYY'," +
//                    "       });\r\n" +
//                    "   }\r\n" +
//                    "   function DrawDanhSachCaBenh(timkiem,khoaphong,loaibenhan,donvihanhchinh,chandoanravien,tungay,denngay){\r\n" +
//                    "       AjaxOut = OneTSQ.WebParts.LichHoiChan.ServerSideDrawDanhSachCaBenh(RenderInfo,timkiem,khoaphong,loaibenhan,donvihanhchinh,chandoanravien,tungay,denngay).value;\r\n" +
//                    "       if(AjaxOut.Error){\r\n" +
//                    "          callGallAlert(AjaxOut.InfoMessage);\r\n" +
//                    "          return false;\r\n" +
//                    "       }\r\n" +
//                    "       if(AjaxOut.RetBoolean==false){\r\n" +
//                    "          callGallAlert(\"" + WebLanguage.GetLanguage(OSiteParam, "Không có dữ liệu theo điều kiện lọc") + "\");\r\n" +
//                    "          $(\"#tblDanhSachThuoc tbody\").html('');\r\n" +
//                    "          divCaBenhBelongLichHoiChanList.innerHTML=AjaxOut.HtmlContent;\r\n" +
//                    "          thuocsjson='';\r\n" +
//                    "          lstCaBenh=null;\r\n" +
//                    "          return false;\r\n" +
//                    "       }\r\n" +
//                    "       divCaBenhBelongLichHoiChanList.innerHTML=AjaxOut.HtmlContent;\r\n" +
//                    "       thuocsjson=AjaxOut.JsonData;\r\n" +
//                    "       lstCaBenh=AjaxOut.RetObject;\r\n" +
//                    "       $(\"#tblCaBenh tbody tr td a\").first().click();\r\n" +
//                    "       return true;\r\n" +
//                    "   }\r\n" +

//                #region Hiển thị danh sách đơn vị tham vấn thuộc lịch hội chẩn
//                    "   function DrawDanhSachDonViByLichHoiChan(lichhoichanid){\r\n" +
//                    "       AjaxOut = OneTSQ.WebParts.LichHoiChan.DrawDonViBelongLichHoiChanList(RenderInfo,lichhoichanid).value;\r\n" +
//                    "       if(AjaxOut.Error){\r\n" +
//                    "          callGallAlert(AjaxOut.InfoMessage);\r\n" +
//                    "          return false;\r\n" +
//                    "       }\r\n" +
//                    "       divDonViBelongLichHoiChanList.innerHTML=AjaxOut.HtmlContent;\r\n" +
//                    "   }\r\n" +
//                #endregion Hiển thị danh sách đơn vị tham vấn thuộc lịch hội chẩn
//                #region Hiển thị danh sách chuyên gia tư vấn thuộc lịch hội chẩn
//                    "   function DrawDanhSachChuyenGiaByLichHoiChan(lichhoichanid){\r\n" +
//                    "       AjaxOut = OneTSQ.WebParts.LichHoiChan.DrawChuyenGiaBelongLichHoiChanList(RenderInfo,lichhoichanid).value;\r\n" +
//                    "       if(AjaxOut.Error){\r\n" +
//                    "          callGallAlert(AjaxOut.InfoMessage);\r\n" +
//                    "          return false;\r\n" +
//                    "       }\r\n" +
//                    "       divChuyenGiaBelongLichHoiChanList.innerHTML=AjaxOut.HtmlContent;\r\n" +
//                    "   }\r\n" +
//                #endregion Hiển thị danh sách chuyên gia tư vấn thuộc lịch hội chẩn
//                #region Hiển thị danh sách ca bệnh thuộc lịch hội chẩn
//                    "   function DrawDanhSachCaBenhByLichHoiChan(lichhoichanid){\r\n" +
//                    "       AjaxOut = OneTSQ.WebParts.LichHoiChan.DrawCaBenhBelongLichHoiChanList(RenderInfo,lichhoichanid).value;\r\n" +
//                    "       if(AjaxOut.Error){\r\n" +
//                    "          callGallAlert(AjaxOut.InfoMessage);\r\n" +
//                    "          return false;\r\n" +
//                    "       }\r\n" +
//                    "       divCaBenhBelongLichHoiChanList.innerHTML=AjaxOut.HtmlContent;\r\n" +
//                    "   }\r\n" +
//                #endregion Hiển thị danh sách ca bệnh thuộc lịch hội chẩn

//                    "   function checkAllCaBenh(all){\r\n" +
//                    "      if(all.checked){\r\n" +
//                    "           $('.chkCaBenh').prop('checked', true);\r\n" +
//                    "      }\r\n" +
//                    "      else\r\n" +
//                    "           $('.chkCaBenh').prop('checked', false);\r\n" +
//                    "      changeCaBenh();\r\n" +
//                    "   }\r\n" +
//                    "   function loadCaBenh(){\r\n" +
//                    "       var t=$('.chkCaBenh');\r\n" +
//                    "       var len=t.length;\r\n" +
//                    "       benhansTao=[];\r\n" +
//                    "       benhansXoa=[];\r\n" +
//                    "       count=0;\r\n" +
//                    "       for(var i=0;i<len;i++){\r\n" +
//                    "           if(t[i].checked==true){\r\n" +
//                    "              benhansTao.push(t[i].value);\r\n" +
//                    "               count++;\r\n" +
//                    "           }\r\n" +
//                    "           else\r\n" +
//                    "               benhansXoa.push(t[i].value);\r\n" +
//                    "       }\r\n" +
//                    "       if(count===len)\r\n" +
//                    "           $('#chkAllCaBenh').prop('checked', true);\r\n" +
//                    "       else\r\n" +
//                    "           $('#chkAllCaBenh').prop('checked', false);\r\n" +

//                    "   }\r\n" +
//                    "   function loadCaBenhSauHoanTat(){\r\n" +
//                    "       var len=benhansXoa.length;\r\n" +
//                    "       count=0;\r\n" +
//                    "       for(var i=0;i<len;i++)\r\n" +
//                    "       {\r\n" +
//                    "           $('#chk'+benhansXoa[i]).closest('tr').remove(); \r\n" +
//                    "       }\r\n" +
//                    "       benhansXoa = [];\r\n" +
//                    "   }\r\n" +
//                    "   function changeCaBenh(){\r\n" +
//                    "       var t=$('.chkCaBenh');\r\n" +
//                    "       var len=t.length;\r\n" +
//                    "       benhansTao=[];\r\n" +
//                    "       benhansXoa=[];\r\n" +
//                    "       count=0;\r\n" +
//                    "       for(var i=0;i<len;i++){\r\n" +
//                    "           if(t[i].checked==true){\r\n" +
//                    "              benhansTao.push(t[i].value);\r\n" +
//                    "               count++;\r\n" +
//                    "           }\r\n" +
//                    "           else\r\n" +
//                    "               benhansXoa.push(t[i].value);\r\n" +
//                    "       }\r\n" +
//                    "       if(count===len)\r\n" +
//                    "           $('#chkAllCaBenh').prop('checked', true);\r\n" +
//                    "       else\r\n" +
//                    "           $('#chkAllCaBenh').prop('checked', false);\r\n" +
//                    "   }\r\n" +
//                    //  Conver tg yyyy/MM/dd HH:mm
//                    "   function fnConvertDate_yyyyMMddHHmm(s)\r\n" +
//                    "   {\r\n" +
//                    "       var result = '';\r\n" +
//                    "       if(s != null && s != ''){\r\n" +
//                    "           var array = s.split(':');\r\n" +
//                    "           var Minutes = array[1].substring(0,2).replace(' ','');\r\n" +
//                    "           var Date = array[1].substring(2).replace(' ','');\r\n" +
//                    "           result =  Date.split('/')[2] + '/' + Date.split('/')[1] + '/' + Date.split('/')[0] + ' ' + array[0] + ':' + Minutes;\r\n" +
//                    "       }\r\n " +
//                    "       return result;\r\n" +
//                    "   }\r\n" +
//                   "   function CallInitSelect2(Id, svUrl, place)\r\n" +
//                   "   {\r\n" +
//                   "    $(\"#\"+Id).select2({ \r\n" +
//                   "          placeholder: place,\r\n" +
//                   "          allowClear: true,\r\n" +
//                   "          ajax: { \r\n" +
//                   "              id: function (e) { return e.id + ' ' + e.text },  \r\n" +
//                   "              url: svUrl,\r\n" +
//                   "              dataType: 'json', \r\n" +
//                   "              delay: 250, \r\n" +
//                   "              type: 'POST',  \r\n" +
//                   "              data: function (params) { \r\n" +
//                   "                  return { \r\n" +
//                   "                      q: params.term,  \r\n" +
//                   "                      page: params.page \r\n" +
//                   "                  }; \r\n" +
//                   "              }, \r\n" +
//                   "              processResults: function (data, params) { \r\n" +
//                   "                  params.page = params.page || 0; \r\n" +
//                   "                  return { \r\n" +
//                   "                      results: data.items, \r\n" +
//                   "                      pagination: { \r\n" +
//                   "                          more: (params.page * 25 + data.items.length) < data.total_count \r\n" +
//                   "                      } \r\n" +
//                   "                  }; \r\n" +
//                   "              }, \r\n" +
//                   "              cache: true \r\n" +
//                   "          }, \r\n" +
//                   "          escapeMarkup: function (markup) { return markup; },  \r\n" +
//                   "          minimumInputLength: 0, \r\n" +
//                   "          templateResult: formatRepo,  \r\n" +
//                   "          templateSelection: formatRepoSelection \r\n" +
//                   "      }); \r\n" +
//                   "   }\r\n" +
//                   " CallInitSelect2();\r\n" +
//                   "  function formatRepo(repo) { \r\n" +
//                   "     if (repo.loading) return repo.text; \r\n" +
//                   "     var markup = '<table ><tr><td style=\"color:maroon;font-weight:bold; width:80px;padding:4px\">'+ repo.Code+'</td> <td >'+repo.Name+'</td></tr></table>'; \r\n" +
//                   "     return markup; \r\n" +
//                   "  } \r\n" +
//                   "  function formatRepoSelection(repo) { \r\n" +
//                   "    if(repo.Code == undefined)\r\n" +
//                   "       return repo.text; \r\n" +
//                   "    else\r\n" +
//                   "       return repo.text; \r\n" +
//                   "  } \r\n" +
//                   "   function checkAllBenhAn(all){\r\n" +
//                   "      if(all.checked){\r\n" +
//                   "           $('.chkBenhAn').prop('checked', true);\r\n" +
//                   "      }\r\n" +
//                   "      else\r\n" +
//                   "           $('.chkBenhAn').prop('checked', false);\r\n" +
//                   "      changeBenhAn();\r\n" +
//                   "   }\r\n" +
//                    //Check phân quyền
//                    "    function fnCheckShowBtnByPhanQuyen(){\r\n" +
//                    "        AjaxOut = OneTSQ.WebParts.LichHoiChan.ServerSideCheckQuyenLuu(RenderInfo).value;\r\n" +
//                    "        if(!AjaxOut.RetBoolean)\r\n" +
//                    "           $('#btnLuu').css('display','none');\r\n" +
//                    "        else\r\n" +
//                    "           $('#btnLuu').css('display','block');\r\n" +

//                    "        AjaxOut = OneTSQ.WebParts.LichHoiChan.ServerSideCheckQuyenTai(RenderInfo).value;\r\n" +
//                    "        if(!AjaxOut.RetBoolean)\r\n" +
//                    "           $('#btnLoad').css('display','none');\r\n" +
//                    "        else\r\n" +
//                    "           $('#btnLoad').css('display','block');\r\n" +
//                    "        AjaxOut = OneTSQ.WebParts.LichHoiChan.ServerSideCheckQuyenThuHoi(RenderInfo,lichhoichanid).value;\r\n" +
//                    "        if(!AjaxOut.RetBoolean)\r\n" +
//                    "           $(\"#btnTHUHOI\" ).prop(\"disabled\", false );\r\n" +
//                    "        else\r\n" +
//                    "            $(\"#btnTHUHOI\").prop(\"disabled\", true );\r\n" +

//                    "    }\r\n" +
//                    "</script>\r\n";
//                #endregion javaScript
//                RetAjaxOut.HtmlContent = WebEnvironments.ProcessHtml(html) + WebEnvironments.ProcessJavascript(js);

//            }
//            catch (Exception ex)
//            {
//                RetAjaxOut.Error = true;
//                RetAjaxOut.HtmlContent = ex.Message.ToString();
//                RetAjaxOut.InfoMessage = ex.Message.ToString();
//            }
//            return RetAjaxOut;
//        }
//        [AjaxPro.AjaxMethod(AjaxPro.HttpSessionStateRequirement.ReadWrite)]
//        public static AjaxOut DrawDonViBelongLichHoiChanList(RenderInfoCls ORenderInfo, string lichHoiChanId)
//        {
//            AjaxOut RetAjaxOut = new AjaxOut();
//            try
//            {
//                SiteParam OSiteParam = WebEnvironments.CreateSiteParam(ORenderInfo);
//                LichHoiChanCls lichHoiChan = CallBussinessUtility.CreateBussinessProcess().CreateLichHoiChanProcess().CreateModel(ORenderInfo, lichHoiChanId);
//                BacSyCls thuKy = CallBussinessUtility.CreateBussinessProcess().CreateBacSyProcess().CreateModel(ORenderInfo, lichHoiChan.THUKY);
//                LapLichThanhVienHoiChanCls[] lapLichThanhVienHoiChans = string.IsNullOrEmpty(lichHoiChanId) || thuKy == null || String.IsNullOrEmpty(thuKy.DONVIMA) ? new LapLichThanhVienHoiChanCls[0] : CallBussinessUtility.CreateBussinessProcess().CreateLapLichThanhVienHoiChanProcess().Reading(ORenderInfo, new LapLichThanhVienHoiChanFilterCls() { LICHHOICHANID = lichHoiChanId, KHACDONVICONGTACMA = thuKy.DONVIMA });
//                int bacSyTotal = lapLichThanhVienHoiChans.Count();
//                string html = "";
//                if (bacSyTotal == 0)
//                {
//                    html += WebScreen.GetPanelInfo(OSiteParam, WebLanguage.GetLanguage(OSiteParam, "Không tìm thấy đơn vị nào thuộc lịch này"), true);
//                }
//                else
//                {
//                    //Set số thứ thự và sắp xếp lại danh sách thành viên tham gia hội chẩn
//                    for (int iIndex = 0; iIndex < bacSyTotal; iIndex++)
//                    {
//                        if (!string.IsNullOrEmpty(lapLichThanhVienHoiChans[iIndex].DONVICONGTACMA))
//                        {
//                            XmlCls XmlCommand = DmProcessWebServiceUtility.Utility.CreateCommand("donvicongtac.createmodel", ORenderInfo, lapLichThanhVienHoiChans[iIndex].DONVICONGTACMA, "");
//                            AjaxOut ajaxOut = DmProcessWebServiceUtility.Utility.ProcessComand("DonViCongTacWsProcessCommand", XmlCommand.XmlData, XmlCommand.XmlDataSchema);
//                            DonViCongTacCls donViCongTac = DonViCongTacParser.ParseFromXml(ajaxOut.XmlDataResult, ajaxOut.XmlDataResultSchema);
//                            if (donViCongTac != null)
//                                lapLichThanhVienHoiChans[iIndex].STT = donViCongTac.Stt;
//                        }
//                    }
//                    lapLichThanhVienHoiChans = lapLichThanhVienHoiChans.OrderBy(o => o.STT).ToArray();
//                    html +=
//                    "         <div class=\"table-responsive\"> \r\n" +
//                    "             <table class=\"table table-bordered table-hover dataTables-autosort footable-loaded footable\"> \r\n" +
//                    "                 <thead> \r\n" +
//                    "                 <tr> \r\n" +
//                    "                     <th class=\"th-func-20\" style='width:50px;'>STT</th> \r\n" +
//                    "                     <th>" + WebLanguage.GetLanguage(OSiteParam, "Mã đơn vị") + " </th> \r\n" +
//                    "                     <th>" + WebLanguage.GetLanguage(OSiteParam, "Chuyên khoa") + " </th> \r\n" +
//                    "                     <th>" + WebLanguage.GetLanguage(OSiteParam, "Đơn vị") + " </th> \r\n" +
//                    "                     <th>" + WebLanguage.GetLanguage(OSiteParam, "Xóa") + " </th> \r\n" +
//                    "                 </tr> \r\n" +
//                    "                 </thead> \r\n" +
//                    "                 <tbody> \r\n";
//                    for (int iIndex = 0; iIndex < bacSyTotal; iIndex++)
//                    {
//                        DonViCongTacCls donViCongTac = null;
//                        if (!string.IsNullOrEmpty(lapLichThanhVienHoiChans[iIndex].DONVICONGTACMA))
//                        {
//                            XmlCls XmlCommand = DmProcessWebServiceUtility.Utility.CreateCommand("donvicongtac.createmodel", ORenderInfo, lapLichThanhVienHoiChans[iIndex].DONVICONGTACMA, "");
//                            AjaxOut ajaxOut = DmProcessWebServiceUtility.Utility.ProcessComand("DonViCongTacWsProcessCommand", XmlCommand.XmlData, XmlCommand.XmlDataSchema);
//                            donViCongTac = DonViCongTacParser.ParseFromXml(ajaxOut.XmlDataResult, ajaxOut.XmlDataResultSchema);
//                        }
//                        BacSyCls bacSy = CallBussinessUtility.CreateBussinessProcess().CreateBacSyProcess().CreateModel(ORenderInfo, lapLichThanhVienHoiChans[iIndex].BACSYID);
//                        OneMES3.DM.Model.ChuyenKhoaCls chuyenKhoa = null;
//                        if (!string.IsNullOrEmpty(bacSy.CHUYENKHOAMA))
//                        {
//                            XmlCls XmlCommand = DmProcessWebServiceUtility.Utility.CreateCommand("chuyenkhoa.createmodel", ORenderInfo, bacSy.CHUYENKHOAMA, "");
//                            AjaxOut ajaxOut = DmProcessWebServiceUtility.Utility.ProcessComand("ChuyenKhoaWsProcessCommand", XmlCommand.XmlData, XmlCommand.XmlDataSchema);
//                            chuyenKhoa = ChuyenKhoaParser.ParseFromXml(ajaxOut.XmlDataResult, ajaxOut.XmlDataResultSchema);
//                        }
//                        html +=
//                            "                 <tr> \r\n" +
//                            "                     <td style='text-align: center; vertical-align: middle;'>" + (iIndex + 1) + "</td> \r\n" +
//                            "                     <td style='text-align: center; vertical-align: middle;'>" + bacSy.DONVIMA + "</td> \r\n" +
//                            "                     <td style='vertical-align: middle;'>" + (chuyenKhoa != null ? chuyenKhoa.Ten : bacSy.CHUYENKHOAMA) + "</td> \r\n" +
//                            "                     <td style='vertical-align: middle;'>" + (donViCongTac != null ? donViCongTac.Ten : null) + "</td> \r\n" +
//                            "                     <td style='text-align: center; vertical-align: middle;'><a href='javascript:RemoveDonVi(\"" + lapLichThanhVienHoiChans[iIndex].BACSYID + "\");' title='" + WebLanguage.GetLanguage(OSiteParam, "Xóa đơn vị khỏi lịch hội chẩn") + "'>" + WebLanguage.GetLanguage(OSiteParam, "Xóa") + "</a></td> \r\n" +
//                            "                 </tr> \r\n";
//                    }
//                    html +=
//                        "                 </tbody> \r\n" +
//                        "             </table> \r\n" +
//                        "       </div>\r\n" +
//                        "<style>\r\n" +
//                        "table th{text-align: center; vertical-align: middle;}\r\n" +
//                        "</style>\r\n"
//                        ;
//                }
//                html = WebEnvironments.ProcessHtml(html);
//                RetAjaxOut.HtmlContent = html;
//            }
//            catch (Exception ex)
//            {
//                RetAjaxOut.Error = true;
//                RetAjaxOut.InfoMessage = ex.Message.ToString();
//                RetAjaxOut.HtmlContent = ex.Message.ToString();
//            }
//            return RetAjaxOut;
//        }
//        [AjaxPro.AjaxMethod(AjaxPro.HttpSessionStateRequirement.ReadWrite)]
//        public static AjaxOut DrawChuyenGiaBelongLichHoiChanList(RenderInfoCls ORenderInfo, string lichHoiChanId)
//        {
//            AjaxOut RetAjaxOut = new AjaxOut();
//            try
//            {
//                SiteParam OSiteParam = WebEnvironments.CreateSiteParam(ORenderInfo);
//                LichHoiChanCls lichHoiChan = CallBussinessUtility.CreateBussinessProcess().CreateLichHoiChanProcess().CreateModel(ORenderInfo, lichHoiChanId);
//                BacSyCls thuKy = CallBussinessUtility.CreateBussinessProcess().CreateBacSyProcess().CreateModel(ORenderInfo, lichHoiChan.THUKY);
//                LapLichThanhVienHoiChanCls[] lapLichThanhVienHoiChans = string.IsNullOrEmpty(lichHoiChanId) || thuKy == null || String.IsNullOrEmpty(thuKy.DONVIMA) ? new LapLichThanhVienHoiChanCls[0] : CallBussinessUtility.CreateBussinessProcess().CreateLapLichThanhVienHoiChanProcess().Reading(ORenderInfo, new LapLichThanhVienHoiChanFilterCls() { LICHHOICHANID = lichHoiChanId, DONVICONGTACMA = thuKy.DONVIMA });
//                int bacSyTotal = lapLichThanhVienHoiChans.Count();
//                string html = "";
//                if (bacSyTotal == 0)
//                {
//                    html += WebScreen.GetPanelInfo(OSiteParam, WebLanguage.GetLanguage(OSiteParam, "Không tìm thấy chuyên gia nào"), true);
//                }
//                else
//                {
//                    //Set số thứ thự và sắp xếp lại danh sách thành viên tham gia hội chẩn
//                    for (int iIndex = 0; iIndex < bacSyTotal; iIndex++)
//                    {
//                        if (!string.IsNullOrEmpty(lapLichThanhVienHoiChans[iIndex].DONVICONGTACMA))
//                        {
//                            XmlCls XmlCommand = DmProcessWebServiceUtility.Utility.CreateCommand("donvicongtac.createmodel", ORenderInfo, lapLichThanhVienHoiChans[iIndex].DONVICONGTACMA, "");
//                            AjaxOut ajaxOut = DmProcessWebServiceUtility.Utility.ProcessComand("DonViCongTacWsProcessCommand", XmlCommand.XmlData, XmlCommand.XmlDataSchema);
//                            DonViCongTacCls donViCongTac = DonViCongTacParser.ParseFromXml(ajaxOut.XmlDataResult, ajaxOut.XmlDataResultSchema);
//                            if (donViCongTac != null)
//                                lapLichThanhVienHoiChans[iIndex].STT = donViCongTac.Stt;
//                        }
//                    }
//                    lapLichThanhVienHoiChans = lapLichThanhVienHoiChans.OrderBy(o => o.STT).ToArray();
//                    html +=
//                    "         <div class=\"table-responsive\"> \r\n" +
//                    "             <table class=\"table table-bordered table-hover dataTables-autosort footable-loaded footable\"> \r\n" +
//                    "                 <thead> \r\n" +
//                    "                 <tr> \r\n" +
//                    "                     <th class=\"th-func-20\" style='width:50px;'>STT</th> \r\n" +
//                    "                     <th>" + WebLanguage.GetLanguage(OSiteParam, "Mã") + " </th> \r\n" +
//                    "                     <th>" + WebLanguage.GetLanguage(OSiteParam, "Họ tên") + " </th> \r\n" +
//                    "                     <th>" + WebLanguage.GetLanguage(OSiteParam, "Chuyên khoa") + " </th> \r\n" +
//                    "                     <th>" + WebLanguage.GetLanguage(OSiteParam, "Xóa") + " </th> \r\n" +
//                    "                 </tr> \r\n" +
//                    "                 </thead> \r\n" +
//                    "                 <tbody> \r\n";
//                    for (int iIndex = 0; iIndex < bacSyTotal; iIndex++)
//                    {
//                        BacSyCls bacSy = CallBussinessUtility.CreateBussinessProcess().CreateBacSyProcess().CreateModel(ORenderInfo, lapLichThanhVienHoiChans[iIndex].BACSYID);
//                        OneMES3.DM.Model.ChuyenKhoaCls chuyenKhoa = null;
//                        if (!string.IsNullOrEmpty(bacSy.CHUYENKHOAMA))
//                        {
//                            XmlCls XmlCommand = DmProcessWebServiceUtility.Utility.CreateCommand("chuyenkhoa.createmodel", ORenderInfo, bacSy.CHUYENKHOAMA, "");
//                            AjaxOut ajaxOut = DmProcessWebServiceUtility.Utility.ProcessComand("ChuyenKhoaWsProcessCommand", XmlCommand.XmlData, XmlCommand.XmlDataSchema);
//                            chuyenKhoa = ChuyenKhoaParser.ParseFromXml(ajaxOut.XmlDataResult, ajaxOut.XmlDataResultSchema);
//                        }
//                        html +=
//                            "                 <tr> \r\n" +
//                            "                     <td style='text-align: center; vertical-align: middle;'>" + (iIndex + 1) + "</td> \r\n" +
//                            "                     <td style='text-align: center; vertical-align: middle;'>" + bacSy.MA + "</td> \r\n" +
//                            "                     <td style='vertical-align: middle;'>" + bacSy.HOTEN + "</td> \r\n" +
//                            "                     <td style='vertical-align: middle;'>" + (chuyenKhoa != null ? chuyenKhoa.Ten : null) + "</td> \r\n" +
//                            "                     <td style='text-align: center; vertical-align: middle;'><a href='javascript:RemoveChuyenGia(\"" + lapLichThanhVienHoiChans[iIndex].BACSYID + "\");' title='" + WebLanguage.GetLanguage(OSiteParam, "Xóa đơn vị khỏi lịch hội chẩn") + "'>" + WebLanguage.GetLanguage(OSiteParam, "Xóa") + "</a></td> \r\n" +
//                            "                 </tr> \r\n";
//                    }
//                    html +=
//                        "                 </tbody> \r\n" +
//                        "             </table> \r\n" +
//                        "       </div>\r\n" +
//                        "<style>\r\n" +
//                        "table th{text-align: center; vertical-align: middle;}\r\n" +
//                        "</style>\r\n"
//                        ;
//                }
//                html = WebEnvironments.ProcessHtml(html);
//                RetAjaxOut.HtmlContent = html;
//            }
//            catch (Exception ex)
//            {
//                RetAjaxOut.Error = true;
//                RetAjaxOut.InfoMessage = ex.Message.ToString();
//                RetAjaxOut.HtmlContent = ex.Message.ToString();
//            }
//            return RetAjaxOut;
//        }

//        [AjaxPro.AjaxMethod(AjaxPro.HttpSessionStateRequirement.ReadWrite)]
//        public static AjaxOut DrawDonViSearchResultList(RenderInfoCls ORenderInfo, int PageIndex, string lichHoiChanId, string keyword, string donViMa, string chuyenKhoaMa, string[] CheckedArr)
//        {
//            AjaxOut RetAjaxOut = new AjaxOut();
//            try
//            {
//                SiteParam
//                    OSiteParam = WebEnvironments.CreateSiteParam(ORenderInfo);
//                WebSession.CheckSessionTimeOut(ORenderInfo);
//                string userId = WebSessionUtility.GetCurrentLoginUser(OSiteParam).OwnerUserId;
//                LichHoiChanCls lichHoiChan = CallBussinessUtility.CreateBussinessProcess().CreateLichHoiChanProcess().CreateModel(ORenderInfo, lichHoiChanId);
//                BacSyCls thuKy = CallBussinessUtility.CreateBussinessProcess().CreateBacSyProcess().CreateModel(ORenderInfo, lichHoiChan.THUKY);
//                BacSyFilterCls filter = new BacSyFilterCls() { PageIndex = PageIndex, PageSize = 10, KHACLICHHOICHANID = lichHoiChanId, Keyword = keyword, KHACDONVIMA = thuKy == null ? null : thuKy.DONVIMA, DONVIMA = donViMa, CHUYENKHOAMA = chuyenKhoaMa };
//                long recordTotal = 0;
//                BacSyCls[] bacSys = CallBussinessUtility.CreateBussinessProcess().CreateBacSyProcess().PageReading(ORenderInfo, filter, ref recordTotal);
//                ReturnPaging RetPaging = WebPaging.GetPaging((int)recordTotal, filter.PageIndex, filter.PageSize, 10, "DonViNextPage");
//                int bacSyTotal = bacSys.Count();
//                string html = "";
//                if (bacSyTotal == 0)
//                {
//                    html += WebScreen.GetPanelInfo(OSiteParam, "Không tìm thấy đơn vị nào thỏa mãn điều kiện tìm kiếm.", true);
//                }
//                else
//                {
//                    html +=
//                        "         <div class=\"table-responsive\"> \r\n" +
//                        "             <table class=\"table table-bordered table-hover dataTables-autosort footable-loaded footable\"> \r\n" +
//                        "                 <thead> \r\n" +
//                        "                 <tr> \r\n" +
//                        "                     <th class=\"th-func-20\"><input type =\"checkbox\" class=\"i-checks\" id='ckbAllPage' onclick='ckbAllChuyenGiaPage_onclick(this)'></th> \r\n" +
//                        "                     <th class=\"th-func-20\">STT</th> \r\n" +
//                        "                     <th>" + WebLanguage.GetLanguage(OSiteParam, "Mã đơn vị") + " </th> \r\n" +
//                        "                     <th>" + WebLanguage.GetLanguage(OSiteParam, "Chuyên khoa") + " </th> \r\n" +
//                        "                     <th>" + WebLanguage.GetLanguage(OSiteParam, "Đơn vị") + " </th> \r\n" +
//                        "                 </tr> \r\n" +
//                        "                 </thead> \r\n" +
//                        "                 <tbody> \r\n";
//                    for (int iIndex = 0; iIndex < bacSyTotal; iIndex++)
//                    {
//                        DonViCongTacCls donViCongTac = null;
//                        if (!string.IsNullOrEmpty(bacSys[iIndex].DONVIMA))
//                        {
//                            XmlCls XmlCommand = DmProcessWebServiceUtility.Utility.CreateCommand("donvicongtac.createmodel", ORenderInfo, bacSys[iIndex].DONVIMA, "");
//                            AjaxOut ajaxOut = DmProcessWebServiceUtility.Utility.ProcessComand("DonViCongTacWsProcessCommand", XmlCommand.XmlData, XmlCommand.XmlDataSchema);
//                            donViCongTac = DonViCongTacParser.ParseFromXml(ajaxOut.XmlDataResult, ajaxOut.XmlDataResultSchema);
//                        }
//                        OneMES3.DM.Model.ChuyenKhoaCls chuyenKhoa = null;
//                        if (!string.IsNullOrEmpty(bacSys[iIndex].CHUYENKHOAMA))
//                        {
//                            XmlCls XmlCommand = DmProcessWebServiceUtility.Utility.CreateCommand("chuyenkhoa.createmodel", ORenderInfo, bacSys[iIndex].CHUYENKHOAMA, "");
//                            AjaxOut ajaxOut = DmProcessWebServiceUtility.Utility.ProcessComand("ChuyenKhoaWsProcessCommand", XmlCommand.XmlData, XmlCommand.XmlDataSchema);
//                            chuyenKhoa = ChuyenKhoaParser.ParseFromXml(ajaxOut.XmlDataResult, ajaxOut.XmlDataResultSchema);
//                        }
//                        int ArrIndex = CheckedArr.Count() - 1;
//                        while (ArrIndex >= 0 && CheckedArr[ArrIndex] != bacSys[iIndex].ID)
//                            ArrIndex--;

//                        html +=
//                            "                 <tr> \r\n" +
//                            "                     <td class=\"td-center\" style='text-align: center; vertical-align: middle;'><input type =\"checkbox\" class=\"i-checks clsCkbChuyenGia\" id='" + bacSys[iIndex].ID + "' " + (ArrIndex >= 0 ? "checked" : "") + " onclick='ckbChuyenGia_onclick(this)'></td> \r\n" +
//                            "                     <td class=\"td-right\" style='text-align: center; vertical-align: middle;'>" + (filter.PageIndex * filter.PageSize + iIndex + 1).ToString("#,##0") + "</td> \r\n" +
//                            "                     <td style='text-align: center; vertical-align: middle;'>" + bacSys[iIndex].DONVIMA + "</td> \r\n" +
//                            "                     <td style='vertical-align: middle;'>" + (chuyenKhoa != null ? chuyenKhoa.Ten : bacSys[iIndex].CHUYENKHOAMA) + "</td> \r\n" +
//                            "                     <td style='vertical-align: middle;' id='tddvct" + bacSys[iIndex].ID + "'>" + (donViCongTac != null ? donViCongTac.Ten : null) + "</td> \r\n" +
//                            "                 </tr> \r\n";
//                    }
//                    html +=
//                        "                 </tbody> \r\n" +
//                        "             </table> \r\n" +
//                        "       </div>\r\n" +
//                        "         <div class=\"col-md-12\">\r\n" +
//                        "              <div class=\"col-md-1\" style=\"margin-top:26px;padding-left: 0px;\">\r\n" +
//                        "               <lable>" + WebLanguage.GetLanguage(OSiteParam, "Tổng số") + ": " + (filter.PageIndex * filter.PageSize + bacSyTotal).ToString("#,##0") + "" + "/ " + "" + (int)recordTotal + "</lable>\r\n" +
//                        "              </div>\r\n" +
//                        "             <div class=\"col-md-10\" style=\"margin-top:20px;\">\r\n" +
//                        RetPaging.PagingText +
//                        "             </div>\r\n" +
//                        "         </div>\r\n" +
//                        "<style>\r\n" +
//                        "table th{text-align: center; vertical-align: middle;}\r\n" +
//                        "</style>\r\n"
//                        ;
//                }
//                RetAjaxOut.HtmlContent = WebEnvironments.ProcessHtml(html);
//            }
//            catch (Exception ex)
//            {
//                RetAjaxOut.Error = true;
//                RetAjaxOut.InfoMessage = ex.Message.ToString();
//                RetAjaxOut.HtmlContent = ex.Message.ToString();
//            }
//            return RetAjaxOut;
//        }
//        [AjaxPro.AjaxMethod(AjaxPro.HttpSessionStateRequirement.ReadWrite)]
//        public static AjaxOut DrawChuyenGiaSearchResultList(RenderInfoCls ORenderInfo, int PageIndex, string lichHoiChanId, string keyword, string chuyenKhoaMa, string[] CheckedArr)
//        {
//            AjaxOut RetAjaxOut = new AjaxOut();
//            try
//            {
//                SiteParam
//                    OSiteParam = WebEnvironments.CreateSiteParam(ORenderInfo);
//                WebSession.CheckSessionTimeOut(ORenderInfo);
//                string userId = WebSessionUtility.GetCurrentLoginUser(OSiteParam).OwnerUserId;
//                LichHoiChanCls lichHoiChan = CallBussinessUtility.CreateBussinessProcess().CreateLichHoiChanProcess().CreateModel(ORenderInfo, lichHoiChanId);
//                BacSyCls thuKy = CallBussinessUtility.CreateBussinessProcess().CreateBacSyProcess().CreateModel(ORenderInfo, lichHoiChan.THUKY);
//                BacSyFilterCls filter = thuKy == null ? new BacSyFilterCls() : new BacSyFilterCls() { PageIndex = PageIndex, PageSize = 10, KHACLICHHOICHANID = lichHoiChanId, Keyword = keyword, DONVIMA = thuKy.DONVIMA, CHUYENKHOAMA = chuyenKhoaMa };
//                long recordTotal = 0;
//                BacSyCls[] bacSys = thuKy == null ? new BacSyCls[0] : CallBussinessUtility.CreateBussinessProcess().CreateBacSyProcess().PageReading(ORenderInfo, filter, ref recordTotal);
//                ReturnPaging RetPaging = WebPaging.GetPaging((int)recordTotal, filter.PageIndex, filter.PageSize, 10, "ChuyenGiaNextPage");
//                int bacSyTotal = bacSys.Count();
//                string html = "";
//                if (bacSyTotal == 0)
//                {
//                    html += WebScreen.GetPanelInfo(OSiteParam, "Không tìm thấy đơn vị nào thỏa mãn điều kiện tìm kiếm.", true);
//                }
//                else
//                {
//                    html +=
//                        "         <div class=\"table-responsive\"> \r\n" +
//                        "             <table class=\"table table-bordered table-hover dataTables-autosort footable-loaded footable\"> \r\n" +
//                        "                 <thead> \r\n" +
//                        "                 <tr> \r\n" +
//                        "                     <th class=\"th-func-20\"><input type =\"checkbox\" class=\"i-checks\" id='ckbAllPage' onclick='ckbAllChuyenGiaPage_onclick(this)'></th> \r\n" +
//                        "                     <th class=\"th-func-20\">STT</th> \r\n" +
//                        "                     <th>" + WebLanguage.GetLanguage(OSiteParam, "Mã") + " </th> \r\n" +
//                        "                     <th>" + WebLanguage.GetLanguage(OSiteParam, "Họ tên") + " </th> \r\n" +
//                        "                     <th>" + WebLanguage.GetLanguage(OSiteParam, "Chuyên khoa") + " </th> \r\n" +
//                        "                 </tr> \r\n" +
//                        "                 </thead> \r\n" +
//                        "                 <tbody> \r\n";
//                    for (int iIndex = 0; iIndex < bacSyTotal; iIndex++)
//                    {
//                        OneMES3.DM.Model.ChuyenKhoaCls chuyenKhoa = null;
//                        if (!string.IsNullOrEmpty(bacSys[iIndex].CHUYENKHOAMA))
//                        {
//                            XmlCls XmlCommand = DmProcessWebServiceUtility.Utility.CreateCommand("chuyenkhoa.createmodel", ORenderInfo, bacSys[iIndex].CHUYENKHOAMA, "");
//                            AjaxOut ajaxOut = DmProcessWebServiceUtility.Utility.ProcessComand("ChuyenKhoaWsProcessCommand", XmlCommand.XmlData, XmlCommand.XmlDataSchema);
//                            chuyenKhoa = ChuyenKhoaParser.ParseFromXml(ajaxOut.XmlDataResult, ajaxOut.XmlDataResultSchema);
//                        }
//                        int ArrIndex = CheckedArr.Count() - 1;
//                        while (ArrIndex >= 0 && CheckedArr[ArrIndex] != bacSys[iIndex].ID)
//                            ArrIndex--;

//                        html +=
//                            "                 <tr> \r\n" +
//                            "                     <td class=\"td-center\" style='text-align: center; vertical-align: middle;'><input type =\"checkbox\" class=\"i-checks clsCkbChuyenGia\" id='" + bacSys[iIndex].ID + "' " + (ArrIndex >= 0 ? "checked" : "") + " onclick='ckbChuyenGia_onclick(this)'></td> \r\n" +
//                            "                     <td class=\"td-right\" style='text-align: center; vertical-align: middle;'>" + (filter.PageIndex * filter.PageSize + iIndex + 1).ToString("#,##0") + "</td> \r\n" +
//                            "                     <td style='text-align: center; vertical-align: middle;'>" + bacSys[iIndex].MA + "</td> \r\n" +
//                            "                     <td style='vertical-align: middle;'>" + bacSys[iIndex].HOTEN + "</td> \r\n" +
//                            "                     <td style='vertical-align: middle;'>" + (chuyenKhoa != null ? chuyenKhoa.Ten : bacSys[iIndex].CHUYENKHOAMA) + "</td> \r\n" +
//                            "                 </tr> \r\n";
//                    }
//                    html +=
//                        "                 </tbody> \r\n" +
//                        "             </table> \r\n" +
//                        "       </div>\r\n" +
//                        "         <div class=\"col-md-12\">\r\n" +
//                        "              <div class=\"col-md-1\" style=\"margin-top:26px;padding-left: 0px;\">\r\n" +
//                        "               <lable>" + WebLanguage.GetLanguage(OSiteParam, "Tổng số") + ": " + (filter.PageIndex * filter.PageSize + bacSyTotal).ToString("#,##0") + "" + "/ " + "" + (int)recordTotal + "</lable>\r\n" +
//                        "              </div>\r\n" +
//                        "             <div class=\"col-md-10\" style=\"margin-top:20px;\">\r\n" +
//                        RetPaging.PagingText +
//                        "             </div>\r\n" +
//                        "         </div>\r\n" +
//                        "<style>\r\n" +
//                        "table th{text-align: center; vertical-align: middle;}\r\n" +
//                        "</style>\r\n"
//                        ;
//                }
//                RetAjaxOut.HtmlContent = WebEnvironments.ProcessHtml(html);
//            }
//            catch (Exception ex)
//            {
//                RetAjaxOut.Error = true;
//                RetAjaxOut.InfoMessage = ex.Message.ToString();
//                RetAjaxOut.HtmlContent = ex.Message.ToString();
//            }
//            return RetAjaxOut;
//        }
//        [AjaxPro.AjaxMethod(AjaxPro.HttpSessionStateRequirement.ReadWrite)]
//        public static AjaxOut PopupAddDonVi(RenderInfoCls ORenderInfo, string lichhoichanid)
//        {
//            AjaxOut RetAjaxOut = new AjaxOut();
//            try
//            {
//                SiteParam OSiteParam = WebEnvironments.CreateSiteParam(ORenderInfo);
//                WebSession.CheckSessionTimeOut(ORenderInfo);
//                string userId = WebSessionUtility.GetCurrentLoginUser(OSiteParam).OwnerUserId;
//                RetAjaxOut.HtmlContent = WebEnvironments.ProcessHtml(
//                "<table style='width:100%'>\r\n" +
//                    "<tr>\r\n" +
//                    "   <td style='width:30%'>\r\n" +
//                    "       <div class='form-group'>" + WebLanguage.GetLanguage(OSiteParam, "Từ khóa") + "<input id=\"txtKeyword\" placeholder=\"Tìm kiếm theo mã BS, họ tên BS\" class=\"form-control valueForm\" style=\"border-radius: 4px;\"></div>\r\n" +
//                    "   </td>\r\n" +
//                    "   <td style='width:30%'>\r\n" +
//                    "       <div class='form-group'>" + WebLanguage.GetLanguage(OSiteParam, "Đơn vị") + "<select id = 'cbbDonVi'></select></div>\r\n" +
//                    "   </td>\r\n" +
//                    //"   <td style='width:30%'>\r\n" +
//                    //"       <div class='form-group'>" + WebLanguage.GetLanguage(OSiteParam, "Bệnh viện") + "<select id = 'cbbBenhVien'></select></div>\r\n" +
//                    //"   </td>\r\n" +
//                    "   <td style='width:30%'>\r\n" +
//                    "       <div class='form-group'>" + WebLanguage.GetLanguage(OSiteParam, "Chuyên khoa") + "<select id = 'cbbChuyenKhoaFilter'></select></div>\r\n" +
//                    "   </td>\r\n" +
//                    "   <td style='width:10%'>\r\n" +
//                    "       <div class=\"form-group\">\r\n" +
//                    "           <button id=\"btnTimKiem\" class=\"btn btn-sm  mr-10px\" onclick=\"SearchDonVi()\" style=\"margin-top: 20px; height: 28px;background-color: #e26614;color:white;\"><strong>Tìm kiếm</strong></button>\r\n" +
//                    "       </div>\r\n" +
//                    "   </td>" +
//                    "</tr>\r\n" +
//                "</table>\r\n" +
//                "<div >\r\n" +
//                "   <div class='ibox-title'>\r\n" +
//                "       <h5>" + WebLanguage.GetLanguage(OSiteParam, "Danh sách đơn vị tham gia") + "</h5>\r\n" +
//                "       <button id=\"btnAddChuyenGia\" class=\"btn btn-sm  mr-10px\" onclick=\"AddDonVi()\" style=\"margin-top: -5px; height: 28px; background-color: #e26614;color:white; float:right;\">Thêm</button>\r\n" +
//                "   </div>\r\n" +
//                "   <div id='divDonViList' class='ibox-content' style='position: absolute; top:120px; right:0px; bottom:0px; left:0px; overflow:auto;'>\r\n" +
//                "   </div>\r\n" +
//                "</div>\r\n"
//                    );
//            }
//            catch (Exception ex)
//            {
//                RetAjaxOut.Error = true;
//                RetAjaxOut.InfoMessage = ex.Message.ToString();
//                RetAjaxOut.HtmlContent = ex.Message.ToString();
//            }
//            return RetAjaxOut;
//        }
//        [AjaxPro.AjaxMethod(AjaxPro.HttpSessionStateRequirement.ReadWrite)]
//        public static AjaxOut PopupAddChuyenGia(RenderInfoCls ORenderInfo, string lichhoichanid)
//        {
//            AjaxOut RetAjaxOut = new AjaxOut();
//            try
//            {
//                SiteParam OSiteParam = WebEnvironments.CreateSiteParam(ORenderInfo);
//                WebSession.CheckSessionTimeOut(ORenderInfo);
//                string userId = WebSessionUtility.GetCurrentLoginUser(OSiteParam).OwnerUserId;
//                RetAjaxOut.HtmlContent = WebEnvironments.ProcessHtml(
//                "<table style='width:100%'>\r\n" +
//                    "<tr>\r\n" +
//                    "   <td style='width:30%'>\r\n" +
//                    "       <div class='form-group'>" + WebLanguage.GetLanguage(OSiteParam, "Từ khóa") + "<input id=\"txtKeyword\" placeholder=\"Tìm kiếm theo mã BS, họ tên BS\" class=\"form-control valueForm\" style=\"border-radius: 4px;\"></div>\r\n" +
//                    "   </td>\r\n" +
//                    "   <td style='width:30%'>\r\n" +
//                    "       <div class='form-group'>" + WebLanguage.GetLanguage(OSiteParam, "Chuyên khoa") + "<select id = 'cbbChuyenKhoaFilter'></select></div>\r\n" +
//                    "   </td>\r\n" +
//                    "   <td style='width:10%'>\r\n" +
//                    "       <div class=\"form-group\">\r\n" +
//                    "           <button id=\"btnTimKiem\" class=\"btn btn-sm  mr-10px\" onclick=\"SearchChuyenGia()\" style=\"margin-top: 20px; height: 28px;background-color: #e26614;color:white;\"><strong>Tìm kiếm</strong></button>\r\n" +
//                    "       </div>\r\n" +
//                    "   </td>" +
//                    "</tr>\r\n" +
//                "</table>\r\n" +
//                "<div >\r\n" +
//                "   <div class='ibox-title'>\r\n" +
//                "       <h5>" + WebLanguage.GetLanguage(OSiteParam, "Danh sách đơn vị tham gia") + "</h5>\r\n" +
//                "       <button id=\"btnAddChuyenGia\" class=\"btn btn-sm  mr-10px\" onclick=\"AddChuyenGia()\" style=\"margin-top: -5px; height: 28px; background-color: #e26614;color:white; float:right;\">Thêm</button>\r\n" +
//                "   </div>\r\n" +
//                "   <div id='divChuyenGiaList' class='ibox-content' style='position: absolute; top:120px; right:0px; bottom:0px; left:0px; overflow:auto;'>\r\n" +
//                "   </div>\r\n" +
//                "</div>\r\n"
//                    );
//            }
//            catch (Exception ex)
//            {
//                RetAjaxOut.Error = true;
//                RetAjaxOut.InfoMessage = ex.Message.ToString();
//                RetAjaxOut.HtmlContent = ex.Message.ToString();
//            }
//            return RetAjaxOut;
//        }
//        [AjaxPro.AjaxMethod(AjaxPro.HttpSessionStateRequirement.ReadWrite)]
//        public static AjaxOut DrawCaBenhBelongLichHoiChanList(RenderInfoCls ORenderInfo, string lichHoiChanId)
//        {
//            AjaxOut RetAjaxOut = new AjaxOut();
//            try
//            {
//                SiteParam
//                    OSiteParam = WebEnvironments.CreateSiteParam(ORenderInfo);
//                LichHoiChanCaBenhCls[] lichHoiChanCaBenhs = CallBussinessUtility.CreateBussinessProcess().CreateLichHoiChanProcess().GetLichHoiChanCaBenhs(ORenderInfo, lichHoiChanId);
//                int caBenhTotal = lichHoiChanCaBenhs.Count();
//                string html = "";
//                if (caBenhTotal == 0)
//                {
//                    html += WebScreen.GetPanelInfo(OSiteParam, WebLanguage.GetLanguage(OSiteParam, "Không tìm thấy ca bệnh nào thuộc lịch này"), true);
//                }
//                else
//                {
//                    html +=
//                        "         <div class=\"table-responsive\"> \r\n" +
//                        "             <table class=\"table table-bordered table-hover dataTables-autosort footable-loaded footable\"> \r\n" +
//                        "                 <thead> \r\n" +
//                        "                 <tr> \r\n" +
//                        "                     <th class=\"th-func-20\">STT</th> \r\n" +
//                        "                     <th>" + WebLanguage.GetLanguage(OSiteParam, "Mã BN") + " </th> \r\n" +
//                        "                     <th>" + WebLanguage.GetLanguage(OSiteParam, "Họ tên BN") + " </th> \r\n" +
//                        "                     <th>" + WebLanguage.GetLanguage(OSiteParam, "NS") + " </th> \r\n" +
//                        "                     <th>" + WebLanguage.GetLanguage(OSiteParam, "GT") + " </th> \r\n" +
//                        "                     <th>" + WebLanguage.GetLanguage(OSiteParam, "Chuyên khoa") + " </th> \r\n" +
//                        "                     <th>" + WebLanguage.GetLanguage(OSiteParam, "Chẩn đoán sơ bộ") + " </th> \r\n" +
//                        "                     <th>" + WebLanguage.GetLanguage(OSiteParam, "Đơn vị tham vấn") + " </th> \r\n" +
//                        "                     <th>" + WebLanguage.GetLanguage(OSiteParam, "Trạng thái") + " </th> \r\n" +
//                        "                     <th>" + WebLanguage.GetLanguage(OSiteParam, "Xóa") + " </th> \r\n" +
//                        "                 </tr> \r\n" +
//                        "                 </thead> \r\n" +
//                        "                 <tbody> \r\n";
//                    int sodong = 0;
//                    for (int iIndex = 0; iIndex < caBenhTotal; iIndex++)
//                    {
//                        sodong++;
//                        CaBenhCls caBenh = CallBussinessUtility.CreateBussinessProcess().CreateCaBenhProcess().CreateModel(ORenderInfo, lichHoiChanCaBenhs[iIndex].CABENHID);
//                        OwnerCls donViThamVan = string.IsNullOrEmpty(caBenh.DONVITHAMVANID) ? null : CoreCallBussinessUtility.CreateBussinessProcess().CreateOwnerProcess().CreateModel(ORenderInfo, caBenh.DONVITHAMVANID);
//                        DM_ChuyenKhoaDaoTaoTtCls chuyenKhoa = null;
//                        if (!string.IsNullOrEmpty(caBenh.CHUYENKHOAMA))
//                        {
//                            chuyenKhoa = CallBussinessUtility.CreateBussinessProcess().CreateChuyenKhoaDaoTaoTtProcess().CreateModel(ORenderInfo, caBenh.CHUYENKHOAMA);
//                        }
//                        html +=
//                            "                 <tr> \r\n" +
//                            "                     <td style='text-align: center; vertical-align: middle;'><span class='CssDisplaySttCaBenh'>" + lichHoiChanCaBenhs[iIndex].STT + "</span><input type='number' step='1' style='display:none; text-align: center; width:50px;' class='CssEditorSttCaBenh clsSttCaBenh' id='txtSttCaBenh_" + lichHoiChanCaBenhs[iIndex].CABENHID + "' value='" + lichHoiChanCaBenhs[iIndex].STT + "'></td> \r\n" +
//                            "                     <td style='text-align: center; vertical-align: middle;'>" + caBenh.MABN + "</td> \r\n" +
//                            "                     <td style='vertical-align: middle;'>" + caBenh.HOTENBN + "</td> \r\n" +
//                            "                     <td style='text-align: center; vertical-align: middle;'>" + (caBenh.NGAYSINH != null ? (int?)caBenh.NGAYSINH.Value.Year : null) + "</td> \r\n" +
//                            "                     <td style='text-align: center; vertical-align: middle;'>" + (caBenh.GIOITINH == 1 ? WebLanguage.GetLanguage(OSiteParam, "Nam") : caBenh.GIOITINH == 2 ? WebLanguage.GetLanguage(OSiteParam, "Nữ") : null) + "</td> \r\n" +
//                            "                     <td style='vertical-align: middle;'>" + (chuyenKhoa != null ? chuyenKhoa.Ten : caBenh.CHUYENKHOAMA) + "</td> \r\n" +
//                            "                     <td style='vertical-align: middle;'>" + caBenh.CHANDOANSOBO + "</td> \r\n" +
//                            "                     <td style='vertical-align: middle;'>" + (donViThamVan != null ? donViThamVan.OwnerName : null) + "</td> \r\n" +
//                            "                     <td style='text-align: center; vertical-align: middle;'>" + (caBenh.TRANGTHAI != null ? CaBenhParser.sColorTrangThai[caBenh.TRANGTHAI.Value] : null) + "</td> \r\n" +
//                            "                     <td style='text-align: center; vertical-align: middle;'><a href='javascript:RemoveCaBenh(\"" + caBenh.ID + "\");' title='" + WebLanguage.GetLanguage(OSiteParam, "Xóa ca bệnh khỏi lịch hội chẩn") + "'>" + WebLanguage.GetLanguage(OSiteParam, "Xóa") + "</a></td> \r\n" +
//                            "                 </tr> \r\n";
//                    }
//                    html +=
//                        "                 </tbody> \r\n" +
//                        "             </table> \r\n" +
//                        "       </div>\r\n" +
//                        "<style>\r\n" +
//                        "table th{text-align: center; vertical-align: middle;}\r\n" +
//                        "</style>\r\n"
//                        ;
//                }
//                html = WebEnvironments.ProcessHtml(html);
//                RetAjaxOut.HtmlContent = html;
//            }
//            catch (Exception ex)
//            {
//                RetAjaxOut.Error = true;
//                RetAjaxOut.InfoMessage = ex.Message.ToString();
//                RetAjaxOut.HtmlContent = ex.Message.ToString();
//            }
//            return RetAjaxOut;
//        }

//        [AjaxPro.AjaxMethod(AjaxPro.HttpSessionStateRequirement.ReadWrite)]
//        public static AjaxOut DrawCaBenhSearchResultList(RenderInfoCls ORenderInfo, int PageIndex, string lichHoiChanId, string keyword, string donViThamVan, string chanDoan, string[] CheckedArr)
//        {
//            AjaxOut RetAjaxOut = new AjaxOut();
//            try
//            {
//                SiteParam
//                    OSiteParam = WebEnvironments.CreateSiteParam(ORenderInfo);
//                WebSession.CheckSessionTimeOut(ORenderInfo);
//                string userId = WebSessionUtility.GetCurrentLoginUser(OSiteParam).OwnerUserId;
//                bool lapLichPermission = PermissionUtility.CheckPermission(ORenderInfo, new TuVanCaBenhPermission().PermissionFunctionCode, OneTSQ.Common.TuVanCaBenh.ePermission.LapLich.ToString(), new TuVanCaBenhPermission().PermissionFunctionCode, TuVanCaBenhPermission.StaticPermissionFunctionId, userId);
//                //Quyền dữ liệu
//                //1. Chỉ hiển thị những ca bệnh ở trạng thái chờ lập lịch.
//                //2. 2 đối tượng được xem ca bệnh:
//                //- Người được phân quyền lập lịch thuộc đơn vị tư vấn của ca bệnh.
//                //- Người được phân quyền lập lịch ca bệnh của người khác mà không quan trọng đến ca bệnh.
//                string dataPermissionQuery = string.Format(" and CABENH.TRANGTHAI={3} " +
//                                                           " and ( " +
//                                                                (lapLichPermission ?
//                                                                "  ( " +
//                                                                "       select count(1) " +
//                                                                "       from TableOwnerUserBelongOwner " +
//                                                                "       where frkOwnerUserId='{0}' and frkOwnerId=CABENH.DONVITUVANID " +
//                                                                "  ) > 0 OR " : null) +
//                                                                "  ( " +
//                                                                "        select count(1) " +
//                                                                "        from TablePermissionDataAccess join TablePermissionData on nvl(TablePermissionDataAccess.AllowAccess,0)=1 and TablePermissionData.frkOwnerUserId=CABENH.TAOBOI and PermissionDataId=frkPermissionDataId " +
//                                                                "                                        join TablePermissionFunction on PermissionFunctionId=TablePermissionData.frkPermissionFunctionId " +
//                                                                "                                        join TablePermissionFunctionItem on TablePermissionFunctionItem.frkPermissionFunctionId=PermissionFunctionId and PermissionFunctionItemId=frkPermissionFunctionItemId " +
//                                                                "        where PermissionFunctionCode='{1}' " +
//                                                                "              and PermissionFunctionItemCode='{2}' " +
//                                                                "              and ( " +
//                                                                "                   TablePermissionDataAccess.frkOwnerUserId='{0}' " +//user
//                                                                "                   or TablePermissionDataAccess.frkRoleId in (select frkRoleId from TableOwnerUserBelongRole where frkOwnerUserId='{0}') " +//--role
//                                                                "                   or TablePermissionDataAccess.frkGroupRoleId in " +//GroupRole
//                                                                "                      ( " +
//                                                                "                           select frkGroupRoleId from TableRoleBelongGroupRole " +
//                                                                "                           where frkRoleId in  " +
//                                                                "                               ( " +
//                                                                "                                   select frkRoleId from TableOwnerUserBelongRole  " +
//                                                                "                                   where frkOwnerUserId='{0}'  " +
//                                                                "                               ) " +
//                                                                "                      ) " +
//                                                                "              ) " +
//                                                                "  ) > 0) ", userId,
//                                                                            new TuVanCaBenhPermission().PermissionFunctionCode,
//                                                                            Common.TuVanCaBenh.ePermission.LapLich.ToString(),
//                                                                            (int)CaBenhCls.eTrangThai.ChoLapLich);
//                LichHoiChanCls lichHoiChan = CallBussinessUtility.CreateBussinessProcess().CreateLichHoiChanProcess().CreateModel(ORenderInfo, lichHoiChanId);
//                CaBenhFilterCls filter = new CaBenhFilterCls() { PageIndex = PageIndex, PageSize = 10, KHACLICHHOICHANID = lichHoiChanId, Keyword = keyword, DONVITHAMVANID = donViThamVan, CHANDOANBANDAUMA = chanDoan, DataPermissionQuery = dataPermissionQuery };
//                long recordTotal = 0;
//                CaBenhCls[] caBenhs = CallBussinessUtility.CreateBussinessProcess().CreateCaBenhProcess().PageReading(ORenderInfo, filter, ref recordTotal);
//                ReturnPaging RetPaging = WebPaging.GetPaging((int)recordTotal, filter.PageIndex, filter.PageSize, 10, "NextCaBenhPage");
//                int caBenhTotal = caBenhs.Count();
//                string html = "";
//                if (caBenhTotal == 0)
//                {
//                    html += WebScreen.GetPanelInfo(OSiteParam, "Không tìm thấy ca bệnh nào thỏa mãn điều kiện tìm kiếm.", true);
//                }
//                else
//                {
//                    html +=
//                        "         <div class=\"table-responsive\"> \r\n" +
//                        "             <table class=\"table table-bordered table-hover dataTables-autosort footable-loaded footable\"> \r\n" +
//                        "                 <thead> \r\n" +
//                        "                 <tr> \r\n" +
//                        "                     <th class=\"th-func-20\"><input type =\"checkbox\" class=\"i-checks\" id='ckbAllPage' onclick='ckbAllCaBenhPage_onclick(this)'></th> \r\n" +
//                        "                     <th class=\"th-func-20\">STT</th> \r\n" +
//                        "                     <th>" + WebLanguage.GetLanguage(OSiteParam, "Mã BN") + " </th> \r\n" +
//                        "                     <th>" + WebLanguage.GetLanguage(OSiteParam, "Họ tên BN") + " </th> \r\n" +
//                        "                     <th>" + WebLanguage.GetLanguage(OSiteParam, "NS") + " </th> \r\n" +
//                        "                     <th>" + WebLanguage.GetLanguage(OSiteParam, "GT") + " </th> \r\n" +
//                        "                     <th>" + WebLanguage.GetLanguage(OSiteParam, "Chuyên khoa") + " </th> \r\n" +
//                        "                     <th>" + WebLanguage.GetLanguage(OSiteParam, "Đơn vị tham vấn") + " </th> \r\n" +
//                        "                 </tr> \r\n" +
//                        "                 </thead> \r\n" +
//                        "                 <tbody> \r\n";
//                    for (int iIndex = 0; iIndex < caBenhTotal; iIndex++)
//                    {
//                        OwnerCls oDonViThamVan = string.IsNullOrEmpty(caBenhs[iIndex].DONVITHAMVANID) ? null : CoreCallBussinessUtility.CreateBussinessProcess().CreateOwnerProcess().CreateModel(ORenderInfo, caBenhs[iIndex].DONVITHAMVANID);
//                        DM_ChuyenKhoaDaoTaoTtCls chuyenKhoa = null;
//                        if (!string.IsNullOrEmpty(caBenhs[iIndex].CHUYENKHOAMA))
//                        {
//                            chuyenKhoa = CallBussinessUtility.CreateBussinessProcess().CreateChuyenKhoaDaoTaoTtProcess().CreateModel(ORenderInfo, caBenhs[iIndex].CHUYENKHOAMA);
//                        }
//                        int ArrIndex = CheckedArr.Count() - 1;
//                        while (ArrIndex >= 0 && CheckedArr[ArrIndex] != caBenhs[iIndex].ID)
//                            ArrIndex--;

//                        html +=
//                            "                 <tr> \r\n" +
//                            "                     <td class=\"td-center\" style='text-align: center; vertical-align: middle;'><input type =\"checkbox\" class=\"i-checks clsCkbCaBenh\" id='" + caBenhs[iIndex].ID + "' " + (ArrIndex >= 0 ? "checked" : "") + " onclick='ckbCaBenh_onclick(this)'></td> \r\n" +
//                            "                     <td class=\"td-right\" style='text-align: center; vertical-align: middle;'>" + (filter.PageIndex * filter.PageSize + iIndex + 1).ToString("#,##0") + "</td> \r\n" +
//                            "                     <td style='text-align: center; vertical-align: middle;'>" + caBenhs[iIndex].MABN + "</td> \r\n" +
//                            "                     <td style='vertical-align: middle;'>" + caBenhs[iIndex].HOTENBN + "</td> \r\n" +
//                            "                     <td style='text-align: center; vertical-align: middle;'>" + (caBenhs[iIndex].NGAYSINH != null ? (int?)caBenhs[iIndex].NGAYSINH.Value.Year : null) + "</td> \r\n" +
//                            "                     <td style='text-align: center; vertical-align: middle;'>" + (caBenhs[iIndex].GIOITINH == 1 ? WebLanguage.GetLanguage(OSiteParam, "Nam") : caBenhs[iIndex].GIOITINH == 2 ? WebLanguage.GetLanguage(OSiteParam, "Nữ") : null) + "</td> \r\n" +
//                            "                     <td style='vertical-align: middle;'>" + (chuyenKhoa != null ? chuyenKhoa.Ten : null) + "</td> \r\n" +
//                            "                     <td style='vertical-align: middle;'>" + (oDonViThamVan != null ? oDonViThamVan.OwnerName : null) + "</td> \r\n" +
//                            "                 </tr> \r\n";
//                    }
//                    html +=
//                        "                 </tbody> \r\n" +
//                        "             </table> \r\n" +
//                        "       </div>\r\n" +
//                        "         <div class=\"col-md-12\">\r\n" +
//                        "              <div class=\"col-md-1\" style=\"margin-top:26px;padding-left: 0px;\">\r\n" +
//                        "               <lable>" + WebLanguage.GetLanguage(OSiteParam, "Tổng số") + ": " + (filter.PageIndex * filter.PageSize + caBenhTotal).ToString("#,##0") + "" + "/ " + "" + (int)recordTotal + "</lable>\r\n" +
//                        "              </div>\r\n" +
//                        "             <div class=\"col-md-10\" style=\"margin-top:20px;\">\r\n" +
//                        RetPaging.PagingText +
//                        "             </div>\r\n" +
//                        "         </div>\r\n" +
//                        "<style>\r\n" +
//                        "table th{text-align: center; vertical-align: middle;}\r\n" +
//                        "</style>\r\n"
//                        ;
//                }
//                RetAjaxOut.HtmlContent = WebEnvironments.ProcessHtml(html);
//            }
//            catch (Exception ex)
//            {
//                RetAjaxOut.Error = true;
//                RetAjaxOut.InfoMessage = ex.Message.ToString();
//                RetAjaxOut.HtmlContent = ex.Message.ToString();
//            }
//            return RetAjaxOut;
//        }
//        [AjaxPro.AjaxMethod(AjaxPro.HttpSessionStateRequirement.ReadWrite)]
//        public static string ShowTrangThai(RenderInfoCls ORenderInfo, string lichHoiChanId)
//        {
//            AjaxOut RetAjaxOut = new AjaxOut();
//            try
//            {
//                SiteParam OSiteParam = WebEnvironments.CreateSiteParam(ORenderInfo);
//                WebSession.CheckSessionTimeOut(ORenderInfo);
//                LichHoiChanCls lichHoiChan = CallBussinessUtility.CreateBussinessProcess().CreateLichHoiChanProcess().CreateModel(ORenderInfo, lichHoiChanId);
//                if (lichHoiChan != null)
//                    return LichHoiChanParser.sColorTrangThai[lichHoiChan.TRANGTHAI];
//            }
//            catch (Exception ex)
//            {
//                RetAjaxOut.Error = true;
//                RetAjaxOut.InfoMessage = ex.Message.ToString();
//                RetAjaxOut.HtmlContent = ex.Message.ToString();
//            }
//            return null;
//        }
//        [AjaxPro.AjaxMethod(AjaxPro.HttpSessionStateRequirement.ReadWrite)]
//        public static AjaxOut ServerSideDrawDanhSachCaBenhByLichHoiChanId(RenderInfoCls ORenderInfo, string lichhoichanid)
//        {
//            SiteParam OSiteParam = WebEnvironments.CreateSiteParam(ORenderInfo);
//            AjaxOut RetAjaxOut = new AjaxOut();
//            try
//            {
//                var cabenhs = CallBussinessUtility.CreateBussinessProcess().CreateCaBenhProcess().Reading(ORenderInfo, new CaBenhFilterCls() { LICHHOICHANID = lichhoichanid });
//                string tbody = null;
//                for (int i = 0; i < cabenhs.Length; i++)
//                {
//                    var buidUrl = RetAjaxOut.RetUrl = WebScreen.BuildUrl(OSiteParam, WebSessionUtility.GetCurrentLoginUser(OSiteParam).OwnerCode, "CaBenh", new WebParamCls[] { new WebParamCls("CaBenhId", cabenhs[i].ID) });

//                    string cdravien = "";
//                    if (!string.IsNullOrEmpty(cabenhs[i].CHANDOANBANDAUMA))
//                    {
//                        var XmlCommand = DmProcessWebServiceUtility.Utility.CreateCommand("icd.getten", ORenderInfo, cabenhs[i].CHANDOANBANDAUMA, "");
//                        var ajaxOut = DmProcessWebServiceUtility.Utility.ProcessComand("IcdWsProcessCommand", XmlCommand.XmlData, XmlCommand.XmlDataSchema);
//                        cdravien = ajaxOut.RetExtraParam1 + " (" + cabenhs[i].CHANDOANBANDAUMA + ")";
//                    }
//                    DM_ChuyenKhoaDaoTaoTtCls chuyenKhoa = null;
//                    if (!string.IsNullOrEmpty(cabenhs[i].CHUYENKHOAMA))
//                    {
//                        chuyenKhoa = CallBussinessUtility.CreateBussinessProcess().CreateChuyenKhoaDaoTaoTtProcess().CreateModel(ORenderInfo, cabenhs[i].CHUYENKHOAMA);
//                    }
//                    tbody +=
//                        "    <tr >\r\n" +
//                        "       <td style=\"text-align: center\">\r\n" +
//                        "           <input  style=\"text-align: center;width: 100%;\" type=\"checkbox\" checked onchange=\"changeCaBenh();\" class=\"chkCaBenh laplich-control\"  id=\"chk" + cabenhs[i].ID + "\" value=\"" + cabenhs[i].ID + "\">" +
//                        "       </td>\r\n" +
//                        "       <td style=\"text-align: center\">\r\n" +
//                        "          <a> " + (i + 1).ToString() + "</a>" +
//                        "       </td>\r\n" +
//                        "       <td style=\"text-align: center\">\r\n" +
//                        "          <a> " + cabenhs[i].MABN + "</a>" +
//                        "       </td>\r\n" +
//                        "       <td>\r\n" +
//                        "           " + cabenhs[i].TENBN + "" +
//                        "       </td>\r\n" +
//                        "       <td style=\"text-align: center\">\r\n" +
//                        "           " + (cabenhs[i].GIOITINH == null ? null : Common.BenhNhan.GioiTinhs[cabenhs[i].GIOITINH.Value]) + "" +
//                        "       </td>\r\n" +
//                        "       <td style=\"text-align: center\">\r\n" +
//                        "           <a href=\"" + buidUrl + "\" target=\"_blank\">" + Common.BenhNhan.TinhTuoi(cabenhs[i].NGAYSINH.Value, cabenhs[i].NGAYNHAPVIEN, cabenhs[i].NGAYXUATVIEN) + "</a>" +
//                        "       </td>\r\n" +
//                        "       <td style=\"min-width:100px;text-align: center\">\r\n" +
//                        "           <a href=\"" + buidUrl + "\" target=\"_blank\">" + (chuyenKhoa == null ? null : chuyenKhoa.Ten) + "</a>" +
//                        "       </td>\r\n" +
//                        "       <td style=\"min-width:100px;text-align: center\">\r\n" +
//                        "           <a href=\"" + buidUrl + "\" target=\"_blank\">" + cabenhs[i].NGAYNHAPVIEN.Value.ToString("HH:mm dd/MM/yyyy") + "</a>" +
//                        "       </td>\r\n" +
//                        "       <td style=\"min-width:100px;text-align: center\">\r\n" +
//                        "           <a href=\"" + buidUrl + "\" target=\"_blank\">" + cabenhs[i].NGAYXUATVIEN.Value.ToString("HH:mm dd/MM/yyyy") + "</a>" +
//                        "       </td>\r\n" +
//                        "       <td>\r\n" +
//                        "           " + cdravien + "" +
//                        "       </td>\r\n" +
//                        "    </tr>\r\n";
//                }
//                string Html =
//                    "<table class=\"table table-bordered table-hover\" id=\"tblBenhAn\">\r\n" +
//                    "    <thead>\r\n" +
//                    "    <tr>\r\n" +
//                    "        <th style=\"text-align:center; vertical-align: middle;\"><input type=\"checkbox\" onchange=\"checkAllBenhAn(this);\" id=\"chkAllBenhAn\" class=\"laplich-control\" checked></th>\r\n" +
//                    "        <th style=\"text-align:center; vertical-align: middle;\">" + WebLanguage.GetLanguage(OSiteParam, "STT") + "</th>\r\n" +
//                    "        <th style=\"text-align: center; vertical-align: middle;\">" + WebLanguage.GetLanguage(OSiteParam, "Mã bệnh án") + "</th>\r\n" +
//                    "        <th style=\"text-align: center; vertical-align: middle;\">" + WebLanguage.GetLanguage(OSiteParam, "Mã bệnh nhân") + "</th>\r\n" +
//                    "        <th style=\"min-width:150px;text-align: center; vertical-align: middle;\">" + WebLanguage.GetLanguage(OSiteParam, "Họ tên") + "</th>\r\n" +
//                    "        <th style=\"text-align: center; vertical-align: middle;\">" + WebLanguage.GetLanguage(OSiteParam, "GT") + "</th>\r\n" +
//                    "        <th style=\"text-align: center; vertical-align: middle;\">" + WebLanguage.GetLanguage(OSiteParam, "Tuổi") + "</th>\r\n" +
//                    "        <th style=\"text-align: center; vertical-align: middle;\">" + WebLanguage.GetLanguage(OSiteParam, "Chuyên khoa") + "</th>\r\n" +
//                    "        <th style=\"min-width:100px;text-align: center; vertical-align: middle;\">" + WebLanguage.GetLanguage(OSiteParam, "Thời gian vào") + "</th>\r\n" +
//                    "        <th style=\"min-width:100px;text-align: center; vertical-align: middle;\">" + WebLanguage.GetLanguage(OSiteParam, "Thời gian ra") + "</th>\r\n" +
//                    "        <th style=\"min-width:100px;text-align: center; vertical-align: middle;\">" + WebLanguage.GetLanguage(OSiteParam, "Chẩn đoán ra viện") + "</th>\r\n" +
//                    "    </tr>\r\n" +
//                    "    </thead>\r\n" +
//                    "    <tbody>\r\n" +
//                    tbody +
//                    "    </tbody>\r\n" +
//                    "</table>\r\n";
//                RetAjaxOut.RetObject = cabenhs;
//                RetAjaxOut.JsonData = JsonConvert.SerializeObject(cabenhs);
//                RetAjaxOut.HtmlContent = WebEnvironments.ProcessHtml(Html);
//            }
//            catch (Exception ex)
//            {
//                RetAjaxOut.Error = true;
//                RetAjaxOut.InfoMessage = ex.Message.ToString();
//                RetAjaxOut.HtmlContent = ex.Message.ToString();
//            }
//            return RetAjaxOut;
//        }
//        [AjaxPro.AjaxMethod(AjaxPro.HttpSessionStateRequirement.ReadWrite)]
//        public static AjaxOut ServerSideDrawDanhSachCaBenh(RenderInfoCls ORenderInfo, string donvihanhchinhid, string tungay, string denngay)
//        {
//            SiteParam OSiteParam = WebEnvironments.CreateSiteParam(ORenderInfo);
//            AjaxOut RetAjaxOut = new AjaxOut();
//            try
//            {
//                CaBenhFilterCls cabenhfilter = new CaBenhFilterCls()
//                {
//                    // DONVIHANHCHINH_ID = donvihanhchinhid,
//                    TUNGAY = DateTime.ParseExact(tungay, new string[] { "dd/MM/yyyy", "yyyy-MM-dd", "dd/MM/yyyy HH:mm:ss", "yyyy-MM-dd HH:mm:ss", "dd/MM/yyyy HH:mm", "HH:mm dd/MM/yyyy", "yyyy-MM-ddTHH:mm" }, CultureInfo.InvariantCulture, DateTimeStyles.None),
//                    DENNGAY = DateTime.ParseExact(denngay, new string[] { "dd/MM/yyyy", "yyyy-MM-dd", "dd/MM/yyyy HH:mm:ss", "yyyy-MM-dd HH:mm:ss", "dd/MM/yyyy HH:mm", "HH:mm dd/MM/yyyy", "yyyy-MM-ddTHH:mm" }, CultureInfo.InvariantCulture, DateTimeStyles.None)
//                };
//                var cabenhs = CallBussinessUtility.CreateBussinessProcess().CreateCaBenhProcess().Reading(ORenderInfo, cabenhfilter);
//                string tbody = null;
//                string Html = "";
//                if (cabenhs.Length == 0)
//                {
//                    Html =
//                   "<table class=\"table table-bordered table-hover\" id=\"tblBenhAn\">\r\n" +
//                   "    <thead>\r\n" +
//                   "    <tr>\r\n" +
//                   "        <th style=\"text-align: center; vertical-align: middle;\">" + WebLanguage.GetLanguage(OSiteParam, "Chọn") + "</th>\r\n" +
//                   "        <th style=\"text-align: center; vertical-align: middle;\">" + WebLanguage.GetLanguage(OSiteParam, "STT") + "</th>\r\n" +
//                   "        <th style=\"min-width:100px;text-align: center; vertical-align: middle;\">" + WebLanguage.GetLanguage(OSiteParam, "Mã bệnh án") + "</th>\r\n" +
//                   "        <th style=\"min-width:60px;text-align: center; vertical-align: middle;\">" + WebLanguage.GetLanguage(OSiteParam, "Mã bệnh nhân") + "</th>\r\n" +
//                   "        <th style=\"min-width:150px;text-align: center; vertical-align: middle;\">" + WebLanguage.GetLanguage(OSiteParam, "Họ tên") + "</th>\r\n" +
//                   "        <th style=\"text-align: center; vertical-align: middle;\">" + WebLanguage.GetLanguage(OSiteParam, "GT") + "</th>\r\n" +
//                   "        <th style=\"text-align: center; vertical-align: middle;\">" + WebLanguage.GetLanguage(OSiteParam, "Tuổi") + "</th>\r\n" +
//                   "        <th style=\"text-align: center; vertical-align: middle;\">" + WebLanguage.GetLanguage(OSiteParam, "Chuyên khoa") + "</th>\r\n" +
//                   "        <th style=\"min-width:100px;text-align: center; vertical-align: middle;\">" + WebLanguage.GetLanguage(OSiteParam, "Thời gian vào") + "</th>\r\n" +
//                   "        <th style=\"min-width:100px;text-align: center; vertical-align: middle;\">" + WebLanguage.GetLanguage(OSiteParam, "Thời gian ra") + "</th>\r\n" +
//                   "        <th style=\"min-width:100px;text-align: center; vertical-align: middle;\">" + WebLanguage.GetLanguage(OSiteParam, "Chẩn đoán ra viện") + "</th>\r\n" +
//                   "    </tr>\r\n" +
//                   "    </thead>\r\n" +
//                   "    <tbody>\r\n" +
//                   tbody +
//                   "    </tbody>\r\n" +
//                   "</table>\r\n";
//                    RetAjaxOut.RetBoolean = false;
//                }
//                else
//                {
//                    RetAjaxOut.RetBoolean = true;
//                    for (int i = 0; i < cabenhs.Length; i++)
//                    {
//                        var buidUrl = RetAjaxOut.RetUrl = WebScreen.BuildUrl(OSiteParam, WebSessionUtility.GetCurrentLoginUser(OSiteParam).OwnerCode, "cabenh", new WebParamCls[] { new WebParamCls("CaBenhId", cabenhs[i].ID) });
//                        string cdravien = "";
//                        if (!string.IsNullOrEmpty(cabenhs[i].CHANDOANBANDAUMA))
//                        {
//                            var XmlCommand = DmProcessWebServiceUtility.Utility.CreateCommand("icd.getten", ORenderInfo, cabenhs[i].CHANDOANBANDAUMA, "");
//                            var ajaxOut = DmProcessWebServiceUtility.Utility.ProcessComand("IcdWsProcessCommand", XmlCommand.XmlData, XmlCommand.XmlDataSchema);
//                            cdravien = ajaxOut.RetExtraParam1 + " (" + cabenhs[i].CHANDOANBANDAUMA + ")";
//                        }
//                        DM_ChuyenKhoaDaoTaoTtCls chuyenKhoa = null;
//                        if (!string.IsNullOrEmpty(cabenhs[i].CHUYENKHOAMA))
//                        {
//                            chuyenKhoa = CallBussinessUtility.CreateBussinessProcess().CreateChuyenKhoaDaoTaoTtProcess().CreateModel(ORenderInfo, cabenhs[i].CHUYENKHOAMA);
//                        }

//                        tbody +=
//                            "    <tr >\r\n" +
//                            "       <td style=\"text-align: center\">\r\n" +
//                            "           <input style=\"text-align: center;width: 100%;\" type=\"checkbox\" checked onchange=\"changeBenhAn();\" class=\"chkBenhAn laplich-control\"  id=\"chk" + cabenhs[i].ID + "\" value=\"" + cabenhs[i].ID + "\">" +
//                            "       </td>\r\n" +
//                            "       <td style=\"text-align: center\">\r\n" +
//                            "          <a> " + (i + 1).ToString() + "</a>" +
//                            "       </td>\r\n" +
//                            "       <td style=\"min-width:60px;text-align: center\">\r\n" +
//                            "          <a> " + cabenhs[i].MABN + "</a>" +
//                            "       </td>\r\n" +
//                            "       <td>\r\n" +
//                            "           " + cabenhs[i].TENBN + "" +
//                            "       </td>\r\n" +
//                            "       <td style=\"text-align: center\">\r\n" +
//                            "           " + (cabenhs[i].GIOITINH == null ? null : Common.BenhNhan.GioiTinhs[cabenhs[i].GIOITINH.Value]) + "" +
//                            "       </td>\r\n" +
//                            "       <td style=\"text-align: center\">\r\n" +
//                            "           <a href=\"" + buidUrl + "\" target=\"_blank\">" + Common.BenhNhan.TinhTuoi(cabenhs[i].NGAYSINH.Value, cabenhs[i].NGAYNHAPVIEN, cabenhs[i].NGAYXUATVIEN) + "</a>" +
//                            "       </td>\r\n" +
//                            "       <td style=\"min-width:100px;text-align: center\">\r\n" +
//                            "           <a href=\"" + buidUrl + "\" target=\"_blank\">" + (chuyenKhoa == null ? null : chuyenKhoa.Ten) + "</a>" +
//                            "       </td>\r\n" +
//                            "       <td style=\"min-width:100px;text-align: center\">\r\n" +
//                            "           <a href=\"" + buidUrl + "\" target=\"_blank\">" + cabenhs[i].NGAYNHAPVIEN.Value.ToString("HH:mm dd/MM/yyyy") + "</a>" +
//                            "       </td>\r\n" +
//                            "       <td style=\"min-width:100px;text-align: center\">\r\n" +
//                            "           <a href=\"" + buidUrl + "\" target=\"_blank\">" + cabenhs[i].NGAYXUATVIEN.Value.ToString("HH:mm dd/MM/yyyy") + "</a>" +
//                            "       </td>\r\n" +
//                            "       <td>\r\n" +
//                            "           " + cdravien + "" +
//                            "       </td>\r\n" +
//                            "    </tr>\r\n";
//                    }
//                    Html =
//                        "<table class=\"table table-bordered table-hover\" id=\"tblBenhAn\">\r\n" +
//                        "    <thead>\r\n" +
//                        "    <tr>\r\n" +
//                        "        <th style=\"text-align: center; vertical-align: middle;\"><input type=\"checkbox\" onchange=\"checkAllBenhAn(this);\" id=\"chkAllBenhAn\" checked></th>\r\n" +
//                        "        <th style=\"text-align: center; vertical-align: middle;\">" + WebLanguage.GetLanguage(OSiteParam, "STT") + "</th>\r\n" +
//                        "        <th style=\"min-width:100px;text-align: center; vertical-align: middle;\">" + WebLanguage.GetLanguage(OSiteParam, "Mã bệnh án") + "</th>\r\n" +
//                        "        <th style=\"min-width:60px;text-align: center; vertical-align: middle;\">" + WebLanguage.GetLanguage(OSiteParam, "Mã bệnh nhân") + "</th>\r\n" +
//                        "        <th style=\"min-width:150px;text-align: center; vertical-align: middle;\">" + WebLanguage.GetLanguage(OSiteParam, "Họ tên") + "</th>\r\n" +
//                        "        <th style=\"text-align: center; vertical-align: middle;\">" + WebLanguage.GetLanguage(OSiteParam, "GT") + "</th>\r\n" +
//                        "        <th style=\"text-align: center; vertical-align: middle;\">" + WebLanguage.GetLanguage(OSiteParam, "Tuổi") + "</th>\r\n" +
//                        "        <th style=\"min-width:100px;text-align: center; vertical-align: middle;\">" + WebLanguage.GetLanguage(OSiteParam, "Thời gian vào") + "</th>\r\n" +
//                        "        <th style=\"min-width:100px;text-align: center; vertical-align: middle;\">" + WebLanguage.GetLanguage(OSiteParam, "Thời gian ra") + "</th>\r\n" +
//                        "        <th style=\"min-width:100px;text-align: center; vertical-align: middle;\">" + WebLanguage.GetLanguage(OSiteParam, "Chẩn đoán ra viện") + "</th>\r\n" +
//                        "    </tr>\r\n" +
//                        "    </thead>\r\n" +
//                        "    <tbody>\r\n" +
//                        tbody +
//                        "    </tbody>\r\n" +
//                        "</table>\r\n";
//                }
//                RetAjaxOut.HtmlContent = WebEnvironments.ProcessHtml(Html);
//            }
//            catch (Exception ex)
//            {
//                RetAjaxOut.Error = true;
//                RetAjaxOut.InfoMessage = ex.Message.ToString();
//                RetAjaxOut.HtmlContent = ex.Message.ToString();
//            }
//            return RetAjaxOut;
//        }

//        [AjaxPro.AjaxMethod(AjaxPro.HttpSessionStateRequirement.ReadWrite)]
//        public static AjaxOut GetCaBenhUrl(RenderInfoCls ORenderInfo, string lichHoiChanId)
//        {
//            AjaxOut RetAjaxOut = new AjaxOut();
//            try
//            {
//                SiteParam
//                    OSiteParam = WebEnvironments.CreateSiteParam(ORenderInfo);
//                var user = WebSessionUtility.GetCurrentLoginUser(OSiteParam);
//                LichHoiChanCaBenhCls[] lichHoiChanCaBenhs = CallBussinessUtility.CreateBussinessProcess().CreateLichHoiChanProcess().GetLichHoiChanCaBenhs(ORenderInfo, lichHoiChanId);
//                var caBenhUrl = lichHoiChanCaBenhs.Count() == 0 ? WebScreen.BuildUrl(OSiteParam, user.OwnerCode, "lichhoichan", new WebParamCls[] { new WebParamCls("lichhoichanid", lichHoiChanId) }) :
//                    WebScreen.BuildUrl(OSiteParam, WebSessionUtility.GetCurrentLoginUser(OSiteParam).OwnerCode, "CaBenh", new WebParamCls[] {
//                            new WebParamCls("LichHoiChanId", lichHoiChanId),
//                            new WebParamCls("CaBenhId", lichHoiChanCaBenhs[0].CABENHID),
//                            new WebParamCls("RecordTotal", lichHoiChanCaBenhs.Count()),
//                            new WebParamCls("ChiSoMang", 0),
//                            new WebParamCls("Keyword", null),
//                            new WebParamCls("CskcbYeuCau", null),
//                            new WebParamCls("ChuyenKhoa", null),
//                            new WebParamCls("LoaiThoiGian", 0),
//                            new WebParamCls("TuNgay", null),
//                            new WebParamCls("DenNgay", null),
//                            new WebParamCls("TrangThai", -1)});
//                RetAjaxOut.RetUrl = caBenhUrl;
//            }
//            catch (Exception ex)
//            {
//                RetAjaxOut.Error = true;
//                RetAjaxOut.InfoMessage = ex.Message.ToString();
//                RetAjaxOut.HtmlContent = ex.Message.ToString();
//            }
//            return RetAjaxOut;
//        }
//        [AjaxPro.AjaxMethod(AjaxPro.HttpSessionStateRequirement.ReadWrite)]
//        public static AjaxOut PopupAddCaBenh(RenderInfoCls ORenderInfo, string lichhoichanid)
//        {
//            AjaxOut RetAjaxOut = new AjaxOut();
//            try
//            {
//                SiteParam OSiteParam = WebEnvironments.CreateSiteParam(ORenderInfo);
//                WebSession.CheckSessionTimeOut(ORenderInfo);
//                string userId = WebSessionUtility.GetCurrentLoginUser(OSiteParam).OwnerUserId;
//                //bool lapLichPermission = PermissionUtility.CheckPermission(ORenderInfo, new TuVanCaBenhPermission().PermissionFunctionCode, OneTSQ.Common.TuVanCaBenh.ePermission.LapLich.ToString(), new TuVanCaBenhPermission().PermissionFunctionCode, TuVanCaBenhPermission.StaticPermissionFunctionId, userId);
//                string keyword = null;
//                string cskcbYeuCau = null;
//                string chanDoanMa = null;
//                string cbbDonViThamVan = "<select id = 'cbbDonViThamVan' required>\r\n";
//                if (!string.IsNullOrEmpty(cskcbYeuCau))
//                {
//                    OwnerCls donViThamVan = CoreCallBussinessUtility.CreateBussinessProcess().CreateOwnerProcess().CreateModel(ORenderInfo, cskcbYeuCau);
//                    if (donViThamVan != null)
//                        cbbDonViThamVan += string.Format("<option value={0}>{1} - {2}</option>\r\n", donViThamVan.OwnerId, donViThamVan.OwnerCode, donViThamVan.OwnerName);
//                }
//                cbbDonViThamVan += "</select>\r\n";

//                string cbbChanDoan = "<select id = 'cbbChanDoan'>\r\n";
//                if (!string.IsNullOrEmpty(chanDoanMa))
//                {
//                    XmlCls XmlCommand = DmProcessWebServiceUtility.Utility.CreateCommand("icd.createmodel", ORenderInfo, chanDoanMa, "");
//                    var ajaxOut = DmProcessWebServiceUtility.Utility.ProcessComand("IcdWsProcessCommand", XmlCommand.XmlData, XmlCommand.XmlDataSchema);
//                    var chanDoan = IcdParser.ParseFromXml(ajaxOut.XmlDataResult, ajaxOut.XmlDataResultSchema);
//                    if (chanDoan != null)
//                        cbbChanDoan += string.Format("<option value={0}>{0} - {1}</option>\r\n", chanDoan.Ma, chanDoan.Ten);
//                    else
//                        cbbChanDoan += string.Format("<option value={0}>{0}</option>\r\n", chanDoanMa);
//                }
//                cbbChanDoan += "</select>\r\n";

//                RetAjaxOut.HtmlContent = WebEnvironments.ProcessHtml(
//                "<table style='width:100%'>\r\n" +
//                    "<tr>\r\n" +
//                    "   <td style='width:30%'>\r\n" +
//                    "       <div class='form-group'>" + WebLanguage.GetLanguage(OSiteParam, "Từ khóa") + "<input id=\"txtKeyword\" value='" + keyword + "' placeholder=\"Tìm kiếm theo mã BN, họ tên BN\" class=\"form-control valueForm\" style=\"border-radius: 4px;\"></div>\r\n" +
//                    "   </td>\r\n" +
//                    "   <td style='width:30%'>\r\n" +
//                    "       <div class='form-group'>" + WebLanguage.GetLanguage(OSiteParam, "Đơn vị tham vấn") + cbbDonViThamVan + "</div>\r\n" +
//                    "   </td>\r\n" +
//                    "   <td style='width:30%'>\r\n" +
//                    "       <div class='form-group'>" + WebLanguage.GetLanguage(OSiteParam, "Chẩn đoán") + cbbChanDoan + "</div>\r\n" +
//                    "   </td>\r\n" +
//                    "   <td style='width:10%'>\r\n" +
//                    "       <div class=\"form-group\">\r\n" +
//                    "           <button id=\"btnTimKiem\" class=\"btn btn-sm  mr-10px\" onclick=\"SearchCaBenh()\" style=\"margin-top: 20px; height: 28px;background-color: #e26614;color:white;\"><strong>Tìm kiếm</strong></button>\r\n" +
//                    "       </div>\r\n" +
//                    "   </td>" +
//                    "</tr>\r\n" +
//                "</table>\r\n" +
//                "<div >\r\n" +
//                "   <div class='ibox-title'>\r\n" +
//                "       <h5>" + WebLanguage.GetLanguage(OSiteParam, "Danh sách ca bệnh") + "</h5>\r\n" +
//                "       <button id=\"btnAddCaBenh\" class=\"btn btn-sm  mr-10px\" onclick=\"AddCaBenh()\" style=\"margin-top: -5px; height: 28px; background-color: #e26614;color:white; float:right;\">Thêm</button>\r\n" +
//                "   </div>\r\n" +
//                "   <div id='divCaBenhList' class='ibox-content' style='position: absolute; top:120px; right:0px; bottom:0px; left:0px; overflow:auto;'>\r\n" +
//                //DrawCaBenhSearchResultList(ORenderInfo,int PageIndex, string keyWork,string donViThamVan,string chuyenKhoa,string chanDoan,int? trangThai).HtmlContent +
//                "   </div>\r\n" +
//                "</div>\r\n"
//                    );
//            }
//            catch (Exception ex)
//            {
//                RetAjaxOut.Error = true;
//                RetAjaxOut.InfoMessage = ex.Message.ToString();
//                RetAjaxOut.HtmlContent = ex.Message.ToString();
//            }
//            return RetAjaxOut;
//        }
//        [AjaxPro.AjaxMethod(AjaxPro.HttpSessionStateRequirement.ReadWrite)]
//        public static AjaxOut ServerSideGetLichHoiChanById(RenderInfoCls ORenderInfo, string lichhoichanid)
//        {
//            SiteParam OSiteParam = WebEnvironments.CreateSiteParam(ORenderInfo);
//            AjaxOut RetAjaxOut = new AjaxOut();
//            try
//            {
//                var lichhoichan = CallBussinessUtility.CreateBussinessProcess().CreateLichHoiChanProcess().CreateModel(ORenderInfo, lichhoichanid);
//                LichHoiChanOpenCls lichhoichanopen = new LichHoiChanOpenCls();
//                lichhoichanopen.lichhoichan = lichhoichan;
//                if (!string.IsNullOrEmpty(lichhoichan.TAOBOI))
//                {
//                    OwnerUserCls nguoitao = CoreCallBussinessUtility.CreateBussinessProcess().CreateOwnerUserProcess().CreateModel(ORenderInfo, lichhoichan.TAOBOI);
//                    if (nguoitao != null)
//                        lichhoichanopen.optionNguoiTao_ID = "<option value=\"" + nguoitao.OwnerUserId + "\" selected>" + nguoitao.FullName + "</option>";
//                }
//                if (!string.IsNullOrEmpty(lichhoichan.DUYETBOI))
//                {
//                    OwnerUserCls nguoiduyet = CoreCallBussinessUtility.CreateBussinessProcess().CreateOwnerUserProcess().CreateModel(ORenderInfo, lichhoichan.DUYETBOI);
//                    if (nguoiduyet != null)
//                        lichhoichanopen.optionNguoiDuyet_ID = "<option value=\"" + nguoiduyet.OwnerUserId + "\" selected>" + nguoiduyet.FullName + "</option>";
//                }
//                if (!string.IsNullOrEmpty(lichhoichan.THUKY))
//                {
//                    BacSyCls thuky = CallBussinessUtility.CreateBussinessProcess().CreateBacSyProcess().CreateModel(ORenderInfo, lichhoichan.THUKY);
//                    if (thuky != null)
//                        lichhoichanopen.optionThuKy_ID = "<option value=\"" + thuky.ID + "\" selected>" + thuky.HOTEN + "</option>";
//                }
//                if (!string.IsNullOrEmpty(lichhoichan.CHUTRI))
//                {
//                    BacSyCls chutri = CallBussinessUtility.CreateBussinessProcess().CreateBacSyProcess().CreateModel(ORenderInfo, lichhoichan.CHUTRI);
//                    if (chutri != null)
//                        lichhoichanopen.optionChuTri_ID = "<option value=\"" + chutri.ID + "\" selected>" + chutri.HOTEN + "</option>";
//                }
//                if (!string.IsNullOrEmpty(lichhoichan.CHUYENKHOAMA))
//                {
//                    var chuyenKhoa = CallBussinessUtility.CreateBussinessProcess().CreateChuyenKhoaDaoTaoTtProcess().CreateModel(ORenderInfo, lichhoichan.CHUYENKHOAMA);
//                    if (chuyenKhoa != null)
//                        lichhoichanopen.optionChuyenKhoaMa = "<option value=\"" + chuyenKhoa.Ma + "\" selected>" + chuyenKhoa.Ten + "</option>";
//                }
//                lichhoichanopen.ThoiGianTao = lichhoichan.TAOVAO.ToString("HH:mm dd/MM/yyyy");
//                lichhoichanopen.BatDau = lichhoichan.BATDAU != null ? lichhoichan.BATDAU.Value.ToString("HH:mm dd/MM/yyyy") : "";
//                lichhoichanopen.KetThuc = lichhoichan.KETTHUC != null ? lichhoichan.KETTHUC.Value.ToString("HH:mm dd/MM/yyyy") : "";
//                lichhoichanopen.ThoiGianDuyet = lichhoichan.DUYETVAO != null ? lichhoichan.DUYETVAO.Value.ToString("HH:mm dd/MM/yyyy") : "";
//                lichhoichanopen.DiaDiem = lichhoichan.DIADIEM;
//                lichhoichanopen.GhiChu = lichhoichan.GHICHU;
//                RetAjaxOut.RetObject = lichhoichanopen;
//            }
//            catch (Exception ex)
//            {
//                RetAjaxOut.Error = true;
//                RetAjaxOut.InfoMessage = ex.Message.ToString();
//                RetAjaxOut.HtmlContent = ex.Message.ToString();
//            }
//            return RetAjaxOut;
//        }
//        [AjaxPro.AjaxMethod(AjaxPro.HttpSessionStateRequirement.ReadWrite)]
//        public static AjaxOut ServerSideGetCaBenhByLichHoiChanId(RenderInfoCls ORenderInfo, string lichhoichanid)
//        {
//            SiteParam OSiteParam = WebEnvironments.CreateSiteParam(ORenderInfo);
//            AjaxOut RetAjaxOut = new AjaxOut();
//            try
//            {
//                if (string.IsNullOrEmpty(lichhoichanid))
//                {
//                    var cabenhs = CallBussinessUtility.CreateBussinessProcess().CreateCaBenhProcess().Reading(ORenderInfo, new CaBenhFilterCls());
//                    RetAjaxOut.JsonData = JsonConvert.SerializeObject(cabenhs);
//                    RetAjaxOut.RetObject = cabenhs;
//                }
//            }
//            catch (Exception ex)
//            {
//                RetAjaxOut.Error = true;
//                RetAjaxOut.InfoMessage = ex.Message.ToString();
//                RetAjaxOut.HtmlContent = ex.Message.ToString();
//            }
//            return RetAjaxOut;
//        }
//        [AjaxPro.AjaxMethod(AjaxPro.HttpSessionStateRequirement.ReadWrite)]
//        public static AjaxOut ServerSideChuyenDuyetLichHoiChan(RenderInfoCls ORenderInfo, string lichhoichanid)
//        {
//            SiteParam OSiteParam = WebEnvironments.CreateSiteParam(ORenderInfo);
//            AjaxOut RetAjaxOut = new AjaxOut();
//            try
//            {
//                if (!string.IsNullOrEmpty(lichhoichanid))
//                {
//                    var lichhoichan = CallBussinessUtility.CreateBussinessProcess().CreateLichHoiChanProcess().CreateModel(ORenderInfo, lichhoichanid);
//                    if (lichhoichan.TRANGTHAI == (int)LichHoiChanCls.eTrangThai.Moi)
//                    {
//                        lichhoichan.TRANGTHAI = (int)LichHoiChanCls.eTrangThai.ChoDuyet;
//                        CallBussinessUtility.CreateBussinessProcess().CreateLichHoiChanProcess().Save(ORenderInfo, lichhoichanid, lichhoichan);
//                    }
//                }
//            }
//            catch (Exception ex)
//            {
//                RetAjaxOut.Error = true;
//                RetAjaxOut.InfoMessage = ex.Message.ToString();
//                RetAjaxOut.HtmlContent = ex.Message.ToString();
//            }
//            return RetAjaxOut;
//        }
//        [AjaxPro.AjaxMethod(AjaxPro.HttpSessionStateRequirement.ReadWrite)]
//        public static AjaxOut ServerSideDuyetLichHoiChan(RenderInfoCls ORenderInfo, string lichhoichanid)
//        {
//            SiteParam OSiteParam = WebEnvironments.CreateSiteParam(ORenderInfo);
//            AjaxOut RetAjaxOut = new AjaxOut();
//            try
//            {
//                if (!string.IsNullOrEmpty(lichhoichanid))
//                {
//                    var lichhoichan = CallBussinessUtility.CreateBussinessProcess().CreateLichHoiChanProcess().CreateModel(ORenderInfo, lichhoichanid);
//                    if (lichhoichan.TRANGTHAI == (int)LichHoiChanCls.eTrangThai.ChoDuyet)
//                    {
//                        lichhoichan.TRANGTHAI = (int)LichHoiChanCls.eTrangThai.DaDuyet;
//                        CallBussinessUtility.CreateBussinessProcess().CreateLichHoiChanProcess().Save(ORenderInfo, lichhoichanid, lichhoichan);
//                    }

//                }
//            }
//            catch (Exception ex)
//            {
//                RetAjaxOut.Error = true;
//                RetAjaxOut.InfoMessage = ex.Message.ToString();
//                RetAjaxOut.HtmlContent = ex.Message.ToString();
//            }
//            return RetAjaxOut;
//        }
//        [AjaxPro.AjaxMethod(AjaxPro.HttpSessionStateRequirement.ReadWrite)]
//        public static AjaxOut ServerSideThuHoiDuyet(RenderInfoCls ORenderInfo, string lichhoichanid)
//        {
//            SiteParam OSiteParam = WebEnvironments.CreateSiteParam(ORenderInfo);
//            AjaxOut RetAjaxOut = new AjaxOut();
//            try
//            {
//                if (!string.IsNullOrEmpty(lichhoichanid))
//                {
//                    var lichhoichan = CallBussinessUtility.CreateBussinessProcess().CreateLichHoiChanProcess().CreateModel(ORenderInfo, lichhoichanid);
//                    if (lichhoichan.TRANGTHAI == (int)LichHoiChanCls.eTrangThai.DaDuyet)
//                    {
//                        lichhoichan.TRANGTHAI = (int)LichHoiChanCls.eTrangThai.ChoDuyet;
//                        CallBussinessUtility.CreateBussinessProcess().CreateLichHoiChanProcess().Save(ORenderInfo, lichhoichanid, lichhoichan);
//                    }

//                }
//            }
//            catch (Exception ex)
//            {
//                RetAjaxOut.Error = true;
//                RetAjaxOut.InfoMessage = ex.Message.ToString();
//                RetAjaxOut.HtmlContent = ex.Message.ToString();
//            }
//            return RetAjaxOut;
//        }
//        [AjaxPro.AjaxMethod(AjaxPro.HttpSessionStateRequirement.ReadWrite)]
//        public static AjaxOut ServerSideThuHoiChuyenDuyet(RenderInfoCls ORenderInfo, string lichhoichanid)
//        {
//            SiteParam OSiteParam = WebEnvironments.CreateSiteParam(ORenderInfo);
//            AjaxOut RetAjaxOut = new AjaxOut();
//            try
//            {
//                if (!string.IsNullOrEmpty(lichhoichanid))
//                {
//                    var lichhoichan = CallBussinessUtility.CreateBussinessProcess().CreateLichHoiChanProcess().CreateModel(ORenderInfo, lichhoichanid);
//                    if (lichhoichan.TRANGTHAI == (int)LichHoiChanCls.eTrangThai.ChoDuyet)
//                    {
//                        //CallBussinessUtility.CreateBussinessProcess().CreateTongHopLuuTruProcess().UpDateTrangThai(ORenderInfo, tonghopluutruid, (int)LichHoiChanCls.eTrangThai.Moi);
//                        //CallBussinessUtility.CreateBussinessProcess().CreateBenhAnProcess().UpdateTrangThaiByTongHopLuuTruID(ORenderInfo, tonghopluutruid, (int)BenhAnCls.eTrangThai.ChoCapSo);
//                    }
//                }
//            }
//            catch (Exception ex)
//            {
//                RetAjaxOut.Error = true;
//                RetAjaxOut.InfoMessage = ex.Message.ToString();
//                RetAjaxOut.HtmlContent = ex.Message.ToString();
//            }
//            return RetAjaxOut;
//        }
//        [AjaxPro.AjaxMethod(AjaxPro.HttpSessionStateRequirement.ReadWrite)]
//        public static AjaxOut ServerSideHoanTat(RenderInfoCls ORenderInfo, string lichhoichanid)
//        {
//            SiteParam OSiteParam = WebEnvironments.CreateSiteParam(ORenderInfo);
//            AjaxOut RetAjaxOut = new AjaxOut();
//            try
//            {
//                if (!string.IsNullOrEmpty(lichhoichanid))
//                {
//                    var lichhoichan = CallBussinessUtility.CreateBussinessProcess().CreateLichHoiChanProcess().CreateModel(ORenderInfo, lichhoichanid);
//                    if (lichhoichan.TRANGTHAI == (int)LichHoiChanCls.eTrangThai.DaDuyet)
//                    {
//                        //CallBussinessUtility.CreateBussinessProcess().CreateTongHopLuuTruProcess().UpDateTrangThai(ORenderInfo, tonghopluutruid, (int)LichHoiChanCls.eTrangThai.HoanTat);
//                        //CallBussinessUtility.CreateBussinessProcess().CreateBenhAnProcess().UpdateTrangThaiByTongHopLuuTruID(ORenderInfo, tonghopluutruid, (int)BenhAnCls.eTrangThai.DaCapSo);
//                    }
//                    RetAjaxOut.JsonData = JsonConvert.SerializeObject(lichhoichan);
//                    RetAjaxOut.RetObject = lichhoichan;
//                }
//            }
//            catch (Exception ex)
//            {
//                RetAjaxOut.Error = true;
//                RetAjaxOut.InfoMessage = ex.Message.ToString();
//                RetAjaxOut.HtmlContent = ex.Message.ToString();
//            }
//            return RetAjaxOut;
//        }
//        [AjaxPro.AjaxMethod(AjaxPro.HttpSessionStateRequirement.ReadWrite)]
//        public static AjaxOut ServerSideThuHoiHoanTat(RenderInfoCls ORenderInfo, string lichhoichanid)
//        {
//            SiteParam OSiteParam = WebEnvironments.CreateSiteParam(ORenderInfo);
//            AjaxOut RetAjaxOut = new AjaxOut();
//            try
//            {
//                if (!string.IsNullOrEmpty(lichhoichanid))
//                {
//                    var lichhoichan = CallBussinessUtility.CreateBussinessProcess().CreateLichHoiChanProcess().CreateModel(ORenderInfo, lichhoichanid);
//                    if (lichhoichan.TRANGTHAI == (int)LichHoiChanCls.eTrangThai.HoanTat)
//                    {
//                        //CallBussinessUtility.CreateBussinessProcess().CreateTongHopLuuTruProcess().UpDateTrangThai(ORenderInfo, tonghopluutruid, (int)LichHoiChanCls.eTrangThai.DaDuyet);
//                        //CallBussinessUtility.CreateBussinessProcess().CreateBenhAnProcess().UpdateTrangThaiByTongHopLuuTruID(ORenderInfo, tonghopluutruid, (int)BenhAnCls.eTrangThai.DaTongHop);
//                    }
//                }
//            }
//            catch (Exception ex)
//            {
//                RetAjaxOut.Error = true;
//                RetAjaxOut.InfoMessage = ex.Message.ToString();
//                RetAjaxOut.HtmlContent = ex.Message.ToString();
//            }
//            return RetAjaxOut;
//        }
//        [AjaxPro.AjaxMethod(AjaxPro.HttpSessionStateRequirement.ReadWrite)]
//        public static AjaxOut ServerSideTaoLichHoiChan(RenderInfoCls ORenderInfo, string NguoiTaoID, string ThoiGianTao, string NguoiDuyetID, string ThoiGianDuyet, string DiaDiem, string Thuky, string ChuTri, string BatDau, string KetThuc, string GhiChu, string ChuyenKhoaMa)
//        {
//            SiteParam OSiteParam = WebEnvironments.CreateSiteParam(ORenderInfo);
//            AjaxOut RetAjaxOut = new AjaxOut();
//            try
//            {
//                var OTaoLichHoiChan = new LichHoiChanCls();
//                OTaoLichHoiChan.ID = System.Guid.NewGuid().ToString();
//                if (!string.IsNullOrEmpty(NguoiTaoID))
//                    OTaoLichHoiChan.TAOBOI = NguoiTaoID;
//                else OTaoLichHoiChan.TAOBOI = WebEnvironments.GetOwnerUserId(ORenderInfo);
//                if (!string.IsNullOrEmpty(ThoiGianTao))
//                    OTaoLichHoiChan.TAOVAO = DateTime.ParseExact(ThoiGianTao, new string[] { "dd/MM/yyyy", "yyyy-MM-dd", "dd/MM/yyyy HH:mm:ss", "yyyy-MM-dd HH:mm:ss", "dd/MM/yyyy HH:mm", "HH:mm dd/MM/yyyy", "yyyy-MM-ddTHH:mm" }, CultureInfo.InvariantCulture, DateTimeStyles.None);
//                else OTaoLichHoiChan.TAOVAO = DateTime.Now;
//                if (!string.IsNullOrEmpty(Thuky))
//                    OTaoLichHoiChan.THUKY = Thuky;
//                if (!string.IsNullOrEmpty(ChuTri))
//                    OTaoLichHoiChan.CHUTRI = ChuTri;
//                if (!string.IsNullOrEmpty(DiaDiem))
//                    OTaoLichHoiChan.DIADIEM = DiaDiem;
//                OTaoLichHoiChan.DUYETBOI = NguoiDuyetID;
//                if (!string.IsNullOrEmpty(ThoiGianDuyet))
//                    OTaoLichHoiChan.DUYETVAO = DateTime.ParseExact(ThoiGianDuyet, new string[] { "dd/MM/yyyy", "yyyy-MM-dd", "dd/MM/yyyy HH:mm:ss", "yyyy-MM-dd HH:mm:ss", "dd/MM/yyyy HH:mm", "HH:mm dd/MM/yyyy", "yyyy-MM-ddTHH:mm" }, CultureInfo.InvariantCulture, DateTimeStyles.None);
//                if (!string.IsNullOrEmpty(BatDau))
//                    OTaoLichHoiChan.BATDAU = DateTime.ParseExact(BatDau, new string[] { "dd/MM/yyyy", "yyyy-MM-dd", "dd/MM/yyyy HH:mm:ss", "yyyy-MM-dd HH:mm:ss", "dd/MM/yyyy HH:mm", "HH:mm dd/MM/yyyy", "yyyy-MM-ddTHH:mm" }, CultureInfo.InvariantCulture, DateTimeStyles.None);
//                if (!string.IsNullOrEmpty(KetThuc))
//                    OTaoLichHoiChan.KETTHUC = DateTime.ParseExact(KetThuc, new string[] { "dd/MM/yyyy", "yyyy-MM-dd", "dd/MM/yyyy HH:mm:ss", "yyyy-MM-dd HH:mm:ss", "dd/MM/yyyy HH:mm", "HH:mm dd/MM/yyyy", "yyyy-MM-ddTHH:mm" }, CultureInfo.InvariantCulture, DateTimeStyles.None);
//                OTaoLichHoiChan.GHICHU = GhiChu;
//                OTaoLichHoiChan.CHUYENKHOAMA = ChuyenKhoaMa;
//                OTaoLichHoiChan.TRANGTHAI = (int)LichHoiChanCls.eTrangThai.Moi;
//                CallBussinessUtility.CreateBussinessProcess().CreateLichHoiChanProcess().Add(ORenderInfo, OTaoLichHoiChan);
//                RetAjaxOut.RetExtraParam1 = OTaoLichHoiChan.ID;
//                RetAjaxOut.RetBoolean = true;
//            }
//            catch (Exception ex)
//            {
//                RetAjaxOut.Error = true;
//                RetAjaxOut.InfoMessage = ex.Message.ToString();
//                RetAjaxOut.HtmlContent = ex.Message.ToString();
//            }
//            return RetAjaxOut;
//        }

//        [AjaxPro.AjaxMethod(AjaxPro.HttpSessionStateRequirement.ReadWrite)]
//        public static AjaxOut ServerSideSaveLichHoiChan(RenderInfoCls ORenderInfo, string id, string NguoiTaoID, string ThoiGianTao, string NguoiDuyetID, string ThoiGianDuyet, string DiaDiem, string Thuky, string ChuTri, string BatDau, string KetThuc, string GhiChu, string ChuyenKhoaMa)
//        {
//            AjaxOut RetAjaxOut = new AjaxOut();
//            try
//            {
//                LichHoiChanCls lichhoichan = CallBussinessUtility.CreateBussinessProcess().CreateLichHoiChanProcess().CreateModel(ORenderInfo, id);
//                if (!string.IsNullOrEmpty(Thuky))
//                    lichhoichan.THUKY = Thuky;
//                if (!string.IsNullOrEmpty(ChuTri))
//                    lichhoichan.CHUTRI = ChuTri;
//                if (!string.IsNullOrEmpty(DiaDiem))
//                    lichhoichan.DIADIEM = DiaDiem;
//                lichhoichan.DUYETBOI = NguoiDuyetID;
//                if (!string.IsNullOrEmpty(ThoiGianDuyet))
//                    lichhoichan.DUYETVAO = DateTime.ParseExact(ThoiGianDuyet, new string[] { "dd/MM/yyyy", "yyyy-MM-dd", "dd/MM/yyyy HH:mm:ss", "yyyy-MM-dd HH:mm:ss", "dd/MM/yyyy HH:mm", "HH:mm dd/MM/yyyy", "yyyy-MM-ddTHH:mm" }, CultureInfo.InvariantCulture, DateTimeStyles.None);
//                if (!string.IsNullOrEmpty(BatDau))
//                    lichhoichan.BATDAU = DateTime.ParseExact(BatDau, new string[] { "dd/MM/yyyy", "yyyy-MM-dd", "dd/MM/yyyy HH:mm:ss", "yyyy-MM-dd HH:mm:ss", "dd/MM/yyyy HH:mm", "HH:mm dd/MM/yyyy", "yyyy-MM-ddTHH:mm" }, CultureInfo.InvariantCulture, DateTimeStyles.None);
//                if (!string.IsNullOrEmpty(KetThuc))
//                    lichhoichan.KETTHUC = DateTime.ParseExact(KetThuc, new string[] { "dd/MM/yyyy", "yyyy-MM-dd", "dd/MM/yyyy HH:mm:ss", "yyyy-MM-dd HH:mm:ss", "dd/MM/yyyy HH:mm", "HH:mm dd/MM/yyyy", "yyyy-MM-ddTHH:mm" }, CultureInfo.InvariantCulture, DateTimeStyles.None);
//                lichhoichan.GHICHU = GhiChu;
//                lichhoichan.CHUYENKHOAMA = ChuyenKhoaMa;
//                CallBussinessUtility.CreateBussinessProcess().CreateLichHoiChanProcess().Save(ORenderInfo, id, lichhoichan);

//            }
//            catch (Exception ex)
//            {
//                RetAjaxOut.Error = true;
//                RetAjaxOut.InfoMessage = ex.Message.ToString();
//                RetAjaxOut.HtmlContent = ex.Message.ToString();
//            }
//            return RetAjaxOut;
//        }
//        [AjaxPro.AjaxMethod(AjaxPro.HttpSessionStateRequirement.ReadWrite)]
//        public static AjaxOut ServerSideAddDonVis(RenderInfoCls ORenderInfo, string lichhoichanid, string[] bacSyIds, string[] donViCongTacTens)
//        {
//            AjaxOut RetAjaxOut = new AjaxOut();
//            try
//            {
//                CallBussinessUtility.CreateBussinessProcess().CreateLichHoiChanProcess().AddChuyenGias(ORenderInfo, lichhoichanid, bacSyIds, donViCongTacTens);
//                RetAjaxOut.HtmlContent = DrawDonViBelongLichHoiChanList(ORenderInfo, lichhoichanid).HtmlContent;
//            }
//            catch (Exception ex)
//            {
//                RetAjaxOut.Error = true;
//                RetAjaxOut.InfoMessage = ex.Message.ToString();
//                RetAjaxOut.HtmlContent = ex.Message.ToString();
//            }
//            return RetAjaxOut;
//        }
//        [AjaxPro.AjaxMethod(AjaxPro.HttpSessionStateRequirement.ReadWrite)]
//        public static AjaxOut ServerSideAddChuyenGias(RenderInfoCls ORenderInfo, string lichhoichanid, string[] bacSyIds)
//        {
//            AjaxOut RetAjaxOut = new AjaxOut();
//            try
//            {
//                LichHoiChanCls lichHoiChan = CallBussinessUtility.CreateBussinessProcess().CreateLichHoiChanProcess().CreateModel(ORenderInfo, lichhoichanid);
//                BacSyCls thuKy = CallBussinessUtility.CreateBussinessProcess().CreateBacSyProcess().CreateModel(ORenderInfo, lichHoiChan.THUKY);
//                DonViCongTacCls donViCongTac = null;
//                if (thuKy != null && !string.IsNullOrEmpty(thuKy.DONVIMA))
//                {
//                    XmlCls XmlCommand = DmProcessWebServiceUtility.Utility.CreateCommand("donvicongtac.createmodel", ORenderInfo, thuKy.DONVIMA, "");
//                    AjaxOut ajaxOut = DmProcessWebServiceUtility.Utility.ProcessComand("DonViCongTacWsProcessCommand", XmlCommand.XmlData, XmlCommand.XmlDataSchema);
//                    donViCongTac = DonViCongTacParser.ParseFromXml(ajaxOut.XmlDataResult, ajaxOut.XmlDataResultSchema);
//                }
//                string[] donViCongTacTens = new string[bacSyIds.Count()];
//                if (donViCongTac != null)
//                {
//                    for (int i = donViCongTacTens.Count() - 1; i >= 0; i--)
//                        donViCongTacTens[i] = donViCongTac.Ten;
//                }
//                CallBussinessUtility.CreateBussinessProcess().CreateLichHoiChanProcess().AddChuyenGias(ORenderInfo, lichhoichanid, bacSyIds, donViCongTacTens);
//                RetAjaxOut.HtmlContent = DrawChuyenGiaBelongLichHoiChanList(ORenderInfo, lichhoichanid).HtmlContent;
//            }
//            catch (Exception ex)
//            {
//                RetAjaxOut.Error = true;
//                RetAjaxOut.InfoMessage = ex.Message.ToString();
//                RetAjaxOut.HtmlContent = ex.Message.ToString();
//            }
//            return RetAjaxOut;
//        }
//        [AjaxPro.AjaxMethod(AjaxPro.HttpSessionStateRequirement.ReadWrite)]
//        public static AjaxOut ServerSideRemoveDonVis(RenderInfoCls ORenderInfo, string lichhoichanid, string[] removeChuyenGiaArray)
//        {
//            AjaxOut RetAjaxOut = new AjaxOut();
//            try
//            {
//                CallBussinessUtility.CreateBussinessProcess().CreateLichHoiChanProcess().RemoveChuyenGias(ORenderInfo, lichhoichanid, removeChuyenGiaArray);
//                RetAjaxOut.HtmlContent = DrawDonViBelongLichHoiChanList(ORenderInfo, lichhoichanid).HtmlContent;
//            }
//            catch (Exception ex)
//            {
//                RetAjaxOut.Error = true;
//                RetAjaxOut.InfoMessage = ex.Message.ToString();
//                RetAjaxOut.HtmlContent = ex.Message.ToString();
//            }
//            return RetAjaxOut;
//        }
//        [AjaxPro.AjaxMethod(AjaxPro.HttpSessionStateRequirement.ReadWrite)]
//        public static AjaxOut ServerSideRemoveChuyenGias(RenderInfoCls ORenderInfo, string lichhoichanid, string[] removeChuyenGiaArray)
//        {
//            AjaxOut RetAjaxOut = new AjaxOut();
//            try
//            {
//                CallBussinessUtility.CreateBussinessProcess().CreateLichHoiChanProcess().RemoveChuyenGias(ORenderInfo, lichhoichanid, removeChuyenGiaArray);
//                RetAjaxOut.HtmlContent = DrawChuyenGiaBelongLichHoiChanList(ORenderInfo, lichhoichanid).HtmlContent;
//            }
//            catch (Exception ex)
//            {
//                RetAjaxOut.Error = true;
//                RetAjaxOut.InfoMessage = ex.Message.ToString();
//                RetAjaxOut.HtmlContent = ex.Message.ToString();
//            }
//            return RetAjaxOut;
//        }
//        [AjaxPro.AjaxMethod(AjaxPro.HttpSessionStateRequirement.ReadWrite)]
//        public static AjaxOut ServerSideAddCaBenhs(RenderInfoCls ORenderInfo, string lichhoichanid, string[] addCaBenhArray, string functionName, string actionName)
//        {
//            AjaxOut RetAjaxOut = new AjaxOut();
//            try
//            {
//                CallBussinessUtility.CreateBussinessProcess().CreateLichHoiChanProcess().AddCaBenhs(ORenderInfo, lichhoichanid, addCaBenhArray);
//                RetAjaxOut.HtmlContent = DrawCaBenhBelongLichHoiChanList(ORenderInfo, lichhoichanid).HtmlContent;
//                //Add bác sỹ tham gia hội chẩn thuộc đơn vị tham vấn của ca bệnh
//                List<string> bacSyIds = new List<string>(), donViCongTacTens = new List<string>();
//                foreach (string caBenhId in addCaBenhArray)
//                {
//                    CaBenhCls cabenh = CallBussinessUtility.CreateBussinessProcess().CreateCaBenhProcess().CreateModel(ORenderInfo, caBenhId);
//                    if (cabenh != null)
//                    {
//                        OwnerCls dvtv = CoreCallBussinessUtility.CreateBussinessProcess().CreateOwnerProcess().CreateModel(ORenderInfo, cabenh.DONVITHAMVANID);
//                        if (dvtv != null)
//                        {
//                            LapLichThanhVienHoiChanCls[] lltvhcs = CallBussinessUtility.CreateBussinessProcess().CreateLapLichThanhVienHoiChanProcess().Reading(ORenderInfo, new LapLichThanhVienHoiChanFilterCls() { LICHHOICHANID = lichhoichanid });
//                            var bacSies = CallBussinessUtility.CreateBussinessProcess().CreateBacSyProcess().Reading(ORenderInfo, new BacSyFilterCls() { DONVIMA = dvtv.OwnerCode }).Where(o => !lltvhcs.Any(a => a.BACSYID == o.ID));
//                            foreach (var bacSy in bacSies)
//                            {
//                                bacSyIds.Add(bacSy.ID);
//                                XmlCls XmlCommand = DmProcessWebServiceUtility.Utility.CreateCommand("donvicongtac.createmodel", ORenderInfo, bacSy.DONVIMA, "");
//                                AjaxOut ajaxOut = DmProcessWebServiceUtility.Utility.ProcessComand("DonViCongTacWsProcessCommand", XmlCommand.XmlData, XmlCommand.XmlDataSchema);
//                                var donVi = DonViCongTacParser.ParseFromXml(ajaxOut.XmlDataResult, ajaxOut.XmlDataResultSchema);
//                                if (donVi != null)
//                                    donViCongTacTens.Add(donVi.Ten);
//                                else
//                                    donViCongTacTens.Add(bacSy.DONVIMA);
//                            }
//                        }
//                        OneTSQ.WebRender.WebScreenProcessBll.ServerSideAddActivityHistory(ORenderInfo, cabenh.ID, functionName, actionName, WebLanguage.GetLanguage(ORenderInfo, "Tác vụ form => Chuyển trạng thái ca bệnh về " + CaBenhParser.TrangThais[(int)CaBenhCls.eTrangThai.DaLapLich]));
//                    }
//                }
//                if (bacSyIds.Count > 0)
//                    RetAjaxOut.RetExtraParam1 = ServerSideAddDonVis(ORenderInfo, lichhoichanid, bacSyIds.ToArray(), donViCongTacTens.ToArray()).HtmlContent;
//            }
//            catch (Exception ex)
//            {
//                RetAjaxOut.Error = true;
//                RetAjaxOut.InfoMessage = ex.Message.ToString();
//                RetAjaxOut.HtmlContent = ex.Message.ToString();
//            }
//            return RetAjaxOut;
//        }
//        [AjaxPro.AjaxMethod(AjaxPro.HttpSessionStateRequirement.ReadWrite)]
//        public static AjaxOut ServerSideUpdateSttCaBenh(RenderInfoCls ORenderInfo, LichHoiChanCaBenhCls[] lichHoiChanCaBenhs)
//        {
//            AjaxOut RetAjaxOut = new AjaxOut();
//            try
//            {
//                CallBussinessUtility.CreateBussinessProcess().CreateLichHoiChanProcess().UpdateCaBenhStt(ORenderInfo, lichHoiChanCaBenhs);
//            }
//            catch (Exception ex)
//            {
//                RetAjaxOut.Error = true;
//                RetAjaxOut.InfoMessage = ex.Message.ToString();
//                RetAjaxOut.HtmlContent = ex.Message.ToString();
//            }
//            return RetAjaxOut;
//        }
//        [AjaxPro.AjaxMethod(AjaxPro.HttpSessionStateRequirement.ReadWrite)]
//        public static AjaxOut ServerSideRemoveCaBenhs(RenderInfoCls ORenderInfo, string lichhoichanid, string[] removeCaBenhArray, string functionName, string actionName)
//        {
//            AjaxOut RetAjaxOut = new AjaxOut();
//            try
//            {
//                CallBussinessUtility.CreateBussinessProcess().CreateLichHoiChanProcess().RemoveCaBenhs(ORenderInfo, lichhoichanid, removeCaBenhArray);
//                RetAjaxOut.HtmlContent = DrawCaBenhBelongLichHoiChanList(ORenderInfo, lichhoichanid).HtmlContent;

//                //Remove bác sỹ tham gia hội chẩn thuộc đơn vị tham vấn của ca bệnh
//                List<string> bacSyIds = new List<string>(), donViCongTacTens = new List<string>();
//                foreach (string caBenhId in removeCaBenhArray)
//                {
//                    CaBenhCls cabenh = CallBussinessUtility.CreateBussinessProcess().CreateCaBenhProcess().CreateModel(ORenderInfo, caBenhId);
//                    if (cabenh != null)
//                    {
//                        OwnerCls dvtv = CoreCallBussinessUtility.CreateBussinessProcess().CreateOwnerProcess().CreateModel(ORenderInfo, cabenh.DONVITHAMVANID);
//                        if (dvtv != null)
//                        {
//                            BacSyCls[] bacSies = CallBussinessUtility.CreateBussinessProcess().CreateBacSyProcess().Reading(ORenderInfo, new BacSyFilterCls() { DONVIMA = dvtv.OwnerCode });
//                            foreach (var bacSy in bacSies)
//                                bacSyIds.Add(bacSy.ID);
//                        }
//                        OneTSQ.WebRender.WebScreenProcessBll.ServerSideAddActivityHistory(ORenderInfo, cabenh.ID, functionName, actionName, WebLanguage.GetLanguage(ORenderInfo, "Tác vụ form => Chuyển trạng thái ca bệnh về " + CaBenhParser.TrangThais[(int)CaBenhCls.eTrangThai.ChoLapLich]));
//                    }
//                }
//                if (bacSyIds.Count > 0)
//                    RetAjaxOut.RetExtraParam1 = ServerSideRemoveDonVis(ORenderInfo, lichhoichanid, bacSyIds.ToArray()).HtmlContent;
//            }
//            catch (Exception ex)
//            {
//                RetAjaxOut.Error = true;
//                RetAjaxOut.InfoMessage = ex.Message.ToString();
//                RetAjaxOut.HtmlContent = ex.Message.ToString();
//            }
//            return RetAjaxOut;
//        }
//        [AjaxPro.AjaxMethod(AjaxPro.HttpSessionStateRequirement.ReadWrite)]
//        public static AjaxOut ServerSideXoaLichHoiChan(RenderInfoCls ORenderInfo, string lichhoichanid)
//        {
//            SiteParam OSiteParam = WebEnvironments.CreateSiteParam(ORenderInfo);
//            AjaxOut RetAjaxOut = new AjaxOut();
//            try
//            {
//                if (!string.IsNullOrEmpty(lichhoichanid))
//                {
//                    var lichhoichan = CallBussinessUtility.CreateBussinessProcess().CreateLichHoiChanProcess().CreateModel(ORenderInfo, lichhoichanid);
//                    if (lichhoichan.TRANGTHAI == (int)LichHoiChanCls.eTrangThai.Moi)
//                    {
//                        CallBussinessUtility.CreateBussinessProcess().CreateLichHoiChanProcess().Delete(ORenderInfo, lichhoichanid);
//                        var lichHoiChansUrl = WebScreen.BuildUrl(OSiteParam, WebSessionUtility.GetCurrentLoginUser(OSiteParam).OwnerCode, "LichHoiChans", new WebParamCls[] { });
//                        RetAjaxOut.RetUrl = lichHoiChansUrl;
//                    }
//                }
//            }
//            catch (Exception ex)
//            {
//                RetAjaxOut.Error = true;
//                RetAjaxOut.InfoMessage = ex.Message.ToString();
//                RetAjaxOut.HtmlContent = ex.Message.ToString();
//            }
//            return RetAjaxOut;
//        }

//        [AjaxPro.AjaxMethod(AjaxPro.HttpSessionStateRequirement.ReadWrite)]
//        public static AjaxOut UpdateTrangThaiLichHoiChan(RenderInfoCls ORenderInfo, string lichHoiChanId, int trangThai, string functionName, string actionName)
//        {
//            AjaxOut RetAjaxOut = new AjaxOut();
//            try
//            {
//                SiteParam OSiteParam = WebEnvironments.CreateSiteParam(ORenderInfo);
//                WebSession.CheckSessionTimeOut(ORenderInfo);
//                LichHoiChanCls lichHoiChan = CallBussinessUtility.CreateBussinessProcess().CreateLichHoiChanProcess().CreateModel(ORenderInfo, lichHoiChanId);
//                if (lichHoiChan == null)
//                {
//                    RetAjaxOut.Error = true;
//                    RetAjaxOut.InfoMessage = WebLanguage.GetLanguage(OSiteParam, "Lịch hội chẩn này đã bị xóa bởi người dùng khác.");
//                    return RetAjaxOut;
//                }
//                CaBenhCls[] caBenhs = CallBussinessUtility.CreateBussinessProcess().CreateCaBenhProcess().Reading(ORenderInfo, new CaBenhFilterCls() { LICHHOICHANID = lichHoiChanId });
//                int? trangThaiCaBenh = null;

//                if (trangThai == (int)LichHoiChanCls.eTrangThai.ChoDuyet)
//                {
//                    if (lichHoiChan.TRANGTHAI == (int)LichHoiChanCls.eTrangThai.DaDuyet)
//                    {
//                        if (caBenhs.Any(o => o.TRANGTHAI != (int)CaBenhCls.eTrangThai.ChoHoiChan))
//                        {
//                            RetAjaxOut.Error = true;
//                            RetAjaxOut.InfoMessage = WebLanguage.GetLanguage(OSiteParam, "Không thể thu hồi duyệt lịch hội chẩn này, vì đã có ca bệnh được hội chẩn.");
//                            return RetAjaxOut;
//                        }
//                        trangThaiCaBenh = (int)CaBenhCls.eTrangThai.DaLapLich;
//                    }
//                }
//                else if (trangThai == (int)LichHoiChanCls.eTrangThai.DaDuyet)
//                {
//                    lichHoiChan.DUYETBOI = WebSessionUtility.GetCurrentLoginUser(OSiteParam).OwnerUserId;
//                    lichHoiChan.DUYETVAO = DateTime.Now;
//                    trangThaiCaBenh = (int)CaBenhCls.eTrangThai.ChoHoiChan;
//                }
//                else if (trangThai == (int)LichHoiChanCls.eTrangThai.TuChoiDuyet)
//                {
//                    lichHoiChan.DUYETBOI = WebSessionUtility.GetCurrentLoginUser(OSiteParam).OwnerUserId;
//                    lichHoiChan.DUYETVAO = DateTime.Now;
//                }
//                else if (trangThai == (int)LichHoiChanCls.eTrangThai.HoanTat)
//                {
//                    //Chỉ cập nhật trạng thái này cho những ca bệnh ở trạng thái Đang hội chẩn hoặc Chờ hội chẩn.
//                    trangThaiCaBenh = (int)CaBenhCls.eTrangThai.KetThuc;
//                    caBenhs = caBenhs.Where(o => o.TRANGTHAI == (int)CaBenhCls.eTrangThai.DangHoiChan || o.TRANGTHAI == (int)CaBenhCls.eTrangThai.ChoHoiChan).ToArray();
//                }
//                else if (trangThai == (int)LichHoiChanCls.eTrangThai.Huy)
//                {
//                    //Chỉ cập nhật trạng thái này cho những ca bệnh ở trạng thái Đã lập lịch hoặc Chờ hội chẩn.
//                    trangThaiCaBenh = (int)CaBenhCls.eTrangThai.ChoLapLich;
//                    caBenhs = caBenhs.Where(o => o.TRANGTHAI == (int)CaBenhCls.eTrangThai.DaLapLich || o.TRANGTHAI == (int)CaBenhCls.eTrangThai.ChoHoiChan).ToArray();
//                }
//                if (trangThaiCaBenh != null)
//                    foreach (CaBenhCls caBenh in caBenhs)
//                    {
//                        caBenh.TRANGTHAI = trangThaiCaBenh;
//                        if (trangThai == (int)LichHoiChanCls.eTrangThai.ChoDuyet && lichHoiChan.TRANGTHAI == (int)LichHoiChanCls.eTrangThai.DaDuyet)
//                        {
//                            caBenh.LICHHOICHANID = null;
//                        }
//                        else if (trangThai == (int)LichHoiChanCls.eTrangThai.DaDuyet)
//                        {
//                            caBenh.LICHHOICHANID = lichHoiChanId;
//                            caBenh.DUYETHOICHANBOI = WebSessionUtility.GetCurrentLoginUser(OSiteParam).OwnerUserId;
//                            caBenh.DUYETHOICHANVAO = DateTime.Now;
//                        }
//                        CallBussinessUtility.CreateBussinessProcess().CreateCaBenhProcess().Save(ORenderInfo, caBenh.ID, caBenh);
//                        if (trangThaiCaBenh != null)
//                            OneTSQ.WebRender.WebScreenProcessBll.ServerSideAddActivityHistory(ORenderInfo, caBenh.ID, functionName, actionName, WebLanguage.GetLanguage(ORenderInfo, "Tác vụ form => Chuyển trạng thái ca bệnh về " + CaBenhParser.TrangThais[trangThaiCaBenh.Value]));
//                    }
//                lichHoiChan.TRANGTHAI = trangThai;
//                CallBussinessUtility.CreateBussinessProcess().CreateLichHoiChanProcess().Save(ORenderInfo, lichHoiChan.ID, lichHoiChan);
//            }
//            catch (Exception ex)
//            {
//                RetAjaxOut.Error = true;
//                RetAjaxOut.InfoMessage = ex.Message.ToString();
//                RetAjaxOut.HtmlContent = ex.Message.ToString();
//            }
//            return RetAjaxOut;
//        }

//        #region CustomActionControls
//        public override ActionForm[] ActionForms
//        {
//            get
//            {
//                return new ActionForm[]
//                {
//                    new ActionForm("btnThuHoiHoanTat","Thu hồi","onThuHoiHoanTat"),
//                    new ActionForm("btnTuChoiDuyet","Hoàn tất","onHoanTat"),
//                    new ActionForm("btnThuHoiDuyet","Thu hồi","onThuHoiDuyet"),
//                    new ActionForm("btnDuyet","Duyệt","onDuyet"),
//                    new ActionForm("btnThuHoiChuyenDuyet","Thu hồi","onThuHoiChuyenDuyet"),
//                    new ActionForm("btnChuyenDuyet","Chuyển duyệt","onChuyenDuyet"),
//                    new ActionForm("btnXoa","Xóa","onXoa"),
//                    new ActionForm("btnLuu","Lưu","onLuu")
//                };
//            }
//        }
//        #endregion

//    }
//}
